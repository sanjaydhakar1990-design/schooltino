"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5576],{9630(e,s,a){a.d(s,{E:()=>o});var t=a(2555),r=a(3986),l=(a(9950),a(4364)),n=a(9332),i=a(4414);const c=["className","variant"],d=(0,l.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:s,variant:a}=e,l=(0,r.A)(e,c);return(0,i.jsx)("div",(0,t.A)({className:(0,n.cn)(d({variant:a}),s)},l))}},1111(e,s,a){a.d(s,{$:()=>x});var t=a(2555),r=a(3986),l=a(9950),n=a(2962),i=a(4364),c=a(9332),d=a(4414);const o=["className","variant","size","asChild"],m=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-blue-500 text-white shadow-sm hover:bg-blue-600 rounded-lg",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-gray-200 bg-white shadow-sm hover:bg-gray-50 text-gray-700 rounded-lg",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),x=l.forwardRef((e,s)=>{let{className:a,variant:l,size:i,asChild:x=!1}=e,u=(0,r.A)(e,o);const h=x?n.DX:"button";return(0,d.jsx)(h,(0,t.A)({className:(0,c.cn)(m({variant:l,size:i,className:a})),ref:s},u))});x.displayName="Button"},4245(e,s,a){a.d(s,{BT:()=>v,Wu:()=>j,ZB:()=>p,Zp:()=>h,aR:()=>g});var t=a(2555),r=a(3986),l=a(9950),n=a(9332),i=a(4414);const c=["className"],d=["className"],o=["className"],m=["className"],x=["className"],u=["className"],h=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,c);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("rounded-xl border border-gray-200 bg-white text-gray-900 shadow-sm",a)},l))});h.displayName="Card";const g=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,d);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-5",a)},l))});g.displayName="CardHeader";const p=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,o);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",a)},l))});p.displayName="CardTitle";const v=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,m);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("text-sm text-muted-foreground",a)},l))});v.displayName="CardDescription";const j=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,x);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("p-5 pt-0",a)},l))});j.displayName="CardContent";l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,u);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("flex items-center p-5 pt-0",a)},l))}).displayName="CardFooter"},7255(e,s,a){a.d(s,{Cf:()=>f,L3:()=>N,c7:()=>b,lG:()=>g,rr:()=>y,zM:()=>p});var t=a(2555),r=a(3986),l=a(9950),n=a(9710),i=a(6479),c=a(9332),d=a(4414);const o=["className"],m=["className","children"],x=["className"],u=["className"],h=["className"],g=n.bL,p=n.l9,v=n.ZL,j=(n.bm,l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,o);return(0,d.jsx)(n.hJ,(0,t.A)({ref:s,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a)},l))}));j.displayName=n.hJ.displayName;const f=l.forwardRef((e,s)=>{let{className:a,children:l}=e,o=(0,r.A)(e,m);return(0,d.jsxs)(v,{children:[(0,d.jsx)(j,{}),(0,d.jsxs)(n.UC,(0,t.A)((0,t.A)({ref:s,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a)},o),{},{children:[l,(0,d.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,d.jsx)(i.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});f.displayName=n.UC.displayName;const b=e=>{let{className:s}=e,a=(0,r.A)(e,x);return(0,d.jsx)("div",(0,t.A)({className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s)},a))};b.displayName="DialogHeader";const N=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,u);return(0,d.jsx)(n.hE,(0,t.A)({ref:s,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",a)},l))});N.displayName=n.hE.displayName;const y=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,h);return(0,d.jsx)(n.VY,(0,t.A)({ref:s,className:(0,c.cn)("text-sm text-muted-foreground",a)},l))});y.displayName=n.VY.displayName},4779(e,s,a){a.d(s,{p:()=>d});var t=a(2555),r=a(3986),l=a(9950),n=a(9332),i=a(4414);const c=["className","type"],d=l.forwardRef((e,s)=>{let{className:a,type:l}=e,d=(0,r.A)(e,c);return(0,i.jsx)("input",(0,t.A)({type:l,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s},d))});d.displayName="Input"},5475(e,s,a){a.d(s,{Xi:()=>h,av:()=>g,j7:()=>u,tU:()=>x});var t=a(2555),r=a(3986),l=a(9950),n=a(7970),i=a(9332),c=a(4414);const d=["className"],o=["className"],m=["className"],x=n.bL,u=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,d);return(0,c.jsx)(n.B8,(0,t.A)({ref:s,className:(0,i.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-gray-100 border border-gray-200 p-1 text-muted-foreground",a)},l))});u.displayName=n.B8.displayName;const h=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,o);return(0,c.jsx)(n.l9,(0,t.A)({ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-blue-500",a)},l))});h.displayName=n.l9.displayName;const g=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,r.A)(e,m);return(0,c.jsx)(n.UC,(0,t.A)({ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a)},l))});g.displayName=n.UC.displayName},9332(e,s,a){a.d(s,{cn:()=>l});var t=a(2004),r=a(9800);function l(){for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,r.QP)((0,t.$)(s))}},5576(e,s,a){a.r(s),a.d(s,{default:()=>G});var t=a(2555),r=a(9950),l=a(5532),n=a(5030),i=a(2033),c=a(2828),d=a(1850),o=a(6649),m=a(7737),x=a(1855),u=a(6101),h=a(3971),g=a(2607),p=a(6987),v=a(4758),j=a(9318),f=a(4664),b=a(1064),N=a(9975),y=a(6542),_=a(1111),A=a(4779),w=a(4245),C=a(9630),k=a(5475),S=a(7255),R=a(4414);const P="";function G(){const{user:e}=(0,l.As)(),{t:s}=(0,n.Bd)(),[a,G]=(0,r.useState)([]),[M,I]=(0,r.useState)([]),[D,F]=(0,r.useState)(null),[E,T]=(0,r.useState)(!0),[B,Z]=(0,r.useState)(!1),[L,V]=(0,r.useState)(!1),[z,O]=(0,r.useState)([]),[$,W]=(0,r.useState)(null),U=(null===e||void 0===e?void 0:e.school_id)||"school123",[X,J]=(0,r.useState)({vehicle_number:"",vehicle_type:"bus",capacity:40,driver_name:"",driver_phone:"",conductor_name:"",conductor_phone:""}),[q,Y]=(0,r.useState)({route_name:"",route_number:"",morning_start_time:"07:00",evening_start_time:"14:00",monthly_fee:1500,yearly_fee:15e3,stops:[]}),[K,H]=(0,r.useState)([]),[Q,ee]=(0,r.useState)(!1),[se,ae]=(0,r.useState)({vehicle_id:"",device_imei:"",sim_number:"",device_brand:"generic",server_ip:"",server_port:""}),te=(0,r.useCallback)(async()=>{try{T(!0);const[e,s,a]=await Promise.all([fetch("".concat(P,"/api/transport/vehicles?school_id=").concat(U)),fetch("".concat(P,"/api/transport/routes?school_id=").concat(U)),fetch("".concat(P,"/api/transport/analytics?school_id=").concat(U))]),t=await e.json(),r=await s.json(),l=await a.json();G(t.vehicles||[]),I(r.routes||[]),F(l)}catch(e){console.error("Error:",e)}finally{T(!1)}},[U]),re=(0,r.useCallback)(async()=>{try{const e=await fetch("".concat(P,"/api/transport/track-all?school_id=").concat(U)),s=await e.json();O(s.vehicles||[])}catch(e){console.error("Tracking error:",e)}},[U]),le=(0,r.useCallback)(async()=>{try{const e=await fetch("".concat(P,"/api/transport/gps-setup/status/").concat(U)),s=await e.json();H(s.vehicles||[])}catch(e){console.error("GPS fetch error:",e)}},[U]);(0,r.useEffect)(()=>{te(),re(),le();const e=setInterval(re,1e4);return W(e),()=>{e&&clearInterval(e)}},[te,re,le]);return(0,R.jsxs)("div",{className:"space-y-6","data-testid":"transport-page",children:[(0,R.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight flex items-center gap-2",children:[(0,R.jsx)(o.A,{className:"w-8 h-8 text-amber-500"}),s("transport")]}),(0,R.jsxs)("p",{className:"text-muted-foreground mt-1",children:[s("live_tracking"),", ",s("routes")," & ",s("transport")]})]}),(0,R.jsx)("div",{className:"flex items-center gap-2",children:(0,R.jsxs)(_.$,{variant:"outline",onClick:te,children:[(0,R.jsx)(p.A,{className:"w-4 h-4 mr-2"}),s("refresh")]})})]}),D&&(0,R.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[(0,R.jsx)(w.Zp,{className:"bg-gradient-to-br from-amber-500/10 to-orange-500/10 border-amber-500/20",children:(0,R.jsx)(w.Wu,{className:"pt-4",children:(0,R.jsxs)("div",{className:"flex items-center justify-between",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"text-sm text-muted-foreground",children:s("vehicles")}),(0,R.jsx)("p",{className:"text-3xl font-bold",children:D.total_vehicles})]}),(0,R.jsx)(o.A,{className:"w-10 h-10 text-amber-500"})]})})}),(0,R.jsx)(w.Zp,{className:"bg-gradient-to-br from-blue-500/10 to-indigo-500/10 border-blue-500/20",children:(0,R.jsx)(w.Wu,{className:"pt-4",children:(0,R.jsxs)("div",{className:"flex items-center justify-between",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"text-sm text-muted-foreground",children:s("routes")}),(0,R.jsx)("p",{className:"text-3xl font-bold",children:D.total_routes})]}),(0,R.jsx)(v.A,{className:"w-10 h-10 text-blue-500"})]})})}),(0,R.jsx)(w.Zp,{className:"bg-gradient-to-br from-green-500/10 to-emerald-500/10 border-green-500/20",children:(0,R.jsx)(w.Wu,{className:"pt-4",children:(0,R.jsxs)("div",{className:"flex items-center justify-between",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"text-sm text-muted-foreground",children:s("students")}),(0,R.jsx)("p",{className:"text-3xl font-bold",children:D.students_using_transport})]}),(0,R.jsx)(N.A,{className:"w-10 h-10 text-green-500"})]})})}),(0,R.jsx)(w.Zp,{className:"bg-gradient-to-br from-purple-500/10 to-pink-500/10 border-purple-500/20",children:(0,R.jsx)(w.Wu,{className:"pt-4",children:(0,R.jsxs)("div",{className:"flex items-center justify-between",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"text-sm text-muted-foreground",children:"On Route"}),(0,R.jsx)("p",{className:"text-3xl font-bold",children:z.filter(e=>"on_route"===e.status).length})]}),(0,R.jsx)(u.A,{className:"w-10 h-10 text-purple-500"})]})})})]}),(0,R.jsxs)(k.tU,{defaultValue:"tracking",className:"w-full",children:[(0,R.jsxs)(k.j7,{className:"grid w-full grid-cols-4",children:[(0,R.jsx)(k.Xi,{value:"tracking",children:s("live_tracking")}),(0,R.jsx)(k.Xi,{value:"vehicles",children:s("vehicles")}),(0,R.jsx)(k.Xi,{value:"routes",children:s("routes")}),(0,R.jsxs)(k.Xi,{value:"nfc-gps",children:["NFC & ",s("gps_tracking")]})]}),(0,R.jsx)(k.av,{value:"tracking",className:"mt-4",children:(0,R.jsxs)(w.Zp,{children:[(0,R.jsxs)(w.aR,{children:[(0,R.jsxs)(w.ZB,{className:"flex items-center gap-2",children:[(0,R.jsx)(u.A,{className:"w-5 h-5 text-green-500 animate-pulse"}),s("live_tracking")]}),(0,R.jsx)(w.BT,{children:"Real-time vehicle locations (GPS SIMULATED - Live GPS pending)"})]}),(0,R.jsxs)(w.Wu,{children:[0===z.length?(0,R.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No vehicles to track"}):(0,R.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:z.map(e=>{var a,t,r,l,n;return(0,R.jsx)(w.Zp,{className:"border-l-4 ".concat("on_route"===e.status?"border-l-green-500":"border-l-amber-500"),children:(0,R.jsxs)(w.Wu,{className:"pt-4",children:[(0,R.jsxs)("div",{className:"flex items-start justify-between",children:[(0,R.jsxs)("div",{children:[(0,R.jsxs)("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[(0,R.jsx)(o.A,{className:"w-5 h-5"}),e.vehicle_number]}),(0,R.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s("driver_name"),": ",e.driver_name]}),(0,R.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,R.jsx)(h.A,{className:"w-3 h-3"})," ",e.driver_phone]})]}),(0,R.jsx)(C.E,{variant:"on_route"===e.status?"default":"secondary",children:"on_route"===e.status?"Moving":"Stopped"})]}),(0,R.jsx)("div",{className:"mt-3 p-3 bg-muted/50 rounded-lg",children:(0,R.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("span",{className:"text-muted-foreground",children:"Lat:"})," ",null===(a=e.location)||void 0===a||null===(t=a.lat)||void 0===t?void 0:t.toFixed(4)]}),(0,R.jsxs)("div",{children:[(0,R.jsx)("span",{className:"text-muted-foreground",children:"Lng:"})," ",null===(r=e.location)||void 0===r||null===(l=r.lng)||void 0===l?void 0:l.toFixed(4)]}),(0,R.jsxs)("div",{children:[(0,R.jsx)("span",{className:"text-muted-foreground",children:"Speed:"})," ",null===(n=e.location)||void 0===n?void 0:n.speed," km/h"]})]})})]})},e.id)})}),(0,R.jsx)("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,R.jsxs)("p",{className:"text-sm text-amber-800 flex items-center gap-2",children:[(0,R.jsx)(c.A,{className:"w-4 h-4"}),"GPS tracking is currently SIMULATED. Real GPS device integration coming soon."]})})]})]})}),(0,R.jsxs)(k.av,{value:"vehicles",className:"mt-4",children:[(0,R.jsx)("div",{className:"flex justify-end mb-4",children:(0,R.jsxs)(_.$,{onClick:()=>Z(!0),children:[(0,R.jsx)(g.A,{className:"w-4 h-4 mr-2"}),s("add_vehicle")]})}),(0,R.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:a.map(e=>{var s,a;return(0,R.jsx)(w.Zp,{children:(0,R.jsxs)(w.Wu,{className:"pt-4",children:[(0,R.jsxs)("div",{className:"flex items-center gap-4",children:[(0,R.jsx)("div",{className:"p-3 rounded-xl bg-amber-500/10",children:(0,R.jsx)(o.A,{className:"w-8 h-8 text-amber-600"})}),(0,R.jsxs)("div",{className:"flex-1",children:[(0,R.jsx)("h3",{className:"font-semibold text-lg",children:e.vehicle_number}),(0,R.jsxs)("p",{className:"text-sm text-muted-foreground capitalize",children:[e.vehicle_type," \u2022 ",e.capacity," seats"]})]}),(0,R.jsx)(C.E,{variant:"outline",children:e.status})]}),(0,R.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-2 text-sm",children:[(0,R.jsxs)("div",{className:"flex items-center gap-2",children:[(0,R.jsx)(b.A,{className:"w-4 h-4 text-muted-foreground"}),(0,R.jsx)("span",{children:null===(s=e.driver)||void 0===s?void 0:s.name})]}),(0,R.jsxs)("div",{className:"flex items-center gap-2",children:[(0,R.jsx)(h.A,{className:"w-4 h-4 text-muted-foreground"}),(0,R.jsx)("span",{children:null===(a=e.driver)||void 0===a?void 0:a.phone})]})]})]})},e.id)})})]}),(0,R.jsxs)(k.av,{value:"routes",className:"mt-4",children:[(0,R.jsx)("div",{className:"flex justify-end mb-4",children:(0,R.jsxs)(_.$,{onClick:()=>V(!0),children:[(0,R.jsx)(g.A,{className:"w-4 h-4 mr-2"}),s("add_route")]})}),(0,R.jsx)("div",{className:"grid gap-4",children:M.map(e=>{var s;return(0,R.jsx)(w.Zp,{children:(0,R.jsxs)(w.Wu,{className:"pt-4",children:[(0,R.jsxs)("div",{className:"flex items-center justify-between",children:[(0,R.jsxs)("div",{className:"flex items-center gap-4",children:[(0,R.jsx)("div",{className:"p-3 rounded-xl bg-blue-500/10",children:(0,R.jsx)(v.A,{className:"w-8 h-8 text-blue-600"})}),(0,R.jsxs)("div",{children:[(0,R.jsx)("h3",{className:"font-semibold text-lg",children:e.route_name}),(0,R.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Route #",e.route_number]})]})]}),(0,R.jsxs)("div",{className:"text-right",children:[(0,R.jsxs)("p",{className:"font-semibold",children:["\u20b9",e.monthly_fee,"/month"]}),e.yearly_fee>0&&(0,R.jsxs)("p",{className:"text-sm font-medium text-green-600",children:["\u20b9",e.yearly_fee,"/year"]}),(0,R.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.total_students||0," students"]})]})]}),(0,R.jsxs)("div",{className:"mt-4 flex items-center gap-4 text-sm text-muted-foreground",children:[(0,R.jsxs)("span",{className:"flex items-center gap-1",children:[(0,R.jsx)(m.A,{className:"w-4 h-4"})," Morning: ",e.morning_start_time]}),(0,R.jsxs)("span",{className:"flex items-center gap-1",children:[(0,R.jsx)(m.A,{className:"w-4 h-4"})," Evening: ",e.evening_start_time]}),(0,R.jsxs)("span",{className:"flex items-center gap-1",children:[(0,R.jsx)(x.A,{className:"w-4 h-4"})," ",(null===(s=e.stops)||void 0===s?void 0:s.length)||0," stops"]})]})]})},e.id)})})]}),(0,R.jsxs)(k.av,{value:"nfc-gps",className:"space-y-6",children:[(0,R.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:[(0,R.jsxs)("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2 mb-2",children:[(0,R.jsx)(y.A,{className:"w-5 h-5 text-blue-600"}),"GPS & NFC Configuration"]}),(0,R.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"GPS devices aur NFC cards ko configure karein. Vehicles mein GPS lagayein aur students ko NFC cards assign karein."}),(0,R.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,R.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[(0,R.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center mb-3",children:(0,R.jsx)(u.A,{className:"w-5 h-5 text-blue-600"})}),(0,R.jsx)("h4",{className:"font-semibold text-gray-900",children:"GPS Devices"}),(0,R.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[K.filter(e=>e.gps_enabled).length," / ",K.length," vehicles configured"]})]}),(0,R.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[(0,R.jsx)("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center mb-3",children:(0,R.jsx)(f.A,{className:"w-5 h-5 text-green-600"})}),(0,R.jsx)("h4",{className:"font-semibold text-gray-900",children:"NFC Cards"}),(0,R.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Mobile-based NFC tap attendance"})]}),(0,R.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[(0,R.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center mb-3",children:(0,R.jsx)(d.A,{className:"w-5 h-5 text-purple-600"})}),(0,R.jsx)("h4",{className:"font-semibold text-gray-900",children:"Notifications"}),(0,R.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Auto alerts on boarding/drop"})]})]})]}),(0,R.jsxs)(w.Zp,{children:[(0,R.jsx)(w.aR,{children:(0,R.jsxs)("div",{className:"flex items-center justify-between",children:[(0,R.jsxs)("div",{children:[(0,R.jsxs)(w.ZB,{className:"flex items-center gap-2",children:[(0,R.jsx)(u.A,{className:"w-5 h-5 text-blue-500"}),"GPS Device Management"]}),(0,R.jsx)(w.BT,{children:"Add and manage GPS trackers on your vehicles"})]}),(0,R.jsxs)(_.$,{onClick:()=>ee(!0),className:"bg-blue-600 hover:bg-blue-700",children:[(0,R.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Add GPS Device"]})]})}),(0,R.jsx)(w.Wu,{children:0===K.length?(0,R.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,R.jsx)(u.A,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),(0,R.jsx)("p",{className:"font-medium",children:"No vehicles found"}),(0,R.jsx)("p",{className:"text-sm mt-1",children:"Pehle Vehicles tab mein vehicles add karein, phir GPS configure karein"})]}):(0,R.jsx)("div",{className:"space-y-3",children:K.map(e=>(0,R.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border ".concat(e.gps_enabled?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"),children:[(0,R.jsxs)("div",{className:"flex items-center gap-4",children:[(0,R.jsx)("div",{className:"p-2 rounded-lg ".concat(e.gps_enabled?"bg-green-100":"bg-gray-200"),children:(0,R.jsx)(o.A,{className:"w-5 h-5 ".concat(e.gps_enabled?"text-green-600":"text-gray-500")})}),(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"font-semibold",children:e.vehicle_number}),e.gps_device?(0,R.jsxs)("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[(0,R.jsxs)("p",{children:["IMEI: ",e.gps_device.device_imei]}),(0,R.jsxs)("p",{children:["SIM: ",e.gps_device.sim_number," | Brand: ",e.gps_device.device_brand]})]}):(0,R.jsx)("p",{className:"text-xs text-muted-foreground",children:"GPS not configured"})]})]}),(0,R.jsxs)("div",{className:"flex items-center gap-2",children:[(0,R.jsx)(C.E,{className:e.gps_enabled?"bg-green-100 text-green-700":"pending_activation"===e.status?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-600",children:e.gps_enabled?"Active":e.gps_device?"Pending":"Not Configured"}),!e.gps_enabled&&(0,R.jsxs)(_.$,{size:"sm",variant:"outline",onClick:()=>{ae((0,t.A)((0,t.A)({},se),{},{vehicle_id:e.vehicle_id})),ee(!0)},children:[(0,R.jsx)(j.A,{className:"w-3 h-3 mr-1"})," Configure"]})]})]},e.vehicle_id))})})]}),(0,R.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,R.jsx)(w.Zp,{children:(0,R.jsxs)(w.Wu,{className:"p-5",children:[(0,R.jsxs)("h4",{className:"font-semibold text-gray-900 flex items-center gap-2 mb-3",children:[(0,R.jsx)(f.A,{className:"w-4 h-4 text-green-500"})," NFC Configuration"]}),(0,R.jsxs)("div",{className:"space-y-3",children:[(0,R.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,R.jsx)("span",{className:"text-sm text-gray-700",children:"NFC Reader Mode"}),(0,R.jsx)(C.E,{className:"bg-blue-100 text-blue-700",children:"Mobile Based"})]}),(0,R.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,R.jsx)("span",{className:"text-sm text-gray-700",children:"Card Format"}),(0,R.jsx)("span",{className:"text-sm font-medium",children:"NTAG215 / NTAG213"})]}),(0,R.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,R.jsx)("span",{className:"text-sm text-gray-700",children:"Auto Notification"}),(0,R.jsx)(C.E,{className:"bg-green-100 text-green-700",children:"Enabled"})]}),(0,R.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,R.jsx)("span",{className:"text-sm text-gray-700",children:"Geo-fence Alerts"}),(0,R.jsx)(C.E,{className:"bg-blue-100 text-blue-700",children:"Enabled"})]})]}),(0,R.jsx)("p",{className:"text-xs text-muted-foreground mt-3",children:"Vehicle attender ke NFC-enabled phone par student apna ID card tap karega. Attendance auto-mark hoga."})]})}),(0,R.jsx)(w.Zp,{children:(0,R.jsxs)(w.Wu,{className:"p-5",children:[(0,R.jsxs)("h4",{className:"font-semibold text-gray-900 flex items-center gap-2 mb-3",children:[(0,R.jsx)(c.A,{className:"w-4 h-4 text-amber-500"})," GPS Setup Guide"]}),(0,R.jsxs)("div",{className:"space-y-2",children:[(0,R.jsxs)("div",{className:"flex items-start gap-3 p-2",children:[(0,R.jsx)("span",{className:"w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center text-xs font-bold flex-shrink-0",children:"1"}),(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"text-sm font-medium",children:"GPS Device Khareedein"}),(0,R.jsx)("p",{className:"text-xs text-muted-foreground",children:"Concox GT06N (\u20b92,500) ya Teltonika FMB920 (\u20b94,000)"})]})]}),(0,R.jsxs)("div",{className:"flex items-start gap-3 p-2",children:[(0,R.jsx)("span",{className:"w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center text-xs font-bold flex-shrink-0",children:"2"}),(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"text-sm font-medium",children:"M2M SIM Card Lein"}),(0,R.jsx)("p",{className:"text-xs text-muted-foreground",children:"Jio/Airtel M2M SIM - \u20b950-100/month GPRS plan"})]})]}),(0,R.jsxs)("div",{className:"flex items-start gap-3 p-2",children:[(0,R.jsx)("span",{className:"w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center text-xs font-bold flex-shrink-0",children:"3"}),(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"text-sm font-medium",children:"Vehicle mein Install Karein"}),(0,R.jsx)("p",{className:"text-xs text-muted-foreground",children:"Dashboard ke neeche, ignition wire se connect"})]})]}),(0,R.jsxs)("div",{className:"flex items-start gap-3 p-2",children:[(0,R.jsx)("span",{className:"w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center text-xs font-bold flex-shrink-0",children:"4"}),(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"text-sm font-medium",children:"Yahan Device Add Karein"}),(0,R.jsx)("p",{className:"text-xs text-muted-foreground",children:"IMEI aur SIM number enter karein, 2-5 min mein online"})]})]})]})]})})]})]})]}),(0,R.jsx)(S.lG,{open:B,onOpenChange:Z,children:(0,R.jsxs)(S.Cf,{className:"max-w-lg",children:[(0,R.jsx)(S.c7,{children:(0,R.jsx)(S.L3,{children:s("add_vehicle")})}),(0,R.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),X.vehicle_number&&X.driver_name)try{const e=await fetch("".concat(P,"/api/transport/vehicles?school_id=").concat(U),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)});(await e.json()).success&&(i.oR.success("Vehicle added!"),Z(!1),J({vehicle_number:"",vehicle_type:"bus",capacity:40,driver_name:"",driver_phone:"",conductor_name:"",conductor_phone:""}),te())}catch(s){i.oR.error("Failed to add vehicle")}else i.oR.error("Vehicle number aur Driver name required hai")},className:"space-y-4",children:[(0,R.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsxs)("label",{className:"text-sm font-medium",children:[s("vehicle_number")," *"]}),(0,R.jsx)(A.p,{value:X.vehicle_number,onChange:e=>J((0,t.A)((0,t.A)({},X),{},{vehicle_number:e.target.value})),placeholder:"UP32 AB 1234"})]}),(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:s("type")}),(0,R.jsxs)("select",{value:X.vehicle_type,onChange:e=>J((0,t.A)((0,t.A)({},X),{},{vehicle_type:e.target.value})),className:"w-full h-10 px-3 border rounded-md",children:[(0,R.jsx)("option",{value:"bus",children:"Bus"}),(0,R.jsx)("option",{value:"van",children:"Van"}),(0,R.jsx)("option",{value:"auto",children:"Auto"})]})]})]}),(0,R.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:s("capacity")}),(0,R.jsx)(A.p,{type:"number",value:X.capacity,onChange:e=>J((0,t.A)((0,t.A)({},X),{},{capacity:parseInt(e.target.value)}))})]}),(0,R.jsxs)("div",{children:[(0,R.jsxs)("label",{className:"text-sm font-medium",children:[s("driver_name")," *"]}),(0,R.jsx)(A.p,{value:X.driver_name,onChange:e=>J((0,t.A)((0,t.A)({},X),{},{driver_name:e.target.value})),placeholder:"Driver name"})]})]}),(0,R.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:s("driver_phone")}),(0,R.jsx)(A.p,{value:X.driver_phone,onChange:e=>J((0,t.A)((0,t.A)({},X),{},{driver_phone:e.target.value})),placeholder:"Phone number"})]}),(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Conductor Name"}),(0,R.jsx)(A.p,{value:X.conductor_name,onChange:e=>J((0,t.A)((0,t.A)({},X),{},{conductor_name:e.target.value})),placeholder:"Conductor name"})]})]}),(0,R.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,R.jsx)(_.$,{type:"button",variant:"outline",onClick:()=>Z(!1),children:s("cancel")}),(0,R.jsx)(_.$,{type:"submit",className:"bg-amber-600 hover:bg-amber-700",children:s("add_vehicle")})]})]})]})}),(0,R.jsx)(S.lG,{open:L,onOpenChange:V,children:(0,R.jsxs)(S.Cf,{className:"max-w-lg",children:[(0,R.jsx)(S.c7,{children:(0,R.jsx)(S.L3,{children:s("add_route")})}),(0,R.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),q.route_name&&q.route_number)try{const e=await fetch("".concat(P,"/api/transport/routes?school_id=").concat(U),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});(await e.json()).success&&(i.oR.success("Route created!"),V(!1),te())}catch(s){i.oR.error("Failed to create route")}else i.oR.error("Route name aur number required hai")},className:"space-y-4",children:[(0,R.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsxs)("label",{className:"text-sm font-medium",children:[s("route_name")," *"]}),(0,R.jsx)(A.p,{value:q.route_name,onChange:e=>Y((0,t.A)((0,t.A)({},q),{},{route_name:e.target.value})),placeholder:"Gomti Nagar Route"})]}),(0,R.jsxs)("div",{children:[(0,R.jsxs)("label",{className:"text-sm font-medium",children:[s("route_number")," *"]}),(0,R.jsx)(A.p,{value:q.route_number,onChange:e=>Y((0,t.A)((0,t.A)({},q),{},{route_number:e.target.value})),placeholder:"R-01"})]})]}),(0,R.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Morning Start"}),(0,R.jsx)(A.p,{type:"time",value:q.morning_start_time,onChange:e=>Y((0,t.A)((0,t.A)({},q),{},{morning_start_time:e.target.value}))})]}),(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Evening Start"}),(0,R.jsx)(A.p,{type:"time",value:q.evening_start_time,onChange:e=>Y((0,t.A)((0,t.A)({},q),{},{evening_start_time:e.target.value}))})]})]}),(0,R.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Monthly Fee (\u20b9)"}),(0,R.jsx)(A.p,{type:"number",value:q.monthly_fee,onChange:e=>Y((0,t.A)((0,t.A)({},q),{},{monthly_fee:parseFloat(e.target.value)}))})]}),(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Yearly Fee (\u20b9)"}),(0,R.jsx)(A.p,{type:"number",value:q.yearly_fee,onChange:e=>Y((0,t.A)((0,t.A)({},q),{},{yearly_fee:parseFloat(e.target.value)})),placeholder:"Optional - yearly discount"})]})]}),(0,R.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,R.jsx)(_.$,{type:"button",variant:"outline",onClick:()=>V(!1),children:s("cancel")}),(0,R.jsx)(_.$,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:s("add_route")})]})]})]})}),(0,R.jsx)(S.lG,{open:Q,onOpenChange:ee,children:(0,R.jsxs)(S.Cf,{className:"max-w-lg",children:[(0,R.jsx)(S.c7,{children:(0,R.jsxs)(S.L3,{className:"flex items-center gap-2",children:[(0,R.jsx)(u.A,{className:"w-5 h-5 text-blue-500"}),s("add")," GPS Device"]})}),(0,R.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),se.vehicle_id&&se.device_imei&&se.sim_number)try{const e=new URLSearchParams({school_id:U,vehicle_id:se.vehicle_id,device_imei:se.device_imei,sim_number:se.sim_number,device_brand:se.device_brand});se.server_ip&&e.append("server_ip",se.server_ip),se.server_port&&e.append("server_port",se.server_port);const s=await fetch("".concat(P,"/api/transport/gps-setup/add-device?").concat(e),{method:"POST",headers:{"Content-Type":"application/json"}});(await s.json()).success&&(i.oR.success("GPS Device added successfully!"),ee(!1),ae({vehicle_id:"",device_imei:"",sim_number:"",device_brand:"generic",server_ip:"",server_port:""}),le())}catch(s){i.oR.error("Failed to add GPS device")}else i.oR.error("Vehicle, IMEI aur SIM number required hai")},className:"space-y-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Vehicle *"}),(0,R.jsxs)("select",{value:se.vehicle_id,onChange:e=>ae((0,t.A)((0,t.A)({},se),{},{vehicle_id:e.target.value})),className:"w-full h-10 px-3 border rounded-md",children:[(0,R.jsx)("option",{value:"",children:"-- Select Vehicle --"}),a.map(e=>(0,R.jsxs)("option",{value:e.id,children:[e.vehicle_number," (",e.vehicle_type,")"]},e.id))]})]}),(0,R.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Device IMEI *"}),(0,R.jsx)(A.p,{value:se.device_imei,onChange:e=>ae((0,t.A)((0,t.A)({},se),{},{device_imei:e.target.value})),placeholder:"863456789012345",maxLength:15}),(0,R.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"15 digit IMEI (device par likha hai)"})]}),(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"SIM Number *"}),(0,R.jsx)(A.p,{value:se.sim_number,onChange:e=>ae((0,t.A)((0,t.A)({},se),{},{sim_number:e.target.value})),placeholder:"9876543210"}),(0,R.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"M2M SIM ka number"})]})]}),(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Device Brand"}),(0,R.jsxs)("select",{value:se.device_brand,onChange:e=>ae((0,t.A)((0,t.A)({},se),{},{device_brand:e.target.value})),className:"w-full h-10 px-3 border rounded-md",children:[(0,R.jsx)("option",{value:"generic",children:"Generic / GT06N"}),(0,R.jsx)("option",{value:"concox",children:"Concox"}),(0,R.jsx)("option",{value:"teltonika",children:"Teltonika"}),(0,R.jsx)("option",{value:"queclink",children:"Queclink"}),(0,R.jsx)("option",{value:"other",children:"Other"})]})]}),(0,R.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Server IP (Optional)"}),(0,R.jsx)(A.p,{value:se.server_ip,onChange:e=>ae((0,t.A)((0,t.A)({},se),{},{server_ip:e.target.value})),placeholder:"e.g. 103.x.x.x"})]}),(0,R.jsxs)("div",{children:[(0,R.jsx)("label",{className:"text-sm font-medium",children:"Server Port (Optional)"}),(0,R.jsx)(A.p,{type:"number",value:se.server_port,onChange:e=>ae((0,t.A)((0,t.A)({},se),{},{server_port:e.target.value})),placeholder:"e.g. 5023"})]})]}),(0,R.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:(0,R.jsxs)("p",{className:"text-xs text-amber-800",children:[(0,R.jsx)("strong",{children:"Note:"})," Device install karne ke baad 2-5 minute mein online ho jayega. Agar na ho toh SIM balance aur APN settings check karein."]})}),(0,R.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,R.jsx)(_.$,{type:"button",variant:"outline",onClick:()=>ee(!1),children:s("cancel")}),(0,R.jsxs)(_.$,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[s("add")," Device"]})]})]})]})})]})}}}]);