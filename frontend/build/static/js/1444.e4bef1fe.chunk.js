/*! For license information please see 1444.e4bef1fe.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1444],{1444(e,a,t){t.r(a),t.d(a,{default:()=>y});var s=t(2555),r=t(5043),l=t(6930),c=t(8729),d=t(9722),n=t(247),o=t(5087),i=t(8006),m=t(3172),x=t(1360),h=t(516),u=t(9855),g=t(579);const y=()=>{const{t:e}=(0,l.Bd)(),{user:a}=(0,c.As)(),[t,y]=(0,r.useState)([]),[p,b]=(0,r.useState)(!0),[v,f]=(0,r.useState)(!1),[j,N]=(0,r.useState)({name:"",location:"",stream_url:"",type:"ip"});(0,r.useEffect)(()=>{A()},[null===a||void 0===a?void 0:a.school_id]);const A=async()=>{if(null!==a&&void 0!==a&&a.school_id)try{var e;const t=localStorage.getItem("token"),s=await d.A.get("".concat("","/api/cctv/cameras?school_id=").concat(a.school_id),{headers:{Authorization:"Bearer ".concat(t)}});y((null===(e=s.data)||void 0===e?void 0:e.cameras)||[])}catch(t){y([])}finally{b(!1)}};return(0,g.jsxs)("div",{className:"space-y-6",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:e("cctv_integration")}),(0,g.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Manage and monitor security cameras"})]}),(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[(0,g.jsxs)("button",{onClick:A,className:"px-3 py-2 bg-gray-100 text-gray-600 rounded-lg text-sm hover:bg-gray-200 flex items-center gap-2",children:[(0,g.jsx)(h.A,{className:"w-4 h-4"}),"Refresh"]}),(0,g.jsxs)("button",{onClick:()=>f(!v),className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 flex items-center gap-2",children:[(0,g.jsx)(x.A,{className:"w-4 h-4"}),e("add_camera")]})]})]}),v&&(0,g.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,g.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Add New Camera"}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e("camera_name")}),(0,g.jsx)("input",{type:"text",value:j.name,onChange:e=>N((0,s.A)((0,s.A)({},j),{},{name:e.target.value})),placeholder:"e.g. Main Gate Camera",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e("location")}),(0,g.jsx)("input",{type:"text",value:j.location,onChange:e=>N((0,s.A)((0,s.A)({},j),{},{location:e.target.value})),placeholder:"e.g. Main Entrance",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stream URL / IP"}),(0,g.jsx)("input",{type:"text",value:j.stream_url,onChange:e=>N((0,s.A)((0,s.A)({},j),{},{stream_url:e.target.value})),placeholder:"rtsp://... or http://...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,g.jsxs)("select",{value:j.type,onChange:e=>N((0,s.A)((0,s.A)({},j),{},{type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,g.jsx)("option",{value:"ip",children:"IP Camera"}),(0,g.jsx)("option",{value:"usb",children:"USB Camera"}),(0,g.jsx)("option",{value:"nvr",children:"NVR"})]})]})]}),(0,g.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,g.jsx)("button",{onClick:async()=>{try{const e=localStorage.getItem("token");await d.A.post("".concat("","/api/cctv/cameras"),(0,s.A)((0,s.A)({},j),{},{school_id:null===a||void 0===a?void 0:a.school_id}),{headers:{Authorization:"Bearer ".concat(e)}}),f(!1),N({name:"",location:"",stream_url:"",type:"ip"}),A()}catch(r){var e,t;alert((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to add camera")}},disabled:!j.name||!j.stream_url,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50",children:e("save")}),(0,g.jsx)("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-gray-100 text-gray-600 rounded-lg text-sm hover:bg-gray-200",children:e("cancel")})]})]}),(0,g.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p?Array.from({length:6}).map((e,a)=>(0,g.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-4 animate-pulse",children:[(0,g.jsx)("div",{className:"h-40 bg-gray-200 rounded-lg mb-3"}),(0,g.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),(0,g.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},a)):0===t.length?(0,g.jsxs)("div",{className:"col-span-full bg-white border border-gray-200 rounded-xl p-12 text-center",children:[(0,g.jsx)(n.A,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,g.jsx)("h3",{className:"font-semibold text-gray-900",children:"No Cameras Added"}),(0,g.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Add CCTV cameras to start monitoring"})]}):t.map(a=>(0,g.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden hover:shadow-md transition-shadow",children:[(0,g.jsxs)("div",{className:"h-40 bg-gray-900 flex items-center justify-center relative",children:[(0,g.jsx)(m.A,{className:"w-10 h-10 text-gray-600"}),(0,g.jsxs)("div",{className:"absolute top-2 right-2 flex items-center gap-1",children:[(0,g.jsx)("span",{className:"w-2 h-2 rounded-full ".concat("online"===a.status?"bg-green-500":"bg-red-500")}),(0,g.jsx)("span",{className:"text-[10px] text-white/70",children:a.status||"offline"})]})]}),(0,g.jsxs)("div",{className:"p-4",children:[(0,g.jsx)("h3",{className:"font-semibold text-gray-900 text-sm",children:a.name}),(0,g.jsxs)("p",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[(0,g.jsx)(i.A,{className:"w-3 h-3"}),a.location]}),(0,g.jsxs)("div",{className:"flex items-center gap-2 mt-3",children:[(0,g.jsxs)("button",{className:"flex-1 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg text-xs font-medium hover:bg-blue-100 flex items-center justify-center gap-1",children:[(0,g.jsx)(o.A,{className:"w-3 h-3"}),e("live_feed")]}),(0,g.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Delete this camera?"))try{const a=localStorage.getItem("token");await d.A.delete("".concat("","/api/cctv/cameras/").concat(e),{headers:{Authorization:"Bearer ".concat(a)}}),A()}catch(a){alert("Failed to delete camera")}})(a.id||a._id),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg",children:(0,g.jsx)(u.A,{className:"w-3.5 h-3.5"})})]})]})]},a.id||a._id))})]})}},247(e,a,t){t.d(a,{A:()=>s});const s=(0,t(7784).A)("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},5087(e,a,t){t.d(a,{A:()=>s});const s=(0,t(7784).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8006(e,a,t){t.d(a,{A:()=>s});const s=(0,t(7784).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},3172(e,a,t){t.d(a,{A:()=>s});const s=(0,t(7784).A)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]])},1360(e,a,t){t.d(a,{A:()=>s});const s=(0,t(7784).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},516(e,a,t){t.d(a,{A:()=>s});const s=(0,t(7784).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},9855(e,a,t){t.d(a,{A:()=>s});const s=(0,t(7784).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}}]);
//# sourceMappingURL=1444.e4bef1fe.chunk.js.map