"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2187],{3390(e,s,a){a.d(s,{$:()=>x});var t=a(2555),n=a(3986),l=a(5043),c=a(6851),i=a(917),d=a(1089),r=a(579);const o=["className","variant","size","asChild"],m=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-blue-500 text-white shadow-sm hover:bg-blue-600 rounded-lg",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-gray-200 bg-white shadow-sm hover:bg-gray-50 text-gray-700 rounded-lg",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),x=l.forwardRef((e,s)=>{let{className:a,variant:l,size:i,asChild:x=!1}=e,h=(0,n.A)(e,o);const u=x?c.DX:"button";return(0,r.jsx)(u,(0,t.A)({className:(0,d.cn)(m({variant:l,size:i,className:a})),ref:s},h))});x.displayName="Button"},1140(e,s,a){a.d(s,{BT:()=>g,Wu:()=>f,ZB:()=>j,Zp:()=>u,aR:()=>p});var t=a(2555),n=a(3986),l=a(5043),c=a(1089),i=a(579);const d=["className"],r=["className"],o=["className"],m=["className"],x=["className"],h=["className"],u=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,d);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("rounded-xl border border-gray-200 bg-white text-gray-900 shadow-sm",a)},l))});u.displayName="Card";const p=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,r);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("flex flex-col space-y-1.5 p-5",a)},l))});p.displayName="CardHeader";const j=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("font-semibold leading-none tracking-tight",a)},l))});j.displayName="CardTitle";const g=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,m);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("text-sm text-muted-foreground",a)},l))});g.displayName="CardDescription";const f=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,x);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("p-5 pt-0",a)},l))});f.displayName="CardContent";l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,h);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("flex items-center p-5 pt-0",a)},l))}).displayName="CardFooter"},5598(e,s,a){a.d(s,{Cf:()=>v,L3:()=>y,c7:()=>N,lG:()=>p,rr:()=>b,zM:()=>j});var t=a(2555),n=a(3986),l=a(5043),c=a(7427),i=a(614),d=a(1089),r=a(579);const o=["className"],m=["className","children"],x=["className"],h=["className"],u=["className"],p=c.bL,j=c.l9,g=c.ZL,f=(c.bm,l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,r.jsx)(c.hJ,(0,t.A)({ref:s,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a)},l))}));f.displayName=c.hJ.displayName;const v=l.forwardRef((e,s)=>{let{className:a,children:l}=e,o=(0,n.A)(e,m);return(0,r.jsxs)(g,{children:[(0,r.jsx)(f,{}),(0,r.jsxs)(c.UC,(0,t.A)((0,t.A)({ref:s,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a)},o),{},{children:[l,(0,r.jsxs)(c.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});v.displayName=c.UC.displayName;const N=e=>{let{className:s}=e,a=(0,n.A)(e,x);return(0,r.jsx)("div",(0,t.A)({className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s)},a))};N.displayName="DialogHeader";const y=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,h);return(0,r.jsx)(c.hE,(0,t.A)({ref:s,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",a)},l))});y.displayName=c.hE.displayName;const b=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,u);return(0,r.jsx)(c.VY,(0,t.A)({ref:s,className:(0,d.cn)("text-sm text-muted-foreground",a)},l))});b.displayName=c.VY.displayName},2264(e,s,a){a.d(s,{p:()=>r});var t=a(2555),n=a(3986),l=a(5043),c=a(1089),i=a(579);const d=["className","type"],r=l.forwardRef((e,s)=>{let{className:a,type:l}=e,r=(0,n.A)(e,d);return(0,i.jsx)("input",(0,t.A)({type:l,className:(0,c.cn)("flex h-9 w-full rounded-md border border-input bg-white px-3 py-1 text-base text-gray-900 shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s},r))});r.displayName="Input"},9938(e,s,a){a.d(s,{J:()=>x});var t=a(2555),n=a(3986),l=a(5043),c=a(5131),i=a(917),d=a(1089),r=a(579);const o=["className"],m=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),x=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,r.jsx)(c.b,(0,t.A)({ref:s,className:(0,d.cn)(m(),a)},l))});x.displayName=c.b.displayName},3340(e,s,a){a.d(s,{A0:()=>g,BF:()=>f,Hj:()=>v,XI:()=>j,nA:()=>y,nd:()=>N});var t=a(2555),n=a(3986),l=a(5043),c=a(1089),i=a(579);const d=["className"],r=["className"],o=["className"],m=["className"],x=["className"],h=["className"],u=["className"],p=["className"],j=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,d);return(0,i.jsx)("div",{className:"relative w-full overflow-auto rounded-xl border border-gray-200 bg-white overflow-hidden",children:(0,i.jsx)("table",(0,t.A)({ref:s,className:(0,c.cn)("w-full caption-bottom text-sm",a)},l))})});j.displayName="Table";const g=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,r);return(0,i.jsx)("thead",(0,t.A)({ref:s,className:(0,c.cn)("[&_tr]:border-b bg-gray-50/80",a)},l))});g.displayName="TableHeader";const f=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,i.jsx)("tbody",(0,t.A)({ref:s,className:(0,c.cn)("[&_tr:last-child]:border-0",a)},l))});f.displayName="TableBody";l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,m);return(0,i.jsx)("tfoot",(0,t.A)({ref:s,className:(0,c.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a)},l))}).displayName="TableFooter";const v=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,x);return(0,i.jsx)("tr",(0,t.A)({ref:s,className:(0,c.cn)("border-b transition-colors hover:bg-blue-50/40 data-[state=selected]:bg-muted",a)},l))});v.displayName="TableRow";const N=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,h);return(0,i.jsx)("th",(0,t.A)({ref:s,className:(0,c.cn)("h-11 px-4 text-xs uppercase tracking-wider text-left align-middle font-medium text-gray-600 [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a)},l))});N.displayName="TableHead";const y=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,u);return(0,i.jsx)("td",(0,t.A)({ref:s,className:(0,c.cn)("px-4 py-3 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a)},l))});y.displayName="TableCell";l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,p);return(0,i.jsx)("caption",(0,t.A)({ref:s,className:(0,c.cn)("mt-4 text-sm text-muted-foreground",a)},l))}).displayName="TableCaption"},9690(e,s,a){a.d(s,{Xi:()=>u,av:()=>p,j7:()=>h,tU:()=>x});var t=a(2555),n=a(3986),l=a(5043),c=a(7127),i=a(1089),d=a(579);const r=["className"],o=["className"],m=["className"],x=c.bL,h=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,r);return(0,d.jsx)(c.B8,(0,t.A)({ref:s,className:(0,i.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-gray-100 border border-gray-200 p-1 text-muted-foreground",a)},l))});h.displayName=c.B8.displayName;const u=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,d.jsx)(c.l9,(0,t.A)({ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-blue-500",a)},l))});u.displayName=c.l9.displayName;const p=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,m);return(0,d.jsx)(c.UC,(0,t.A)({ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a)},l))});p.displayName=c.UC.displayName},1089(e,s,a){a.d(s,{cn:()=>l});var t=a(8387),n=a(9359);function l(){for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,n.QP)((0,t.$)(s))}},2187(e,s,a){a.r(s),a.d(s,{default:()=>X});var t=a(2555),n=a(5043),l=a(8729),c=a(477),i=a(6930),d=a(3390),r=a(2264),o=a(9938),m=a(9690),x=a(5598),h=a(3340),u=a(1140),p=a(7819),j=a(2024),g=a(6533),f=a(9233),v=a(3639),N=a(8646),y=a(6210),b=a(2382),_=a(8326),A=a(5088),w=a(6376),C=a(1680),k=a(9797),S=a(7978),R=a(1527),I=a(1360),L=a(2754),F=a(6898),q=a(9292),B=a(7118),T=a(2029),J=a(6328),z=a(9722),D=a(579);const O="".concat("","/api"),$=[{id:"admission_fee",name:"Admission Fee",name_hi:"\u092a\u094d\u0930\u0935\u0947\u0936 \u0936\u0941\u0932\u094d\u0915",frequency:"one_time"},{id:"tuition_fee",name:"Tuition Fee",name_hi:"\u091f\u094d\u092f\u0942\u0936\u0928 \u092b\u0940\u0938",frequency:"monthly"},{id:"exam_fee",name:"Exam Fee",name_hi:"\u092a\u0930\u0940\u0915\u094d\u0937\u093e \u0936\u0941\u0932\u094d\u0915",frequency:"term"},{id:"development_fee",name:"Development Fee",name_hi:"\u0935\u093f\u0915\u093e\u0938 \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"sports_fee",name:"Sports Fee",name_hi:"\u0916\u0947\u0932 \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"computer_fee",name:"Computer Fee",name_hi:"\u0915\u0902\u092a\u094d\u092f\u0942\u091f\u0930 \u0936\u0941\u0932\u094d\u0915",frequency:"monthly"},{id:"lab_fee",name:"Lab Fee",name_hi:"\u0932\u0948\u092c \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"library_fee",name:"Library Fee",name_hi:"\u092a\u0941\u0938\u094d\u0924\u0915\u093e\u0932\u092f \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"transport_fee",name:"Transport Fee",name_hi:"\u092a\u0930\u093f\u0935\u0939\u0928 \u0936\u0941\u0932\u094d\u0915",frequency:"monthly"},{id:"hostel_fee",name:"Hostel Fee",name_hi:"\u091b\u093e\u0924\u094d\u0930\u093e\u0935\u093e\u0938 \u0936\u0941\u0932\u094d\u0915",frequency:"monthly"},{id:"activity_fee",name:"Activity Fee",name_hi:"\u0917\u0924\u093f\u0935\u093f\u0927\u093f \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"uniform_fee",name:"Uniform Fee",name_hi:"\u092f\u0942\u0928\u093f\u092b\u0949\u0930\u094d\u092e \u0936\u0941\u0932\u094d\u0915",frequency:"one_time"},{id:"late_fee",name:"Late Fee",name_hi:"\u0935\u093f\u0932\u0902\u092c \u0936\u0941\u0932\u094d\u0915",frequency:"penalty"},{id:"other_fee",name:"Other Fee",name_hi:"\u0905\u0928\u094d\u092f \u0936\u0941\u0932\u094d\u0915",frequency:"custom"}],P=["April","May","June","July","August","September","October","November","December","January","February","March"],Z=["tuition_fee","transport_fee","computer_fee","hostel_fee"];function H(){const e=new Date,s=e.getMonth(),a=e.getFullYear();return s>=3?"".concat(a,"-").concat(a+1):"".concat(a-1,"-").concat(a)}function E(){const e=(new Date).getFullYear();return["".concat(e-2,"-").concat(e-1),"".concat(e-1,"-").concat(e),"".concat(e,"-").concat(e+1)]}function X(){const{t:e}=(0,i.Bd)(),{schoolId:s,user:a}=(0,l.As)(),{isHindi:X}=(0,c.ok)(),[U,W]=(0,n.useState)("structure"),[M,G]=(0,n.useState)(H()),[V,Y]=(0,n.useState)([]),[Q,K]=(0,n.useState)([]),[ee,se]=(0,n.useState)([]),[ae,te]=(0,n.useState)([]),[ne,le]=(0,n.useState)([]),[ce,ie]=(0,n.useState)(!0),[de,re]=(0,n.useState)(""),[oe,me]=(0,n.useState)(""),[xe,he]=(0,n.useState)(!1),[ue,pe]=(0,n.useState)(!1),[je,ge]=(0,n.useState)(!1),[fe,ve]=(0,n.useState)(null),[Ne,ye]=(0,n.useState)(!1),[be,_e]=(0,n.useState)(null),[Ae,we]=(0,n.useState)([]),[Ce,ke]=(0,n.useState)(null),[Se,Re]=(0,n.useState)({class_id:"",academic_year:H(),tuition_frequency:"monthly",fees:$.reduce((e,s)=>(0,t.A)((0,t.A)({},e),{},{[s.id]:0}),{})}),[Ie,Le]=(0,n.useState)({student_id:"",amount:0,fee_types:[],months:[],fee_items:[],payment_mode:"cash",payment_date:(new Date).toISOString().split("T")[0],receipt_no:"",remarks:"",academic_year:H()}),[Fe,qe]=(0,n.useState)({}),[Be,Te]=(0,n.useState)({}),[Je,ze]=(0,n.useState)({student_id:"",academic_year:"",class_name:"",amount:0,description:"",send_notification:!0}),[De,Oe]=(0,n.useState)([]),[$e,Pe]=(0,n.useState)([]),[Ze,He]=(0,n.useState)(!1),[Ee,Xe]=(0,n.useState)(!1),[Ue,We]=(0,n.useState)({name:"",name_hi:"",type:"central_govt",amount:0,percentage:0,eligibility:"",documents_required:"",academic_year:H()}),[Me,Ge]=(0,n.useState)({student_id:"",scholarship_id:"",amount:0,status:"pending",remarks:""});(0,n.useEffect)(()=>{s&&Ve()},[s,M]);const Ve=async()=>{ie(!0);try{const e=localStorage.getItem("token"),a={Authorization:"Bearer ".concat(e)},[t,n,l,c,i,d,r]=await Promise.all([z.A.get("".concat(O,"/classes?school_id=").concat(s),{headers:a}),z.A.get("".concat(O,"/fee-structures?school_id=").concat(s,"&academic_year=").concat(M),{headers:a}),z.A.get("".concat(O,"/fee-collections?school_id=").concat(s,"&academic_year=").concat(M),{headers:a}),z.A.get("".concat(O,"/old-dues?school_id=").concat(s),{headers:a}),z.A.get("".concat(O,"/scholarships?school_id=").concat(s),{headers:a}).catch(()=>({data:[]})),z.A.get("".concat(O,"/student-scholarships?school_id=").concat(s),{headers:a}).catch(()=>({data:[]})),z.A.get("".concat(O,"/admin/pending-payments?school_id=").concat(s),{headers:a}).catch(()=>({data:[]}))]);Y(t.data),se(n.data),te(l.data),le(c.data||[]),Oe(i.data||[]),Pe(d.data||[]),we(Array.isArray(r.data)?r.data:[])}catch(e){console.error("Error fetching data:",e)}finally{ie(!1)}};(0,n.useEffect)(()=>{s&&async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{const a=localStorage.getItem("token");let t="".concat(O,"/students?school_id=").concat(s,"&status=active");e&&(t+="&class_id=".concat(e)),oe&&(t+="&search=".concat(oe));const n=await z.A.get(t,{headers:{Authorization:"Bearer ".concat(a)}});K(n.data)}catch(a){J.oR.error(X?"\u091b\u093e\u0924\u094d\u0930 \u0921\u0947\u091f\u093e \u0932\u094b\u0921 \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to fetch students")}}(de)},[s,de,oe,U]);const Ye=(e,s)=>!!Z.includes(e)&&("tuition_fee"!==e||"yearly"!==(null===s||void 0===s?void 0:s.tuition_frequency)),Qe=e=>{if(!e||!e.fees)return 0;const s=e.fees,a=e.tuition_frequency||"monthly";let t=0;return Object.entries(s).forEach(e=>{let[s,n]=e;const l=Number(n)||0;l<=0||(Z.includes(s)?t+="tuition_fee"===s&&"yearly"===a?l:12*l:t+=l)}),t},Ke=async(e,s)=>{try{const a=localStorage.getItem("token");await z.A.post("".concat(O,"/admin/verify-payment/").concat(e),{action:s,remarks:""},{headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}}),J.oR.success("approve"===s?"Payment approved!":"Payment rejected"),Ve()}catch(a){J.oR.error("Failed to verify payment")}},es=e=>{ve(e);const s=ts(e.class_id),a={},t={};s&&s.fees&&$.forEach(e=>{const n=Number(s.fees[e.id])||0;n>0&&(a[e.id]={selected:!1,amount:n},Ye(e.id,s)&&(t[e.id]=[]))}),qe(a),Te(t),Le({student_id:e.id,amount:0,fee_types:[],months:[],fee_items:[],payment_mode:"cash",payment_date:(new Date).toISOString().split("T")[0],receipt_no:"",remarks:"",academic_year:M}),pe(!0)},ss=()=>{let e=0;const s=[];return Object.entries(Fe).forEach(a=>{let[t,n]=a;if(!n.selected)return;const l=Number(n.amount)||0;if(void 0!==Be[t]){const a=Be[t]||[];a.length>0&&(e+=l*a.length,s.push({fee_type:t,amount:l,months:[...a]}))}else e+=l,s.push({fee_type:t,amount:l})}),{total:e,items:s}},as=e=>{const s=De.find(s=>s.id===e);return(null===s||void 0===s?void 0:s.name)||"Unknown"},ts=e=>ee.find(s=>s.class_id===e),{total:ns,items:ls}=ss();return s?(0,D.jsxs)("div",{className:"space-y-6","data-testid":"fee-management-page",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("h1",{className:"text-3xl font-bold font-heading text-slate-900 flex items-center gap-2",children:[(0,D.jsx)(T.A,{className:"w-8 h-8 text-emerald-600"}),e("fee_management")]}),(0,D.jsx)("p",{className:"text-slate-500 mt-1",children:e("fee_structure")})]}),(0,D.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,D.jsxs)("div",{className:"flex items-center gap-2 bg-white border rounded-lg px-3 py-2",children:[(0,D.jsx)(N.A,{className:"w-4 h-4 text-emerald-600"}),(0,D.jsx)("select",{value:M,onChange:e=>G(e.target.value),className:"text-sm font-medium border-0 outline-none bg-transparent","data-testid":"academic-year-selector",children:E().map(e=>(0,D.jsx)("option",{value:e,children:e},e))})]}),(0,D.jsxs)(d.$,{variant:"outline",onClick:()=>ge(!0),className:"gap-2 text-orange-600 border-orange-200 hover:bg-orange-50","data-testid":"add-old-due-btn",children:[(0,D.jsx)(S.A,{className:"w-4 h-4"}),e("pending")]}),(0,D.jsxs)(d.$,{onClick:()=>pe(!0),className:"bg-emerald-600 hover:bg-emerald-700 gap-2","data-testid":"collect-fee-btn",children:[(0,D.jsx)(R.A,{className:"w-4 h-4"}),e("collect_fee")]})]})]}),(0,D.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,D.jsx)(u.Zp,{children:(0,D.jsx)(u.Wu,{className:"p-4",children:(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)("div",{className:"p-3 bg-emerald-100 rounded-xl",children:(0,D.jsx)(R.A,{className:"w-6 h-6 text-emerald-600"})}),(0,D.jsxs)("div",{children:[(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("total_collected")}),(0,D.jsxs)("p",{className:"text-2xl font-bold text-emerald-600",children:["\u20b9",ae.reduce((e,s)=>e+(s.amount||0),0).toLocaleString("en-IN")]})]})]})})}),(0,D.jsx)(u.Zp,{children:(0,D.jsx)(u.Wu,{className:"p-4",children:(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)("div",{className:"p-3 bg-orange-100 rounded-xl",children:(0,D.jsx)(A.A,{className:"w-6 h-6 text-orange-600"})}),(0,D.jsxs)("div",{children:[(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("pending")}),(0,D.jsxs)("p",{className:"text-2xl font-bold text-orange-600",children:["\u20b9",ne.reduce((e,s)=>e+(s.amount||0),0).toLocaleString("en-IN")]})]})]})})}),(0,D.jsx)(u.Zp,{children:(0,D.jsx)(u.Wu,{className:"p-4",children:(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)("div",{className:"p-3 bg-blue-100 rounded-xl",children:(0,D.jsx)(F.A,{className:"w-6 h-6 text-blue-600"})}),(0,D.jsxs)("div",{children:[(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("receipt_no")}),(0,D.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:ae.length})]})]})})}),(0,D.jsx)(u.Zp,{children:(0,D.jsx)(u.Wu,{className:"p-4",children:(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)("div",{className:"p-3 bg-purple-100 rounded-xl",children:(0,D.jsx)(k.A,{className:"w-6 h-6 text-purple-600"})}),(0,D.jsxs)("div",{children:[(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("fee_structure")}),(0,D.jsxs)("p",{className:"text-2xl font-bold text-purple-600",children:[ee.length,"/",V.length]})]})]})})})]}),(0,D.jsxs)(m.tU,{value:U,onValueChange:W,className:"w-full",children:[(0,D.jsxs)(m.j7,{className:"grid w-full grid-cols-6 bg-slate-100 p-1 rounded-lg",children:[(0,D.jsxs)(m.Xi,{value:"structure",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,D.jsx)(v.A,{className:"w-4 h-4"}),(0,D.jsx)("span",{className:"hidden md:inline",children:e("fee_structure")}),(0,D.jsx)("span",{className:"md:hidden",children:e("fee_structure")})]}),(0,D.jsxs)(m.Xi,{value:"collection",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,D.jsx)(w.A,{className:"w-4 h-4"}),(0,D.jsx)("span",{className:"hidden md:inline",children:e("total_fee")}),(0,D.jsx)("span",{className:"md:hidden",children:e("total_fee")})]}),(0,D.jsxs)(m.Xi,{value:"scholarships",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,D.jsx)(k.A,{className:"w-4 h-4"}),(0,D.jsx)("span",{className:"hidden md:inline",children:e("discount")}),(0,D.jsx)("span",{className:"md:hidden",children:e("discount")})]}),(0,D.jsxs)(m.Xi,{value:"old_dues",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,D.jsx)(S.A,{className:"w-4 h-4"}),(0,D.jsx)("span",{className:"hidden md:inline",children:e("pending")}),(0,D.jsx)("span",{className:"md:hidden",children:e("pending")})]}),(0,D.jsxs)(m.Xi,{value:"reports",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,D.jsx)(C.A,{className:"w-4 h-4"}),e("reports")]}),(0,D.jsxs)(m.Xi,{value:"online_payments",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm relative",children:[(0,D.jsx)(F.A,{className:"w-4 h-4"}),(0,D.jsx)("span",{className:"hidden md:inline",children:"Online"}),(0,D.jsx)("span",{className:"md:hidden",children:"Online"}),Ae.filter(e=>"pending_verification"===e.status).length>0&&(0,D.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center font-bold",children:Ae.filter(e=>"pending_verification"===e.status).length})]})]}),(0,D.jsx)(m.av,{value:"structure",className:"mt-4",children:(0,D.jsxs)(u.Zp,{children:[(0,D.jsxs)(u.aR,{className:"flex flex-row items-center justify-between",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)(u.ZB,{children:"".concat(e("fee_structure")," (").concat(M,")")}),(0,D.jsx)(u.BT,{children:e("fee_structure")})]}),(0,D.jsxs)(d.$,{onClick:()=>{Re({class_id:"",academic_year:M,tuition_frequency:"monthly",fees:$.reduce((e,s)=>(0,t.A)((0,t.A)({},e),{},{[s.id]:0}),{})}),he(!0)},className:"gap-2",children:[(0,D.jsx)(I.A,{className:"w-4 h-4"}),e("fee_structure")]})]}),(0,D.jsx)(u.Wu,{children:ce?(0,D.jsx)("div",{className:"flex justify-center py-10",children:(0,D.jsx)(j.A,{className:"w-8 h-8 animate-spin text-emerald-600"})}):(0,D.jsxs)(h.XI,{children:[(0,D.jsx)(h.A0,{children:(0,D.jsxs)(h.Hj,{children:[(0,D.jsx)(h.nd,{children:e("select_class")}),(0,D.jsx)(h.nd,{children:e("date")}),(0,D.jsx)(h.nd,{children:e("fee_type")}),(0,D.jsx)(h.nd,{children:e("total_fee")}),(0,D.jsx)(h.nd,{children:e("actions")})]})}),(0,D.jsx)(h.BF,{children:V.map(s=>{const a=ts(s.id),n=(null===a||void 0===a?void 0:a.fees)||{},l=(null===a||void 0===a?void 0:a.tuition_frequency)||"monthly",c=Qe(a),i=$.filter(e=>(Number(n[e.id])||0)>0);return(0,D.jsxs)(h.Hj,{children:[(0,D.jsx)(h.nA,{className:"font-medium",children:s.name}),(0,D.jsx)(h.nA,{className:"text-sm text-slate-500",children:(null===a||void 0===a?void 0:a.academic_year)||"-"}),(0,D.jsx)(h.nA,{children:i.length>0?(0,D.jsx)("div",{className:"flex flex-wrap gap-1",children:i.map(e=>{const s=Number(n[e.id])||0;let a="\u20b9".concat(s.toLocaleString("en-IN"));return"tuition_fee"===e.id?a="\u20b9".concat(s.toLocaleString("en-IN"),"yearly"===l?"/year":"/month"):Z.includes(e.id)&&(a="\u20b9".concat(s.toLocaleString("en-IN"),"/month")),(0,D.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-slate-100 text-slate-700",children:[e.name,": ",a]},e.id)})}):(0,D.jsx)("span",{className:"text-slate-400 text-sm",children:e("not_available")})}),(0,D.jsxs)(h.nA,{className:"font-bold text-emerald-600",children:["\u20b9",c.toLocaleString("en-IN")]}),(0,D.jsx)(h.nA,{children:(0,D.jsx)(d.$,{size:"sm",variant:"outline",onClick:()=>{Re({class_id:s.id,academic_year:(null===a||void 0===a?void 0:a.academic_year)||M,tuition_frequency:(null===a||void 0===a?void 0:a.tuition_frequency)||"monthly",fees:(null===a||void 0===a?void 0:a.fees)||$.reduce((e,s)=>(0,t.A)((0,t.A)({},e),{},{[s.id]:0}),{})}),he(!0)},children:(0,D.jsx)(g.A,{className:"w-4 h-4"})})})]},s.id)})})]})})]})}),(0,D.jsx)(m.av,{value:"collection",className:"mt-4",children:(0,D.jsxs)(u.Zp,{children:[(0,D.jsx)(u.aR,{children:(0,D.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)(u.ZB,{children:"".concat(e("total_fee")," (").concat(M,")")}),(0,D.jsx)(u.BT,{children:e("collect_fee")})]}),(0,D.jsxs)("div",{className:"flex gap-2",children:[(0,D.jsxs)("select",{value:de,onChange:e=>re(e.target.value),className:"px-3 py-2 border rounded-lg text-sm",children:[(0,D.jsx)("option",{value:"",children:e("select_class")}),V.map(e=>(0,D.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)(q.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,D.jsx)(r.p,{placeholder:e("search"),value:oe,onChange:e=>me(e.target.value),className:"pl-9 w-60"})]})]})]})}),(0,D.jsx)(u.Wu,{children:ce?(0,D.jsx)("div",{className:"flex justify-center py-10",children:(0,D.jsx)(j.A,{className:"w-8 h-8 animate-spin text-emerald-600"})}):(0,D.jsxs)("div",{className:"space-y-2",children:[Q.map(s=>{var a;const t=(e=>{const s=ae.filter(s=>s.student_id===e),a=ne.filter(s=>s.student_id===e);return{totalPaid:s.reduce((e,s)=>e+(s.amount||0),0),totalOldDue:a.reduce((e,s)=>e+(s.amount||0),0),collections:s,dues:a}})(s.id),n=ts(s.class_id),l=Qe(n),c=l-t.totalPaid+t.totalOldDue,i=be===s.id;return(0,D.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 hover:bg-slate-50 cursor-pointer",onClick:()=>_e(i?null:s.id),children:[(0,D.jsxs)("div",{className:"flex items-center gap-4",children:[(0,D.jsx)("button",{className:"text-slate-400",children:i?(0,D.jsx)(b.A,{className:"w-5 h-5"}):(0,D.jsx)(_.A,{className:"w-5 h-5"})}),(0,D.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold",children:null===(a=s.name)||void 0===a?void 0:a.charAt(0)}),(0,D.jsxs)("div",{children:[(0,D.jsx)("p",{className:"font-medium",children:s.name}),(0,D.jsxs)("p",{className:"text-sm text-slate-500",children:[s.student_id," \u2022 ",s.class_name]})]})]}),(0,D.jsxs)("div",{className:"flex items-center gap-6",children:[(0,D.jsxs)("div",{className:"text-right",children:[(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("total_fee")}),(0,D.jsxs)("p",{className:"font-semibold",children:["\u20b9",l.toLocaleString("en-IN")]})]}),(0,D.jsxs)("div",{className:"text-right",children:[(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("paid")}),(0,D.jsxs)("p",{className:"font-semibold text-emerald-600",children:["\u20b9",t.totalPaid.toLocaleString("en-IN")]})]}),t.totalOldDue>0&&(0,D.jsxs)("div",{className:"text-right",children:[(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("pending")}),(0,D.jsxs)("p",{className:"font-semibold text-orange-600",children:["\u20b9",t.totalOldDue.toLocaleString("en-IN")]})]}),(0,D.jsxs)("div",{className:"text-right",children:[(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("pending")}),(0,D.jsxs)("p",{className:"font-semibold ".concat(c>0?"text-red-600":"text-emerald-600"),children:["\u20b9",c.toLocaleString("en-IN")]})]}),(0,D.jsx)(d.$,{size:"sm",onClick:e=>{e.stopPropagation(),es(s)},className:"bg-emerald-600 hover:bg-emerald-700",children:e("collect_fee")})]})]}),i&&(0,D.jsx)("div",{className:"border-t bg-slate-50 p-4",children:(0,D.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[(0,D.jsx)(C.A,{className:"w-4 h-4"}),e("fee_type")]}),n?(0,D.jsx)("div",{className:"space-y-2",children:$.filter(e=>{var s;return(Number(null===(s=n.fees)||void 0===s?void 0:s[e.id])||0)>0}).map(e=>{const s=Number(n.fees[e.id])||0;let a="\u20b9".concat(s.toLocaleString("en-IN"));return Ye(e.id,n)&&(a="\u20b9".concat(s.toLocaleString("en-IN"),"/month")),(0,D.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,D.jsx)("span",{children:e.name}),(0,D.jsx)("span",{children:a})]},e.id)})}):(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("fee_structure")})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[(0,D.jsx)(F.A,{className:"w-4 h-4"}),e("payment_date")]}),t.collections.length>0?(0,D.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.collections.slice(0,5).map(e=>{var s;return(0,D.jsxs)("div",{className:"flex justify-between items-center text-sm bg-white p-2 rounded",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("p",{className:"font-medium",children:["\u20b9",null===(s=e.amount)||void 0===s?void 0:s.toLocaleString("en-IN")]}),(0,D.jsx)("p",{className:"text-xs text-slate-500",children:new Date(e.payment_date).toLocaleDateString("en-IN")})]}),(0,D.jsx)(d.$,{size:"sm",variant:"ghost",onClick:()=>(e=>{var s,a;const t=window.open("","_blank"),n=Q.find(s=>s.id===e.student_id);t.document.write("\n      <html>\n      <head>\n        <title>Fee Receipt - ".concat(e.receipt_no,'</title>\n        <style>\n          body { font-family: Arial; padding: 20px; max-width: 400px; margin: auto; }\n          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; }\n          .receipt-no { font-size: 18px; font-weight: bold; }\n          .details { margin: 15px 0; }\n          .row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dotted #ccc; }\n          .amount { font-size: 24px; font-weight: bold; text-align: center; margin: 20px 0; }\n          .footer { text-align: center; font-size: 12px; margin-top: 20px; }\n        </style>\n      </head>\n      <body>\n        <div class="header">\n          <h2>FEE RECEIPT</h2>\n          <div class="receipt-no">').concat(e.receipt_no,'</div>\n        </div>\n        <div class="details">\n          <div class="row"><span>Student Name:</span><span>').concat((null===n||void 0===n?void 0:n.name)||"N/A",'</span></div>\n          <div class="row"><span>Student ID:</span><span>').concat((null===n||void 0===n?void 0:n.student_id)||"N/A",'</span></div>\n          <div class="row"><span>Class:</span><span>').concat((null===n||void 0===n?void 0:n.class_name)||"N/A",'</span></div>\n          <div class="row"><span>Date:</span><span>').concat(new Date(e.payment_date).toLocaleDateString("en-IN"),'</span></div>\n          <div class="row"><span>Payment Mode:</span><span>').concat(null===(s=e.payment_mode)||void 0===s?void 0:s.toUpperCase(),'</span></div>\n        </div>\n        <div class="amount">\u20b9 ').concat(null===(a=e.amount)||void 0===a?void 0:a.toLocaleString("en-IN"),'</div>\n        <div class="footer">\n          <p>Thank you for your payment</p>\n          <p>This is a computer generated receipt</p>\n        </div>\n        <script>window.onload = () => window.print();<\/script>\n      </body>\n      </html>\n    ')),t.document.close()})(e),children:(0,D.jsx)(L.A,{className:"w-4 h-4"})})]},e.id)})}):(0,D.jsx)("p",{className:"text-sm text-slate-500",children:e("paid")})]})]})})]},s.id)}),0===Q.length&&(0,D.jsxs)("div",{className:"text-center py-10 text-slate-500",children:[(0,D.jsx)(B.A,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,D.jsx)("p",{children:e("student")})]})]})})]})}),(0,D.jsx)(m.av,{value:"scholarships",className:"mt-4",children:(0,D.jsxs)("div",{className:"grid gap-4",children:[(0,D.jsx)(u.Zp,{children:(0,D.jsxs)(u.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,D.jsx)(k.A,{className:"w-5 h-5 text-emerald-600"}),e("discount")]}),(0,D.jsx)(u.BT,{children:e("discount")})]}),(0,D.jsxs)("div",{className:"flex gap-2",children:[(0,D.jsxs)(d.$,{onClick:()=>Xe(!0),variant:"outline",className:"gap-2",children:[(0,D.jsx)(B.A,{className:"w-4 h-4"}),e("student")]}),(0,D.jsxs)(d.$,{onClick:()=>He(!0),className:"gap-2 bg-emerald-600 hover:bg-emerald-700",children:[(0,D.jsx)(I.A,{className:"w-4 h-4"}),e("discount")]})]})]})}),(0,D.jsx)("div",{className:"grid md:grid-cols-3 gap-4",children:De.length>0?De.map(s=>(0,D.jsxs)(u.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,D.jsxs)(u.aR,{className:"pb-2",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat("central_govt"===s.type?"bg-blue-100 text-blue-700":"state_govt"===s.type?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"),children:"central_govt"===s.type?e("category"):"state_govt"===s.type?e("state"):e("other")}),(0,D.jsxs)("span",{className:"text-emerald-600 font-bold",children:["\u20b9",(s.amount||0).toLocaleString()]})]}),(0,D.jsx)(u.ZB,{className:"text-base mt-2",children:s.name}),s.name_hi&&(0,D.jsx)("p",{className:"text-sm text-slate-500",children:s.name_hi})]}),(0,D.jsxs)(u.Wu,{className:"pt-0",children:[s.eligibility&&(0,D.jsxs)("p",{className:"text-xs text-slate-600 mb-2",children:[(0,D.jsxs)("strong",{children:[e("required"),":"]})," ",s.eligibility]}),s.documents_required&&(0,D.jsxs)("p",{className:"text-xs text-slate-500",children:[(0,D.jsxs)("strong",{children:[e("documents"),":"]})," ",s.documents_required]}),(0,D.jsxs)("div",{className:"mt-3 pt-2 border-t flex justify-between items-center",children:[(0,D.jsx)("span",{className:"text-xs text-slate-400",children:s.academic_year}),(0,D.jsx)(d.$,{size:"sm",variant:"outline",onClick:()=>{Ge((0,t.A)((0,t.A)({},Me),{},{scholarship_id:s.id,amount:s.amount})),Xe(!0)},children:e("save")})]})]})]},s.id)):(0,D.jsxs)("div",{className:"col-span-3 text-center py-12 text-slate-400",children:[(0,D.jsx)(k.A,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,D.jsx)("p",{children:e("discount")})]})}),(0,D.jsxs)(u.Zp,{children:[(0,D.jsx)(u.aR,{children:(0,D.jsxs)(u.ZB,{className:"text-base flex items-center gap-2",children:[(0,D.jsx)(B.A,{className:"w-4 h-4"}),"".concat(e("student")," (").concat($e.length,")")]})}),(0,D.jsx)(u.Wu,{children:$e.length>0?(0,D.jsxs)(h.XI,{children:[(0,D.jsx)(h.A0,{children:(0,D.jsxs)(h.Hj,{children:[(0,D.jsx)(h.nd,{children:e("student")}),(0,D.jsx)(h.nd,{children:e("discount")}),(0,D.jsx)(h.nd,{children:e("amount")}),(0,D.jsx)(h.nd,{children:e("status")}),(0,D.jsx)(h.nd,{children:e("remarks")})]})}),(0,D.jsx)(h.BF,{children:$e.map((s,a)=>{const t=Q.find(e=>e.id===s.student_id);return(0,D.jsxs)(h.Hj,{children:[(0,D.jsx)(h.nA,{children:(0,D.jsxs)("div",{children:[(0,D.jsx)("p",{className:"font-medium",children:(null===t||void 0===t?void 0:t.name)||s.student_id}),(0,D.jsx)("p",{className:"text-xs text-slate-500",children:null===t||void 0===t?void 0:t.class_name})]})}),(0,D.jsx)(h.nA,{children:as(s.scholarship_id)}),(0,D.jsxs)(h.nA,{className:"font-medium text-emerald-600",children:["\u20b9",(s.amount||0).toLocaleString()]}),(0,D.jsx)(h.nA,{children:(0,D.jsx)("span",{className:"px-2 py-0.5 rounded text-xs ".concat("received"===s.status?"bg-green-100 text-green-700":"approved"===s.status?"bg-blue-100 text-blue-700":"rejected"===s.status?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:"received"===s.status?e("completed"):"approved"===s.status?e("approved"):"rejected"===s.status?e("rejected"):e("pending")})}),(0,D.jsx)(h.nA,{className:"text-sm text-slate-500",children:s.remarks||"-"})]},a)})})]}):(0,D.jsxs)("div",{className:"text-center py-8 text-slate-400",children:[(0,D.jsx)(B.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,D.jsx)("p",{children:e("discount")})]})})]})]})}),(0,D.jsx)(m.av,{value:"old_dues",className:"mt-4",children:(0,D.jsxs)(u.Zp,{children:[(0,D.jsxs)(u.aR,{className:"flex flex-row items-center justify-between",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,D.jsx)(S.A,{className:"w-5 h-5 text-orange-600"}),e("pending")]}),(0,D.jsx)(u.BT,{children:e("pending")})]}),(0,D.jsxs)(d.$,{onClick:()=>ge(!0),className:"gap-2 bg-orange-600 hover:bg-orange-700",children:[(0,D.jsx)(I.A,{className:"w-4 h-4"}),e("pending")]})]}),(0,D.jsx)(u.Wu,{children:ne.length>0?(0,D.jsxs)(h.XI,{children:[(0,D.jsx)(h.A0,{children:(0,D.jsxs)(h.Hj,{children:[(0,D.jsx)(h.nd,{children:e("student")}),(0,D.jsx)(h.nd,{children:e("date")}),(0,D.jsx)(h.nd,{children:e("select_class")}),(0,D.jsx)(h.nd,{children:e("amount")}),(0,D.jsx)(h.nd,{children:e("description")}),(0,D.jsx)(h.nd,{children:e("status")}),(0,D.jsx)(h.nd,{children:e("actions")})]})}),(0,D.jsx)(h.BF,{children:ne.map(s=>{var a;const t=Q.find(e=>e.id===s.student_id);return(0,D.jsxs)(h.Hj,{children:[(0,D.jsx)(h.nA,{children:(0,D.jsxs)("div",{children:[(0,D.jsx)("p",{className:"font-medium",children:(null===t||void 0===t?void 0:t.name)||s.student_name}),(0,D.jsx)("p",{className:"text-xs text-slate-500",children:null===t||void 0===t?void 0:t.student_id})]})}),(0,D.jsx)(h.nA,{children:s.academic_year}),(0,D.jsx)(h.nA,{children:s.class_name}),(0,D.jsxs)(h.nA,{className:"font-semibold text-orange-600",children:["\u20b9",null===(a=s.amount)||void 0===a?void 0:a.toLocaleString("en-IN")]}),(0,D.jsx)(h.nA,{className:"text-sm",children:s.description}),(0,D.jsx)(h.nA,{children:(0,D.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("paid"===s.status?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"),children:"paid"===s.status?e("paid"):e("pending")})}),(0,D.jsx)(h.nA,{children:(0,D.jsx)(d.$,{size:"sm",onClick:()=>{t&&es(t)},className:"bg-emerald-600 hover:bg-emerald-700",children:e("collect_fee")})})]},s.id)})})]}):(0,D.jsxs)("div",{className:"text-center py-10 text-slate-500",children:[(0,D.jsx)(y.A,{className:"w-12 h-12 mx-auto mb-2 text-emerald-500"}),(0,D.jsx)("p",{children:e("pending")})]})})]})}),(0,D.jsx)(m.av,{value:"reports",className:"mt-4",children:(0,D.jsxs)(u.Zp,{children:[(0,D.jsxs)(u.aR,{children:[(0,D.jsx)(u.ZB,{children:"".concat(e("fee_reports")," (").concat(M,")")}),(0,D.jsx)(u.BT,{children:e("class_wise")})]}),(0,D.jsx)(u.Wu,{children:(0,D.jsxs)(h.XI,{children:[(0,D.jsx)(h.A0,{children:(0,D.jsxs)(h.Hj,{children:[(0,D.jsx)(h.nd,{children:e("select_class")}),(0,D.jsx)(h.nd,{children:e("student")}),(0,D.jsx)(h.nd,{children:e("total_fee")}),(0,D.jsx)(h.nd,{children:e("total")}),(0,D.jsx)(h.nd,{children:e("total_collected")}),(0,D.jsx)(h.nd,{children:e("pending")}),(0,D.jsx)(h.nd,{children:"%"})]})}),(0,D.jsx)(h.BF,{children:V.map(e=>{const s=ts(e.id),a=Q.filter(s=>s.class_id===e.id),n=Qe(s),l=ae.filter(e=>a.some(s=>s.id===e.student_id)).reduce((e,s)=>e+(s.amount||0),0);return(0,t.A)((0,t.A)({},e),{},{totalFee:n,totalCollected:l,studentCount:a.length,expectedTotal:n*a.length,pendingTotal:n*a.length-l})}).map(e=>(0,D.jsxs)(h.Hj,{children:[(0,D.jsx)(h.nA,{className:"font-medium",children:e.name}),(0,D.jsx)(h.nA,{children:e.studentCount}),(0,D.jsxs)(h.nA,{children:["\u20b9",e.totalFee.toLocaleString("en-IN")]}),(0,D.jsxs)(h.nA,{children:["\u20b9",e.expectedTotal.toLocaleString("en-IN")]}),(0,D.jsxs)(h.nA,{className:"text-emerald-600 font-semibold",children:["\u20b9",e.totalCollected.toLocaleString("en-IN")]}),(0,D.jsxs)(h.nA,{className:"text-red-600 font-semibold",children:["\u20b9",e.pendingTotal.toLocaleString("en-IN")]}),(0,D.jsx)(h.nA,{children:(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("div",{className:"w-20 h-2 bg-slate-200 rounded-full overflow-hidden",children:(0,D.jsx)("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:"".concat(e.expectedTotal?e.totalCollected/e.expectedTotal*100:0,"%")}})}),(0,D.jsxs)("span",{className:"text-sm",children:[e.expectedTotal?Math.round(e.totalCollected/e.expectedTotal*100):0,"%"]})]})})]},e.id))})]})})]})}),(0,D.jsx)(m.av,{value:"online_payments",className:"mt-4",children:(0,D.jsxs)(u.Zp,{children:[(0,D.jsxs)(u.aR,{children:[(0,D.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,D.jsx)(F.A,{className:"w-5 h-5"}),"Online Payment Verification"]}),(0,D.jsx)(u.BT,{children:"Verify UPI/QR payments submitted by students with screenshots"})]}),(0,D.jsx)(u.Wu,{children:0===Ae.length?(0,D.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,D.jsx)(F.A,{className:"w-12 h-12 mx-auto mb-3 opacity-40"}),(0,D.jsx)("p",{className:"font-medium",children:"No online payments pending"}),(0,D.jsx)("p",{className:"text-sm mt-1",children:"Students' UPI/QR payments will appear here for verification"})]}):(0,D.jsx)("div",{className:"space-y-3",children:Ae.map(e=>{var s,a;return(0,D.jsx)("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-sm transition-all",children:(0,D.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,D.jsx)("span",{className:"font-semibold text-gray-800",children:e.student_name}),(0,D.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full font-medium ".concat("pending_verification"===e.status?"bg-yellow-100 text-yellow-700":"verified"===e.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:"pending_verification"===e.status?"Pending":"verified"===e.status?"Approved":"Rejected"})]}),(0,D.jsx)("p",{className:"text-sm text-gray-500",children:e.class_name}),(0,D.jsxs)("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("span",{className:"text-gray-400",children:"Amount:"})," ",(0,D.jsxs)("span",{className:"font-semibold text-green-600",children:["\u20b9",null===(s=e.amount)||void 0===s?void 0:s.toLocaleString("en-IN")]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("span",{className:"text-gray-400",children:"Mode:"})," ",(0,D.jsx)("span",{className:"font-medium text-gray-700",children:null===(a=e.payment_mode)||void 0===a?void 0:a.toUpperCase()})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("span",{className:"text-gray-400",children:"Txn ID:"})," ",(0,D.jsx)("span",{className:"font-medium text-gray-700",children:e.transaction_id})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("span",{className:"text-gray-400",children:"Date:"})," ",(0,D.jsx)("span",{className:"text-gray-600",children:new Date(e.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]})]}),e.remarks&&(0,D.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.remarks})]}),(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[e.screenshot_url&&(0,D.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>ke(e.screenshot_url),className:"text-xs gap-1",children:[(0,D.jsx)(C.A,{className:"w-3 h-3"})," Screenshot"]}),"pending_verification"===e.status&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(d.$,{size:"sm",onClick:()=>Ke(e.id,"approve"),className:"bg-green-500 hover:bg-green-600 text-white text-xs gap-1",children:[(0,D.jsx)(y.A,{className:"w-3 h-3"})," Approve"]}),(0,D.jsxs)(d.$,{size:"sm",variant:"outline",onClick:()=>Ke(e.id,"reject"),className:"text-red-500 border-red-200 hover:bg-red-50 text-xs gap-1",children:[(0,D.jsx)(p.A,{className:"w-3 h-3"})," Reject"]})]})]})]})},e.id)})})})]})})]}),(0,D.jsx)(x.lG,{open:!!Ce,onOpenChange:()=>ke(null),children:(0,D.jsxs)(x.Cf,{className:"max-w-lg",children:[(0,D.jsx)(x.c7,{children:(0,D.jsx)(x.L3,{children:"Payment Screenshot"})}),Ce&&(0,D.jsx)("img",{src:Ce,alt:"Payment Screenshot",className:"w-full rounded-lg border border-gray-200"})]})}),(0,D.jsx)(x.lG,{open:xe,onOpenChange:he,children:(0,D.jsxs)(x.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,D.jsxs)(x.c7,{children:[(0,D.jsx)(x.L3,{children:e("fee_structure")}),(0,D.jsx)(x.rr,{children:e("fee_type")})]}),(0,D.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,D.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("select_class")," *"]}),(0,D.jsxs)("select",{value:Se.class_id,onChange:e=>Re(s=>(0,t.A)((0,t.A)({},s),{},{class_id:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,D.jsx)("option",{value:"",children:e("select_class")}),V.map(e=>(0,D.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("date")}),(0,D.jsx)("select",{value:Se.academic_year,onChange:e=>Re(s=>(0,t.A)((0,t.A)({},s),{},{academic_year:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:E().map(e=>(0,D.jsx)("option",{value:e,children:e},e))})]})]}),(0,D.jsxs)("div",{className:"border rounded-lg p-4 bg-blue-50",children:[(0,D.jsx)(o.J,{className:"text-sm font-medium",children:e("fee_type")}),(0,D.jsxs)("div",{className:"flex gap-4 mt-2",children:[(0,D.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,D.jsx)("input",{type:"radio",name:"tuition_frequency",value:"monthly",checked:"monthly"===Se.tuition_frequency,onChange:()=>Re(e=>(0,t.A)((0,t.A)({},e),{},{tuition_frequency:"monthly"})),className:"w-4 h-4"}),(0,D.jsx)("span",{className:"text-sm",children:e("monthly_fee")})]}),(0,D.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,D.jsx)("input",{type:"radio",name:"tuition_frequency",value:"yearly",checked:"yearly"===Se.tuition_frequency,onChange:()=>Re(e=>(0,t.A)((0,t.A)({},e),{},{tuition_frequency:"yearly"})),className:"w-4 h-4"}),(0,D.jsx)("span",{className:"text-sm",children:e("annual_fee")})]})]})]}),(0,D.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,D.jsx)("h4",{className:"font-medium mb-4",children:e("fee_type")}),(0,D.jsx)("div",{className:"grid grid-cols-2 gap-4",children:$.map(s=>(0,D.jsxs)("div",{className:"space-y-1",children:[(0,D.jsxs)(o.J,{className:"text-sm",children:["".concat(s.name," (").concat(s.name_hi,")"),Z.includes(s.id)&&(0,D.jsx)("span",{className:"text-xs text-slate-400 ml-1",children:"tuition_fee"===s.id&&"yearly"===Se.tuition_frequency?"(".concat(e("annual_fee"),")"):"(".concat(e("monthly_fee"),")")})]}),(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("span",{className:"text-slate-500",children:"\u20b9"}),(0,D.jsx)(r.p,{type:"number",value:Se.fees[s.id]||"",onChange:e=>Re(a=>(0,t.A)((0,t.A)({},a),{},{fees:(0,t.A)((0,t.A)({},a.fees),{},{[s.id]:parseInt(e.target.value)||0})})),placeholder:"0"})]})]},s.id))})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,D.jsx)(d.$,{variant:"outline",onClick:()=>he(!1),children:e("cancel")}),(0,D.jsxs)(d.$,{onClick:async()=>{if(Se.class_id){ye(!0);try{const e=localStorage.getItem("token");await z.A.post("".concat(O,"/fee-structures"),(0,t.A)((0,t.A)({},Se),{},{school_id:s}),{headers:{Authorization:"Bearer ".concat(e)}}),J.oR.success("Fee structure saved!"),he(!1),Ve()}catch(n){var e,a;J.oR.error((null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||(X?"\u0938\u0947\u0935 \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to save"))}finally{ye(!1)}}else J.oR.error(X?"\u0915\u0943\u092a\u092f\u093e class select \u0915\u0930\u0947\u0902":"Please select a class")},disabled:Ne,className:"bg-emerald-600 hover:bg-emerald-700",children:[Ne?(0,D.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):null,e("save")]})]})]})]})}),(0,D.jsx)(x.lG,{open:ue,onOpenChange:e=>{e||(ve(null),qe({}),Te({})),pe(e)},children:(0,D.jsxs)(x.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,D.jsxs)(x.c7,{children:[(0,D.jsx)(x.L3,{children:e("collect_fee")}),(0,D.jsx)(x.rr,{children:fe?"".concat(fe.name," - ").concat(fe.class_name):e("student")})]}),(0,D.jsxs)("div",{className:"space-y-4 mt-4",children:[!fe&&(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("student")," *"]}),(0,D.jsxs)("select",{value:Ie.student_id,onChange:e=>{const s=Q.find(s=>s.id===e.target.value);s&&es(s)},className:"w-full px-3 py-2 border rounded-lg",children:[(0,D.jsx)("option",{value:"",children:e("student")}),Q.map(e=>(0,D.jsxs)("option",{value:e.id,children:[e.name," (",e.student_id,")"]},e.id))]})]}),fe&&Object.keys(Fe).length>0&&(0,D.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,D.jsx)("h4",{className:"font-medium mb-3",children:e("fee_type")}),(0,D.jsx)("div",{className:"space-y-3",children:Object.entries(Fe).map(s=>{let[a,n]=s;const l=$.find(e=>e.id===a);if(!l)return null;const c=void 0!==Be[a];return(0,D.jsxs)("div",{className:"border rounded p-3 bg-slate-50",children:[(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)("input",{type:"checkbox",checked:n.selected,onChange:e=>{qe(s=>(0,t.A)((0,t.A)({},s),{},{[a]:(0,t.A)((0,t.A)({},s[a]),{},{selected:e.target.checked})}))},className:"w-4 h-4"}),(0,D.jsx)("div",{className:"flex-1",children:(0,D.jsx)("span",{className:"text-sm font-medium",children:"".concat(l.name," (").concat(l.name_hi,")")})}),(0,D.jsxs)("div",{className:"flex items-center gap-1",children:[(0,D.jsx)("span",{className:"text-sm text-slate-500",children:"\u20b9"}),(0,D.jsx)(r.p,{type:"number",value:n.amount,onChange:e=>{qe(s=>(0,t.A)((0,t.A)({},s),{},{[a]:(0,t.A)((0,t.A)({},s[a]),{},{amount:parseInt(e.target.value)||0})}))},className:"w-24 h-8 text-sm"}),c&&(0,D.jsxs)("span",{className:"text-xs text-slate-400",children:["/",e("monthly_fee")]})]})]}),c&&n.selected&&(0,D.jsxs)("div",{className:"mt-2 ml-7",children:[(0,D.jsxs)("p",{className:"text-xs text-slate-500 mb-1",children:[e("monthly_fee"),":"]}),(0,D.jsx)("div",{className:"flex flex-wrap gap-1",children:P.map(e=>{const s=(Be[a]||[]).includes(e);return(0,D.jsx)("button",{type:"button",onClick:()=>{Te(n=>{const l=n[a]||[],c=s?l.filter(s=>s!==e):[...l,e];return(0,t.A)((0,t.A)({},n),{},{[a]:c})})},className:"px-2 py-1 text-xs rounded border ".concat(s?"bg-emerald-100 border-emerald-400 text-emerald-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-100"),children:e},e)})})]})]},a)})})]}),fe&&0===Object.keys(Fe).length&&(0,D.jsxs)("div",{className:"text-center py-6 text-slate-500 border rounded-lg",children:[(0,D.jsx)(p.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,D.jsx)("p",{className:"text-sm",children:e("fee_structure")})]}),ls.length>0&&(0,D.jsxs)("div",{className:"border rounded-lg p-4 bg-emerald-50",children:[(0,D.jsx)("h4",{className:"font-medium mb-2 text-emerald-800",children:e("description")}),(0,D.jsxs)("div",{className:"space-y-1",children:[ls.map((e,s)=>{const a=$.find(s=>s.id===e.fee_type);return(0,D.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,D.jsxs)("span",{children:[(null===a||void 0===a?void 0:a.name)||e.fee_type,e.months&&e.months.length>0&&(0,D.jsxs)("span",{className:"text-xs text-slate-500 ml-1",children:["(",e.months.length," months: ",e.months.join(", "),")"]})]}),(0,D.jsxs)("span",{className:"font-medium",children:["\u20b9",(e.months?e.amount*e.months.length:e.amount).toLocaleString("en-IN")]})]},s)}),(0,D.jsxs)("div",{className:"border-t pt-2 mt-2 flex justify-between font-bold text-emerald-700",children:[(0,D.jsx)("span",{children:e("total")}),(0,D.jsxs)("span",{children:["\u20b9",ns.toLocaleString("en-IN")]})]})]})]}),(0,D.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("payment_mode")}),(0,D.jsxs)("select",{value:Ie.payment_mode,onChange:e=>Le(s=>(0,t.A)((0,t.A)({},s),{},{payment_mode:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,D.jsx)("option",{value:"cash",children:e("cash")}),(0,D.jsx)("option",{value:"upi",children:e("upi")}),(0,D.jsx)("option",{value:"card",children:e("online")}),(0,D.jsx)("option",{value:"bank_transfer",children:e("bank_transfer")}),(0,D.jsx)("option",{value:"cheque",children:e("cheque")})]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("date")}),(0,D.jsx)(r.p,{type:"date",value:Ie.payment_date,onChange:e=>Le(s=>(0,t.A)((0,t.A)({},s),{},{payment_date:e.target.value}))})]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("remarks")}),(0,D.jsx)(r.p,{value:Ie.remarks,onChange:e=>Le(s=>(0,t.A)((0,t.A)({},s),{},{remarks:e.target.value})),placeholder:e("remarks")})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,D.jsx)(d.$,{variant:"outline",onClick:()=>{pe(!1),ve(null),qe({}),Te({})},children:e("cancel")}),(0,D.jsxs)(d.$,{onClick:async()=>{const{total:e,items:n}=ss();if(!Ie.student_id||e<=0)J.oR.error(X?"\u0915\u0943\u092a\u092f\u093e student \u0914\u0930 fee items select \u0915\u0930\u0947\u0902":"Please select student and fee items");else{ye(!0);try{const l=localStorage.getItem("token"),c=await z.A.post("".concat(O,"/fee-collections"),(0,t.A)((0,t.A)({},Ie),{},{amount:e,fee_items:n,academic_year:M,school_id:s,collected_by:null===a||void 0===a?void 0:a.id}),{headers:{Authorization:"Bearer ".concat(l)}});J.oR.success("Fee collected! Receipt No: ".concat(c.data.receipt_no)),pe(!1),ve(null),qe({}),Te({}),Le({student_id:"",amount:0,fee_types:[],months:[],fee_items:[],payment_mode:"cash",payment_date:(new Date).toISOString().split("T")[0],receipt_no:"",remarks:"",academic_year:M}),Ve()}catch(i){var l,c;J.oR.error((null===(l=i.response)||void 0===l||null===(c=l.data)||void 0===c?void 0:c.detail)||(X?"\u092b\u0940\u0938 \u091c\u092e\u093e \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to collect fee"))}finally{ye(!1)}}},disabled:Ne||ns<=0,className:"bg-emerald-600 hover:bg-emerald-700",children:[Ne?(0,D.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,D.jsx)(y.A,{className:"w-4 h-4 mr-2"}),e("collect_fee")," \u20b9",ns.toLocaleString("en-IN")]})]})]})]})}),(0,D.jsx)(x.lG,{open:je,onOpenChange:ge,children:(0,D.jsxs)(x.Cf,{className:"max-w-md",children:[(0,D.jsxs)(x.c7,{children:[(0,D.jsxs)(x.L3,{className:"flex items-center gap-2",children:[(0,D.jsx)(S.A,{className:"w-5 h-5 text-orange-600"}),e("pending")]}),(0,D.jsx)(x.rr,{children:e("pending")})]}),(0,D.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("student")," *"]}),(0,D.jsxs)("select",{value:Je.student_id,onChange:e=>ze(s=>(0,t.A)((0,t.A)({},s),{},{student_id:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,D.jsx)("option",{value:"",children:e("student")}),Q.map(e=>(0,D.jsxs)("option",{value:e.id,children:[e.name," (",e.student_id,")"]},e.id))]})]}),(0,D.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("date")," *"]}),(0,D.jsxs)("select",{value:Je.academic_year,onChange:e=>ze(s=>(0,t.A)((0,t.A)({},s),{},{academic_year:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,D.jsx)("option",{value:"",children:e("date")}),Array.from({length:5},(e,s)=>{const a=(new Date).getFullYear()-s-1;return(0,D.jsxs)("option",{value:"".concat(a,"-").concat(a+1),children:[a,"-",a+1]},a)})]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("select_class")}),(0,D.jsx)(r.p,{value:Je.class_name,onChange:e=>ze(s=>(0,t.A)((0,t.A)({},s),{},{class_name:e.target.value})),placeholder:"e.g., Class 5"})]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("amount")," *"]}),(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("span",{className:"text-xl font-bold",children:"\u20b9"}),(0,D.jsx)(r.p,{type:"number",value:Je.amount,onChange:e=>ze(s=>(0,t.A)((0,t.A)({},s),{},{amount:parseInt(e.target.value)||0})),className:"text-xl font-bold",placeholder:"0"})]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("description")}),(0,D.jsx)(r.p,{value:Je.description,onChange:e=>ze(s=>(0,t.A)((0,t.A)({},s),{},{description:e.target.value})),placeholder:e("description")})]}),(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("input",{type:"checkbox",id:"sendNotification",checked:Je.send_notification,onChange:e=>ze(s=>(0,t.A)((0,t.A)({},s),{},{send_notification:e.target.checked})),className:"w-4 h-4"}),(0,D.jsxs)(o.J,{htmlFor:"sendNotification",className:"flex items-center gap-2 cursor-pointer",children:[(0,D.jsx)(f.A,{className:"w-4 h-4"}),e("send")," ",e("notifications")]})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,D.jsx)(d.$,{variant:"outline",onClick:()=>ge(!1),children:e("cancel")}),(0,D.jsxs)(d.$,{onClick:async()=>{if(!Je.student_id||Je.amount<=0)J.oR.error(X?"\u0915\u0943\u092a\u092f\u093e student \u0914\u0930 amount \u092d\u0930\u0947\u0902":"Please fill student and amount");else{ye(!0);try{const e=localStorage.getItem("token");await z.A.post("".concat(O,"/old-dues"),(0,t.A)((0,t.A)({},Je),{},{school_id:s,added_by:null===a||void 0===a?void 0:a.id}),{headers:{Authorization:"Bearer ".concat(e)}}),J.oR.success("Old due added successfully!"),ge(!1),ze({student_id:"",academic_year:"",class_name:"",amount:0,description:"",send_notification:!0}),Ve()}catch(l){var e,n;J.oR.error((null===(e=l.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||(X?"\u092a\u0941\u0930\u093e\u0928\u0940 \u092c\u0915\u093e\u092f\u093e \u091c\u094b\u0921\u093c\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to add old due"))}finally{ye(!1)}}},disabled:Ne,className:"bg-orange-600 hover:bg-orange-700",children:[Ne?(0,D.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,D.jsx)(I.A,{className:"w-4 h-4 mr-2"}),e("save")]})]})]})]})}),(0,D.jsx)(x.lG,{open:Ze,onOpenChange:He,children:(0,D.jsxs)(x.Cf,{className:"max-w-lg",children:[(0,D.jsxs)(x.c7,{children:[(0,D.jsxs)(x.L3,{className:"flex items-center gap-2",children:[(0,D.jsx)(k.A,{className:"w-5 h-5 text-emerald-600"}),e("discount")]}),(0,D.jsx)(x.rr,{children:e("discount")})]}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("name")," *"]}),(0,D.jsx)(r.p,{value:Ue.name,onChange:e=>We(s=>(0,t.A)((0,t.A)({},s),{},{name:e.target.value})),placeholder:"e.g., Pre Matric Scholarship"})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("name")," (Hindi)"]}),(0,D.jsx)(r.p,{value:Ue.name_hi,onChange:e=>We(s=>(0,t.A)((0,t.A)({},s),{},{name_hi:e.target.value})),placeholder:"e.g., \u092a\u094d\u0930\u0940-\u092e\u0948\u091f\u094d\u0930\u093f\u0915 \u091b\u093e\u0924\u094d\u0930\u0935\u0943\u0924\u094d\u0924\u093f"})]})]}),(0,D.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("type")," *"]}),(0,D.jsxs)("select",{value:Ue.type,onChange:e=>We(s=>(0,t.A)((0,t.A)({},s),{},{type:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,D.jsx)("option",{value:"central_govt",children:e("category")}),(0,D.jsx)("option",{value:"state_govt",children:e("state")}),(0,D.jsx)("option",{value:"private",children:e("other")})]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("date")}),(0,D.jsx)("select",{value:Ue.academic_year,onChange:e=>We(s=>(0,t.A)((0,t.A)({},s),{},{academic_year:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:E().map(e=>(0,D.jsx)("option",{value:e,children:e},e))})]})]}),(0,D.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("amount")," (\u20b9) *"]}),(0,D.jsx)(r.p,{type:"number",value:Ue.amount,onChange:e=>We(s=>(0,t.A)((0,t.A)({},s),{},{amount:parseInt(e.target.value)||0})),placeholder:"0"})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("percentage")}),(0,D.jsx)(r.p,{type:"number",value:Ue.percentage,onChange:e=>We(s=>(0,t.A)((0,t.A)({},s),{},{percentage:parseInt(e.target.value)||0})),placeholder:"0",max:100})]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("required")}),(0,D.jsx)(r.p,{value:Ue.eligibility,onChange:e=>We(s=>(0,t.A)((0,t.A)({},s),{},{eligibility:e.target.value})),placeholder:"e.g., BPL Family, Income < 2.5 Lakh, SC/ST/OBC"})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("documents")}),(0,D.jsx)(r.p,{value:Ue.documents_required,onChange:e=>We(s=>(0,t.A)((0,t.A)({},s),{},{documents_required:e.target.value})),placeholder:"e.g., Aadhar, Income Certificate, Caste Certificate"})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,D.jsx)(d.$,{variant:"outline",onClick:()=>He(!1),children:e("cancel")}),(0,D.jsxs)(d.$,{onClick:async()=>{if(!Ue.name||Ue.amount<=0)J.oR.error(X?"\u0915\u0943\u092a\u092f\u093e scheme name \u0914\u0930 amount \u092d\u0930\u0947\u0902":"Please fill scheme name and amount");else{ye(!0);try{const e=localStorage.getItem("token");await z.A.post("".concat(O,"/scholarships"),(0,t.A)((0,t.A)({},Ue),{},{school_id:s}),{headers:{Authorization:"Bearer ".concat(e)}}),J.oR.success("Scheme saved successfully!"),He(!1),We({name:"",name_hi:"",type:"central_govt",amount:0,percentage:0,eligibility:"",documents_required:"",academic_year:H()}),Ve()}catch(n){var e,a;J.oR.error((null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||(X?"\u092f\u094b\u091c\u0928\u093e \u0938\u0947\u0935 \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to save scheme"))}finally{ye(!1)}}},disabled:Ne,className:"bg-emerald-600 hover:bg-emerald-700",children:[Ne?(0,D.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,D.jsx)(I.A,{className:"w-4 h-4 mr-2"}),e("save")]})]})]})]})}),(0,D.jsx)(x.lG,{open:Ee,onOpenChange:Xe,children:(0,D.jsxs)(x.Cf,{className:"max-w-lg",children:[(0,D.jsxs)(x.c7,{children:[(0,D.jsxs)(x.L3,{className:"flex items-center gap-2",children:[(0,D.jsx)(B.A,{className:"w-5 h-5 text-emerald-600"}),e("discount")]}),(0,D.jsx)(x.rr,{children:e("student")})]}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("student")," *"]}),(0,D.jsxs)("select",{value:Me.student_id,onChange:e=>Ge(s=>(0,t.A)((0,t.A)({},s),{},{student_id:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,D.jsxs)("option",{value:"",children:["-- ",e("student")," --"]}),Q.map(e=>(0,D.jsxs)("option",{value:e.id,children:[e.name," (",e.student_id,") - ",e.class_name]},e.id))]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("discount")," *"]}),(0,D.jsxs)("select",{value:Me.scholarship_id,onChange:e=>{const s=De.find(s=>s.id===e.target.value);Ge(a=>(0,t.A)((0,t.A)({},a),{},{scholarship_id:e.target.value,amount:(null===s||void 0===s?void 0:s.amount)||0}))},className:"w-full px-3 py-2 border rounded-lg",children:[(0,D.jsxs)("option",{value:"",children:["-- ",e("discount")," --"]}),De.map(e=>(0,D.jsxs)("option",{value:e.id,children:[e.name," - \u20b9",(e.amount||0).toLocaleString()]},e.id))]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)(o.J,{children:[e("amount")," (\u20b9)"]}),(0,D.jsx)(r.p,{type:"number",value:Me.amount,onChange:e=>Ge(s=>(0,t.A)((0,t.A)({},s),{},{amount:parseInt(e.target.value)||0}))})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("status")}),(0,D.jsxs)("select",{value:Me.status,onChange:e=>Ge(s=>(0,t.A)((0,t.A)({},s),{},{status:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,D.jsx)("option",{value:"pending",children:e("pending")}),(0,D.jsx)("option",{value:"approved",children:e("approved")}),(0,D.jsx)("option",{value:"received",children:e("completed")}),(0,D.jsx)("option",{value:"rejected",children:e("rejected")})]})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)(o.J,{children:e("remarks")}),(0,D.jsx)(r.p,{value:Me.remarks,onChange:e=>Ge(s=>(0,t.A)((0,t.A)({},s),{},{remarks:e.target.value})),placeholder:e("remarks")})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,D.jsx)(d.$,{variant:"outline",onClick:()=>Xe(!1),children:e("cancel")}),(0,D.jsxs)(d.$,{onClick:async()=>{if(Me.student_id&&Me.scholarship_id){ye(!0);try{const e=localStorage.getItem("token");await z.A.post("".concat(O,"/student-scholarships"),(0,t.A)((0,t.A)({},Me),{},{school_id:s,assigned_by:null===a||void 0===a?void 0:a.id,assigned_date:(new Date).toISOString()}),{headers:{Authorization:"Bearer ".concat(e)}}),J.oR.success("Scholarship assigned to student!"),Xe(!1),Ge({student_id:"",scholarship_id:"",amount:0,status:"pending",remarks:""}),Ve()}catch(l){var e,n;J.oR.error((null===(e=l.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||(X?"\u091b\u093e\u0924\u094d\u0930\u0935\u0943\u0924\u094d\u0924\u093f \u0905\u0938\u093e\u0907\u0928 \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to assign scholarship"))}finally{ye(!1)}}else J.oR.error(X?"\u0915\u0943\u092a\u092f\u093e student \u0914\u0930 scheme select \u0915\u0930\u0947\u0902":"Please select student and scheme")},disabled:Ne,className:"bg-emerald-600 hover:bg-emerald-700",children:[Ne?(0,D.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,D.jsx)(y.A,{className:"w-4 h-4 mr-2"}),e("save")]})]})]})]})})]}):(0,D.jsx)("div",{className:"text-center py-20",children:(0,D.jsxs)("p",{className:"text-slate-500",children:[e("select")," ",e("schools")]})})}}}]);
//# sourceMappingURL=2187.db5855ca.chunk.js.map