"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3546],{1111(e,s,a){a.d(s,{$:()=>x});var t=a(2555),n=a(3986),l=a(9950),c=a(2962),i=a(4364),d=a(9332),r=a(4414);const o=["className","variant","size","asChild"],m=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-blue-500 text-white shadow-sm hover:bg-blue-600 rounded-lg",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-gray-200 bg-white shadow-sm hover:bg-gray-50 text-gray-700 rounded-lg",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),x=l.forwardRef((e,s)=>{let{className:a,variant:l,size:i,asChild:x=!1}=e,h=(0,n.A)(e,o);const u=x?c.DX:"button";return(0,r.jsx)(u,(0,t.A)({className:(0,d.cn)(m({variant:l,size:i,className:a})),ref:s},h))});x.displayName="Button"},4245(e,s,a){a.d(s,{BT:()=>f,Wu:()=>g,ZB:()=>j,Zp:()=>u,aR:()=>p});var t=a(2555),n=a(3986),l=a(9950),c=a(9332),i=a(4414);const d=["className"],r=["className"],o=["className"],m=["className"],x=["className"],h=["className"],u=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,d);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("rounded-xl border border-gray-200 bg-white text-gray-900 shadow-sm",a)},l))});u.displayName="Card";const p=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,r);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("flex flex-col space-y-1.5 p-5",a)},l))});p.displayName="CardHeader";const j=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("font-semibold leading-none tracking-tight",a)},l))});j.displayName="CardTitle";const f=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,m);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("text-sm text-muted-foreground",a)},l))});f.displayName="CardDescription";const g=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,x);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("p-5 pt-0",a)},l))});g.displayName="CardContent";l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,h);return(0,i.jsx)("div",(0,t.A)({ref:s,className:(0,c.cn)("flex items-center p-5 pt-0",a)},l))}).displayName="CardFooter"},7255(e,s,a){a.d(s,{Cf:()=>v,L3:()=>y,c7:()=>N,lG:()=>p,rr:()=>b,zM:()=>j});var t=a(2555),n=a(3986),l=a(9950),c=a(9710),i=a(6479),d=a(9332),r=a(4414);const o=["className"],m=["className","children"],x=["className"],h=["className"],u=["className"],p=c.bL,j=c.l9,f=c.ZL,g=(c.bm,l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,r.jsx)(c.hJ,(0,t.A)({ref:s,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a)},l))}));g.displayName=c.hJ.displayName;const v=l.forwardRef((e,s)=>{let{className:a,children:l}=e,o=(0,n.A)(e,m);return(0,r.jsxs)(f,{children:[(0,r.jsx)(g,{}),(0,r.jsxs)(c.UC,(0,t.A)((0,t.A)({ref:s,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a)},o),{},{children:[l,(0,r.jsxs)(c.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});v.displayName=c.UC.displayName;const N=e=>{let{className:s}=e,a=(0,n.A)(e,x);return(0,r.jsx)("div",(0,t.A)({className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s)},a))};N.displayName="DialogHeader";const y=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,h);return(0,r.jsx)(c.hE,(0,t.A)({ref:s,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",a)},l))});y.displayName=c.hE.displayName;const b=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,u);return(0,r.jsx)(c.VY,(0,t.A)({ref:s,className:(0,d.cn)("text-sm text-muted-foreground",a)},l))});b.displayName=c.VY.displayName},4779(e,s,a){a.d(s,{p:()=>r});var t=a(2555),n=a(3986),l=a(9950),c=a(9332),i=a(4414);const d=["className","type"],r=l.forwardRef((e,s)=>{let{className:a,type:l}=e,r=(0,n.A)(e,d);return(0,i.jsx)("input",(0,t.A)({type:l,className:(0,c.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s},r))});r.displayName="Input"},557(e,s,a){a.d(s,{J:()=>x});var t=a(2555),n=a(3986),l=a(9950),c=a(1611),i=a(4364),d=a(9332),r=a(4414);const o=["className"],m=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),x=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,r.jsx)(c.b,(0,t.A)({ref:s,className:(0,d.cn)(m(),a)},l))});x.displayName=c.b.displayName},3787(e,s,a){a.d(s,{A0:()=>f,BF:()=>g,Hj:()=>v,XI:()=>j,nA:()=>y,nd:()=>N});var t=a(2555),n=a(3986),l=a(9950),c=a(9332),i=a(4414);const d=["className"],r=["className"],o=["className"],m=["className"],x=["className"],h=["className"],u=["className"],p=["className"],j=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,d);return(0,i.jsx)("div",{className:"relative w-full overflow-auto rounded-xl border border-gray-200 bg-white overflow-hidden",children:(0,i.jsx)("table",(0,t.A)({ref:s,className:(0,c.cn)("w-full caption-bottom text-sm",a)},l))})});j.displayName="Table";const f=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,r);return(0,i.jsx)("thead",(0,t.A)({ref:s,className:(0,c.cn)("[&_tr]:border-b bg-gray-50/80",a)},l))});f.displayName="TableHeader";const g=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,i.jsx)("tbody",(0,t.A)({ref:s,className:(0,c.cn)("[&_tr:last-child]:border-0",a)},l))});g.displayName="TableBody";l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,m);return(0,i.jsx)("tfoot",(0,t.A)({ref:s,className:(0,c.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a)},l))}).displayName="TableFooter";const v=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,x);return(0,i.jsx)("tr",(0,t.A)({ref:s,className:(0,c.cn)("border-b transition-colors hover:bg-blue-50/40 data-[state=selected]:bg-muted",a)},l))});v.displayName="TableRow";const N=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,h);return(0,i.jsx)("th",(0,t.A)({ref:s,className:(0,c.cn)("h-11 px-4 text-xs uppercase tracking-wider text-left align-middle font-medium text-gray-600 [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a)},l))});N.displayName="TableHead";const y=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,u);return(0,i.jsx)("td",(0,t.A)({ref:s,className:(0,c.cn)("px-4 py-3 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a)},l))});y.displayName="TableCell";l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,p);return(0,i.jsx)("caption",(0,t.A)({ref:s,className:(0,c.cn)("mt-4 text-sm text-muted-foreground",a)},l))}).displayName="TableCaption"},5475(e,s,a){a.d(s,{Xi:()=>u,av:()=>p,j7:()=>h,tU:()=>x});var t=a(2555),n=a(3986),l=a(9950),c=a(7970),i=a(9332),d=a(4414);const r=["className"],o=["className"],m=["className"],x=c.bL,h=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,r);return(0,d.jsx)(c.B8,(0,t.A)({ref:s,className:(0,i.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-gray-100 border border-gray-200 p-1 text-muted-foreground",a)},l))});h.displayName=c.B8.displayName;const u=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,o);return(0,d.jsx)(c.l9,(0,t.A)({ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-blue-500",a)},l))});u.displayName=c.l9.displayName;const p=l.forwardRef((e,s)=>{let{className:a}=e,l=(0,n.A)(e,m);return(0,d.jsx)(c.UC,(0,t.A)({ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a)},l))});p.displayName=c.UC.displayName},9332(e,s,a){a.d(s,{cn:()=>l});var t=a(2004),n=a(9800);function l(){for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,n.QP)((0,t.$)(s))}},3546(e,s,a){a.r(s),a.d(s,{default:()=>X});var t=a(2555),n=a(9950),l=a(5532),c=a(5412),i=a(5030),d=a(1111),r=a(4779),o=a(557),m=a(5475),x=a(7255),h=a(3787),u=a(4245),p=a(2828),j=a(2989),f=a(978),g=a(1850),v=a(9284),N=a(9201),y=a(6311),b=a(7453),_=a(983),A=a(7737),w=a(1041),C=a(7637),k=a(8890),S=a(319),I=a(552),R=a(2607),F=a(5107),L=a(3067),q=a(3147),B=a(9975),J=a(6958),T=a(2033),z=a(6910),$=a(4414);const D="".concat("","/api"),O=[{id:"admission_fee",name:"Admission Fee",name_hi:"\u092a\u094d\u0930\u0935\u0947\u0936 \u0936\u0941\u0932\u094d\u0915",frequency:"one_time"},{id:"tuition_fee",name:"Tuition Fee",name_hi:"\u091f\u094d\u092f\u0942\u0936\u0928 \u092b\u0940\u0938",frequency:"monthly"},{id:"exam_fee",name:"Exam Fee",name_hi:"\u092a\u0930\u0940\u0915\u094d\u0937\u093e \u0936\u0941\u0932\u094d\u0915",frequency:"term"},{id:"development_fee",name:"Development Fee",name_hi:"\u0935\u093f\u0915\u093e\u0938 \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"sports_fee",name:"Sports Fee",name_hi:"\u0916\u0947\u0932 \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"computer_fee",name:"Computer Fee",name_hi:"\u0915\u0902\u092a\u094d\u092f\u0942\u091f\u0930 \u0936\u0941\u0932\u094d\u0915",frequency:"monthly"},{id:"lab_fee",name:"Lab Fee",name_hi:"\u0932\u0948\u092c \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"library_fee",name:"Library Fee",name_hi:"\u092a\u0941\u0938\u094d\u0924\u0915\u093e\u0932\u092f \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"transport_fee",name:"Transport Fee",name_hi:"\u092a\u0930\u093f\u0935\u0939\u0928 \u0936\u0941\u0932\u094d\u0915",frequency:"monthly"},{id:"hostel_fee",name:"Hostel Fee",name_hi:"\u091b\u093e\u0924\u094d\u0930\u093e\u0935\u093e\u0938 \u0936\u0941\u0932\u094d\u0915",frequency:"monthly"},{id:"activity_fee",name:"Activity Fee",name_hi:"\u0917\u0924\u093f\u0935\u093f\u0927\u093f \u0936\u0941\u0932\u094d\u0915",frequency:"annual"},{id:"uniform_fee",name:"Uniform Fee",name_hi:"\u092f\u0942\u0928\u093f\u092b\u0949\u0930\u094d\u092e \u0936\u0941\u0932\u094d\u0915",frequency:"one_time"},{id:"late_fee",name:"Late Fee",name_hi:"\u0935\u093f\u0932\u0902\u092c \u0936\u0941\u0932\u094d\u0915",frequency:"penalty"},{id:"other_fee",name:"Other Fee",name_hi:"\u0905\u0928\u094d\u092f \u0936\u0941\u0932\u094d\u0915",frequency:"custom"}],Z=["April","May","June","July","August","September","October","November","December","January","February","March"],H=["tuition_fee","transport_fee","computer_fee","hostel_fee"];function P(){const e=new Date,s=e.getMonth(),a=e.getFullYear();return s>=3?"".concat(a,"-").concat(a+1):"".concat(a-1,"-").concat(a)}function E(){const e=(new Date).getFullYear();return["".concat(e-2,"-").concat(e-1),"".concat(e-1,"-").concat(e),"".concat(e,"-").concat(e+1)]}function X(){const{t:e}=(0,i.Bd)(),{schoolId:s,user:a}=(0,l.As)(),{isHindi:X}=(0,c.ok)(),[W,U]=(0,n.useState)("structure"),[M,G]=(0,n.useState)(P()),[Y,V]=(0,n.useState)([]),[Q,K]=(0,n.useState)([]),[ee,se]=(0,n.useState)([]),[ae,te]=(0,n.useState)([]),[ne,le]=(0,n.useState)([]),[ce,ie]=(0,n.useState)(!0),[de,re]=(0,n.useState)(""),[oe,me]=(0,n.useState)(""),[xe,he]=(0,n.useState)(!1),[ue,pe]=(0,n.useState)(!1),[je,fe]=(0,n.useState)(!1),[ge,ve]=(0,n.useState)(null),[Ne,ye]=(0,n.useState)(!1),[be,_e]=(0,n.useState)(null),[Ae,we]=(0,n.useState)({class_id:"",academic_year:P(),tuition_frequency:"monthly",fees:O.reduce((e,s)=>(0,t.A)((0,t.A)({},e),{},{[s.id]:0}),{})}),[Ce,ke]=(0,n.useState)({student_id:"",amount:0,fee_types:[],months:[],fee_items:[],payment_mode:"cash",payment_date:(new Date).toISOString().split("T")[0],receipt_no:"",remarks:"",academic_year:P()}),[Se,Ie]=(0,n.useState)({}),[Re,Fe]=(0,n.useState)({}),[Le,qe]=(0,n.useState)({student_id:"",academic_year:"",class_name:"",amount:0,description:"",send_notification:!0}),[Be,Je]=(0,n.useState)([]),[Te,ze]=(0,n.useState)([]),[$e,De]=(0,n.useState)(!1),[Oe,Ze]=(0,n.useState)(!1),[He,Pe]=(0,n.useState)({name:"",name_hi:"",type:"central_govt",amount:0,percentage:0,eligibility:"",documents_required:"",academic_year:P()}),[Ee,Xe]=(0,n.useState)({student_id:"",scholarship_id:"",amount:0,status:"pending",remarks:""});(0,n.useEffect)(()=>{s&&We()},[s,M]);const We=async()=>{ie(!0);try{const e=localStorage.getItem("token"),a={Authorization:"Bearer ".concat(e)},[t,n,l,c,i,d]=await Promise.all([z.A.get("".concat(D,"/classes?school_id=").concat(s),{headers:a}),z.A.get("".concat(D,"/fee-structures?school_id=").concat(s,"&academic_year=").concat(M),{headers:a}),z.A.get("".concat(D,"/fee-collections?school_id=").concat(s,"&academic_year=").concat(M),{headers:a}),z.A.get("".concat(D,"/old-dues?school_id=").concat(s),{headers:a}),z.A.get("".concat(D,"/scholarships?school_id=").concat(s),{headers:a}).catch(()=>({data:[]})),z.A.get("".concat(D,"/student-scholarships?school_id=").concat(s),{headers:a}).catch(()=>({data:[]}))]);V(t.data),se(n.data),te(l.data),le(c.data||[]),Je(i.data||[]),ze(d.data||[])}catch(e){console.error("Error fetching data:",e)}finally{ie(!1)}};(0,n.useEffect)(()=>{s&&async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{const a=localStorage.getItem("token");let t="".concat(D,"/students?school_id=").concat(s,"&status=active");e&&(t+="&class_id=".concat(e)),oe&&(t+="&search=".concat(oe));const n=await z.A.get(t,{headers:{Authorization:"Bearer ".concat(a)}});K(n.data)}catch(a){T.oR.error(X?"\u091b\u093e\u0924\u094d\u0930 \u0921\u0947\u091f\u093e \u0932\u094b\u0921 \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to fetch students")}}(de)},[s,de,oe,W]);const Ue=(e,s)=>!!H.includes(e)&&("tuition_fee"!==e||"yearly"!==(null===s||void 0===s?void 0:s.tuition_frequency)),Me=e=>{if(!e||!e.fees)return 0;const s=e.fees,a=e.tuition_frequency||"monthly";let t=0;return Object.entries(s).forEach(e=>{let[s,n]=e;const l=Number(n)||0;l<=0||(H.includes(s)?t+="tuition_fee"===s&&"yearly"===a?l:12*l:t+=l)}),t},Ge=e=>{ve(e);const s=Qe(e.class_id),a={},t={};s&&s.fees&&O.forEach(e=>{const n=Number(s.fees[e.id])||0;n>0&&(a[e.id]={selected:!1,amount:n},Ue(e.id,s)&&(t[e.id]=[]))}),Ie(a),Fe(t),ke({student_id:e.id,amount:0,fee_types:[],months:[],fee_items:[],payment_mode:"cash",payment_date:(new Date).toISOString().split("T")[0],receipt_no:"",remarks:"",academic_year:M}),pe(!0)},Ye=()=>{let e=0;const s=[];return Object.entries(Se).forEach(a=>{let[t,n]=a;if(!n.selected)return;const l=Number(n.amount)||0;if(void 0!==Re[t]){const a=Re[t]||[];a.length>0&&(e+=l*a.length,s.push({fee_type:t,amount:l,months:[...a]}))}else e+=l,s.push({fee_type:t,amount:l})}),{total:e,items:s}},Ve=e=>{const s=Be.find(s=>s.id===e);return(null===s||void 0===s?void 0:s.name)||"Unknown"},Qe=e=>ee.find(s=>s.class_id===e),{total:Ke,items:es}=Ye();return s?(0,$.jsxs)("div",{className:"space-y-6","data-testid":"fee-management-page",children:[(0,$.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[(0,$.jsxs)("div",{children:[(0,$.jsxs)("h1",{className:"text-3xl font-bold font-heading text-slate-900 flex items-center gap-2",children:[(0,$.jsx)(J.A,{className:"w-8 h-8 text-emerald-600"}),e("fee_management")]}),(0,$.jsx)("p",{className:"text-slate-500 mt-1",children:e("fee_structure")})]}),(0,$.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,$.jsxs)("div",{className:"flex items-center gap-2 bg-white border rounded-lg px-3 py-2",children:[(0,$.jsx)(N.A,{className:"w-4 h-4 text-emerald-600"}),(0,$.jsx)("select",{value:M,onChange:e=>G(e.target.value),className:"text-sm font-medium border-0 outline-none bg-transparent","data-testid":"academic-year-selector",children:E().map(e=>(0,$.jsx)("option",{value:e,children:e},e))})]}),(0,$.jsxs)(d.$,{variant:"outline",onClick:()=>fe(!0),className:"gap-2 text-orange-600 border-orange-200 hover:bg-orange-50","data-testid":"add-old-due-btn",children:[(0,$.jsx)(S.A,{className:"w-4 h-4"}),e("pending")]}),(0,$.jsxs)(d.$,{onClick:()=>pe(!0),className:"bg-emerald-600 hover:bg-emerald-700 gap-2","data-testid":"collect-fee-btn",children:[(0,$.jsx)(I.A,{className:"w-4 h-4"}),e("collect_fee")]})]})]}),(0,$.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,$.jsx)(u.Zp,{children:(0,$.jsx)(u.Wu,{className:"p-4",children:(0,$.jsxs)("div",{className:"flex items-center gap-3",children:[(0,$.jsx)("div",{className:"p-3 bg-emerald-100 rounded-xl",children:(0,$.jsx)(I.A,{className:"w-6 h-6 text-emerald-600"})}),(0,$.jsxs)("div",{children:[(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("total_collected")}),(0,$.jsxs)("p",{className:"text-2xl font-bold text-emerald-600",children:["\u20b9",ae.reduce((e,s)=>e+(s.amount||0),0).toLocaleString("en-IN")]})]})]})})}),(0,$.jsx)(u.Zp,{children:(0,$.jsx)(u.Wu,{className:"p-4",children:(0,$.jsxs)("div",{className:"flex items-center gap-3",children:[(0,$.jsx)("div",{className:"p-3 bg-orange-100 rounded-xl",children:(0,$.jsx)(A.A,{className:"w-6 h-6 text-orange-600"})}),(0,$.jsxs)("div",{children:[(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("pending")}),(0,$.jsxs)("p",{className:"text-2xl font-bold text-orange-600",children:["\u20b9",ne.reduce((e,s)=>e+(s.amount||0),0).toLocaleString("en-IN")]})]})]})})}),(0,$.jsx)(u.Zp,{children:(0,$.jsx)(u.Wu,{className:"p-4",children:(0,$.jsxs)("div",{className:"flex items-center gap-3",children:[(0,$.jsx)("div",{className:"p-3 bg-blue-100 rounded-xl",children:(0,$.jsx)(L.A,{className:"w-6 h-6 text-blue-600"})}),(0,$.jsxs)("div",{children:[(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("receipt_no")}),(0,$.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:ae.length})]})]})})}),(0,$.jsx)(u.Zp,{children:(0,$.jsx)(u.Wu,{className:"p-4",children:(0,$.jsxs)("div",{className:"flex items-center gap-3",children:[(0,$.jsx)("div",{className:"p-3 bg-purple-100 rounded-xl",children:(0,$.jsx)(k.A,{className:"w-6 h-6 text-purple-600"})}),(0,$.jsxs)("div",{children:[(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("fee_structure")}),(0,$.jsxs)("p",{className:"text-2xl font-bold text-purple-600",children:[ee.length,"/",Y.length]})]})]})})})]}),(0,$.jsxs)(m.tU,{value:W,onValueChange:U,className:"w-full",children:[(0,$.jsxs)(m.j7,{className:"grid w-full grid-cols-5 bg-slate-100 p-1 rounded-lg",children:[(0,$.jsxs)(m.Xi,{value:"structure",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,$.jsx)(v.A,{className:"w-4 h-4"}),(0,$.jsx)("span",{className:"hidden md:inline",children:e("fee_structure")}),(0,$.jsx)("span",{className:"md:hidden",children:e("fee_structure")})]}),(0,$.jsxs)(m.Xi,{value:"collection",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,$.jsx)(w.A,{className:"w-4 h-4"}),(0,$.jsx)("span",{className:"hidden md:inline",children:e("total_fee")}),(0,$.jsx)("span",{className:"md:hidden",children:e("total_fee")})]}),(0,$.jsxs)(m.Xi,{value:"scholarships",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,$.jsx)(k.A,{className:"w-4 h-4"}),(0,$.jsx)("span",{className:"hidden md:inline",children:e("discount")}),(0,$.jsx)("span",{className:"md:hidden",children:e("discount")})]}),(0,$.jsxs)(m.Xi,{value:"old_dues",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,$.jsx)(S.A,{className:"w-4 h-4"}),(0,$.jsx)("span",{className:"hidden md:inline",children:e("pending")}),(0,$.jsx)("span",{className:"md:hidden",children:e("pending")})]}),(0,$.jsxs)(m.Xi,{value:"reports",className:"gap-2 data-[state=active]:bg-white text-xs md:text-sm",children:[(0,$.jsx)(C.A,{className:"w-4 h-4"}),e("reports")]})]}),(0,$.jsx)(m.av,{value:"structure",className:"mt-4",children:(0,$.jsxs)(u.Zp,{children:[(0,$.jsxs)(u.aR,{className:"flex flex-row items-center justify-between",children:[(0,$.jsxs)("div",{children:[(0,$.jsx)(u.ZB,{children:"".concat(e("fee_structure")," (").concat(M,")")}),(0,$.jsx)(u.BT,{children:e("fee_structure")})]}),(0,$.jsxs)(d.$,{onClick:()=>{we({class_id:"",academic_year:M,tuition_frequency:"monthly",fees:O.reduce((e,s)=>(0,t.A)((0,t.A)({},e),{},{[s.id]:0}),{})}),he(!0)},className:"gap-2",children:[(0,$.jsx)(R.A,{className:"w-4 h-4"}),e("fee_structure")]})]}),(0,$.jsx)(u.Wu,{children:ce?(0,$.jsx)("div",{className:"flex justify-center py-10",children:(0,$.jsx)(j.A,{className:"w-8 h-8 animate-spin text-emerald-600"})}):(0,$.jsxs)(h.XI,{children:[(0,$.jsx)(h.A0,{children:(0,$.jsxs)(h.Hj,{children:[(0,$.jsx)(h.nd,{children:e("select_class")}),(0,$.jsx)(h.nd,{children:e("date")}),(0,$.jsx)(h.nd,{children:e("fee_type")}),(0,$.jsx)(h.nd,{children:e("total_fee")}),(0,$.jsx)(h.nd,{children:e("actions")})]})}),(0,$.jsx)(h.BF,{children:Y.map(s=>{const a=Qe(s.id),n=(null===a||void 0===a?void 0:a.fees)||{},l=(null===a||void 0===a?void 0:a.tuition_frequency)||"monthly",c=Me(a),i=O.filter(e=>(Number(n[e.id])||0)>0);return(0,$.jsxs)(h.Hj,{children:[(0,$.jsx)(h.nA,{className:"font-medium",children:s.name}),(0,$.jsx)(h.nA,{className:"text-sm text-slate-500",children:(null===a||void 0===a?void 0:a.academic_year)||"-"}),(0,$.jsx)(h.nA,{children:i.length>0?(0,$.jsx)("div",{className:"flex flex-wrap gap-1",children:i.map(e=>{const s=Number(n[e.id])||0;let a="\u20b9".concat(s.toLocaleString("en-IN"));return"tuition_fee"===e.id?a="\u20b9".concat(s.toLocaleString("en-IN"),"yearly"===l?"/year":"/month"):H.includes(e.id)&&(a="\u20b9".concat(s.toLocaleString("en-IN"),"/month")),(0,$.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-slate-100 text-slate-700",children:[e.name,": ",a]},e.id)})}):(0,$.jsx)("span",{className:"text-slate-400 text-sm",children:e("not_available")})}),(0,$.jsxs)(h.nA,{className:"font-bold text-emerald-600",children:["\u20b9",c.toLocaleString("en-IN")]}),(0,$.jsx)(h.nA,{children:(0,$.jsx)(d.$,{size:"sm",variant:"outline",onClick:()=>{we({class_id:s.id,academic_year:(null===a||void 0===a?void 0:a.academic_year)||M,tuition_frequency:(null===a||void 0===a?void 0:a.tuition_frequency)||"monthly",fees:(null===a||void 0===a?void 0:a.fees)||O.reduce((e,s)=>(0,t.A)((0,t.A)({},e),{},{[s.id]:0}),{})}),he(!0)},children:(0,$.jsx)(f.A,{className:"w-4 h-4"})})})]},s.id)})})]})})]})}),(0,$.jsx)(m.av,{value:"collection",className:"mt-4",children:(0,$.jsxs)(u.Zp,{children:[(0,$.jsx)(u.aR,{children:(0,$.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[(0,$.jsxs)("div",{children:[(0,$.jsx)(u.ZB,{children:"".concat(e("total_fee")," (").concat(M,")")}),(0,$.jsx)(u.BT,{children:e("collect_fee")})]}),(0,$.jsxs)("div",{className:"flex gap-2",children:[(0,$.jsxs)("select",{value:de,onChange:e=>re(e.target.value),className:"px-3 py-2 border rounded-lg text-sm",children:[(0,$.jsx)("option",{value:"",children:e("select_class")}),Y.map(e=>(0,$.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,$.jsxs)("div",{className:"relative",children:[(0,$.jsx)(q.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,$.jsx)(r.p,{placeholder:e("search"),value:oe,onChange:e=>me(e.target.value),className:"pl-9 w-60"})]})]})]})}),(0,$.jsx)(u.Wu,{children:ce?(0,$.jsx)("div",{className:"flex justify-center py-10",children:(0,$.jsx)(j.A,{className:"w-8 h-8 animate-spin text-emerald-600"})}):(0,$.jsxs)("div",{className:"space-y-2",children:[Q.map(s=>{var a;const t=(e=>{const s=ae.filter(s=>s.student_id===e),a=ne.filter(s=>s.student_id===e);return{totalPaid:s.reduce((e,s)=>e+(s.amount||0),0),totalOldDue:a.reduce((e,s)=>e+(s.amount||0),0),collections:s,dues:a}})(s.id),n=Qe(s.class_id),l=Me(n),c=l-t.totalPaid+t.totalOldDue,i=be===s.id;return(0,$.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,$.jsxs)("div",{className:"flex items-center justify-between p-4 hover:bg-slate-50 cursor-pointer",onClick:()=>_e(i?null:s.id),children:[(0,$.jsxs)("div",{className:"flex items-center gap-4",children:[(0,$.jsx)("button",{className:"text-slate-400",children:i?(0,$.jsx)(b.A,{className:"w-5 h-5"}):(0,$.jsx)(_.A,{className:"w-5 h-5"})}),(0,$.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold",children:null===(a=s.name)||void 0===a?void 0:a.charAt(0)}),(0,$.jsxs)("div",{children:[(0,$.jsx)("p",{className:"font-medium",children:s.name}),(0,$.jsxs)("p",{className:"text-sm text-slate-500",children:[s.student_id," \u2022 ",s.class_name]})]})]}),(0,$.jsxs)("div",{className:"flex items-center gap-6",children:[(0,$.jsxs)("div",{className:"text-right",children:[(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("total_fee")}),(0,$.jsxs)("p",{className:"font-semibold",children:["\u20b9",l.toLocaleString("en-IN")]})]}),(0,$.jsxs)("div",{className:"text-right",children:[(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("paid")}),(0,$.jsxs)("p",{className:"font-semibold text-emerald-600",children:["\u20b9",t.totalPaid.toLocaleString("en-IN")]})]}),t.totalOldDue>0&&(0,$.jsxs)("div",{className:"text-right",children:[(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("pending")}),(0,$.jsxs)("p",{className:"font-semibold text-orange-600",children:["\u20b9",t.totalOldDue.toLocaleString("en-IN")]})]}),(0,$.jsxs)("div",{className:"text-right",children:[(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("pending")}),(0,$.jsxs)("p",{className:"font-semibold ".concat(c>0?"text-red-600":"text-emerald-600"),children:["\u20b9",c.toLocaleString("en-IN")]})]}),(0,$.jsx)(d.$,{size:"sm",onClick:e=>{e.stopPropagation(),Ge(s)},className:"bg-emerald-600 hover:bg-emerald-700",children:e("collect_fee")})]})]}),i&&(0,$.jsx)("div",{className:"border-t bg-slate-50 p-4",children:(0,$.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,$.jsxs)("div",{children:[(0,$.jsxs)("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[(0,$.jsx)(C.A,{className:"w-4 h-4"}),e("fee_type")]}),n?(0,$.jsx)("div",{className:"space-y-2",children:O.filter(e=>{var s;return(Number(null===(s=n.fees)||void 0===s?void 0:s[e.id])||0)>0}).map(e=>{const s=Number(n.fees[e.id])||0;let a="\u20b9".concat(s.toLocaleString("en-IN"));return Ue(e.id,n)&&(a="\u20b9".concat(s.toLocaleString("en-IN"),"/month")),(0,$.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,$.jsx)("span",{children:e.name}),(0,$.jsx)("span",{children:a})]},e.id)})}):(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("fee_structure")})]}),(0,$.jsxs)("div",{children:[(0,$.jsxs)("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[(0,$.jsx)(L.A,{className:"w-4 h-4"}),e("payment_date")]}),t.collections.length>0?(0,$.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.collections.slice(0,5).map(e=>{var s;return(0,$.jsxs)("div",{className:"flex justify-between items-center text-sm bg-white p-2 rounded",children:[(0,$.jsxs)("div",{children:[(0,$.jsxs)("p",{className:"font-medium",children:["\u20b9",null===(s=e.amount)||void 0===s?void 0:s.toLocaleString("en-IN")]}),(0,$.jsx)("p",{className:"text-xs text-slate-500",children:new Date(e.payment_date).toLocaleDateString("en-IN")})]}),(0,$.jsx)(d.$,{size:"sm",variant:"ghost",onClick:()=>(e=>{var s,a;const t=window.open("","_blank"),n=Q.find(s=>s.id===e.student_id);t.document.write("\n      <html>\n      <head>\n        <title>Fee Receipt - ".concat(e.receipt_no,'</title>\n        <style>\n          body { font-family: Arial; padding: 20px; max-width: 400px; margin: auto; }\n          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; }\n          .receipt-no { font-size: 18px; font-weight: bold; }\n          .details { margin: 15px 0; }\n          .row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dotted #ccc; }\n          .amount { font-size: 24px; font-weight: bold; text-align: center; margin: 20px 0; }\n          .footer { text-align: center; font-size: 12px; margin-top: 20px; }\n        </style>\n      </head>\n      <body>\n        <div class="header">\n          <h2>FEE RECEIPT</h2>\n          <div class="receipt-no">').concat(e.receipt_no,'</div>\n        </div>\n        <div class="details">\n          <div class="row"><span>Student Name:</span><span>').concat((null===n||void 0===n?void 0:n.name)||"N/A",'</span></div>\n          <div class="row"><span>Student ID:</span><span>').concat((null===n||void 0===n?void 0:n.student_id)||"N/A",'</span></div>\n          <div class="row"><span>Class:</span><span>').concat((null===n||void 0===n?void 0:n.class_name)||"N/A",'</span></div>\n          <div class="row"><span>Date:</span><span>').concat(new Date(e.payment_date).toLocaleDateString("en-IN"),'</span></div>\n          <div class="row"><span>Payment Mode:</span><span>').concat(null===(s=e.payment_mode)||void 0===s?void 0:s.toUpperCase(),'</span></div>\n        </div>\n        <div class="amount">\u20b9 ').concat(null===(a=e.amount)||void 0===a?void 0:a.toLocaleString("en-IN"),'</div>\n        <div class="footer">\n          <p>Thank you for your payment</p>\n          <p>This is a computer generated receipt</p>\n        </div>\n        <script>window.onload = () => window.print();<\/script>\n      </body>\n      </html>\n    ')),t.document.close()})(e),children:(0,$.jsx)(F.A,{className:"w-4 h-4"})})]},e.id)})}):(0,$.jsx)("p",{className:"text-sm text-slate-500",children:e("paid")})]})]})})]},s.id)}),0===Q.length&&(0,$.jsxs)("div",{className:"text-center py-10 text-slate-500",children:[(0,$.jsx)(B.A,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,$.jsx)("p",{children:e("student")})]})]})})]})}),(0,$.jsx)(m.av,{value:"scholarships",className:"mt-4",children:(0,$.jsxs)("div",{className:"grid gap-4",children:[(0,$.jsx)(u.Zp,{children:(0,$.jsxs)(u.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,$.jsxs)("div",{children:[(0,$.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,$.jsx)(k.A,{className:"w-5 h-5 text-emerald-600"}),e("discount")]}),(0,$.jsx)(u.BT,{children:e("discount")})]}),(0,$.jsxs)("div",{className:"flex gap-2",children:[(0,$.jsxs)(d.$,{onClick:()=>Ze(!0),variant:"outline",className:"gap-2",children:[(0,$.jsx)(B.A,{className:"w-4 h-4"}),e("student")]}),(0,$.jsxs)(d.$,{onClick:()=>De(!0),className:"gap-2 bg-emerald-600 hover:bg-emerald-700",children:[(0,$.jsx)(R.A,{className:"w-4 h-4"}),e("discount")]})]})]})}),(0,$.jsx)("div",{className:"grid md:grid-cols-3 gap-4",children:Be.length>0?Be.map(s=>(0,$.jsxs)(u.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,$.jsxs)(u.aR,{className:"pb-2",children:[(0,$.jsxs)("div",{className:"flex items-center justify-between",children:[(0,$.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat("central_govt"===s.type?"bg-blue-100 text-blue-700":"state_govt"===s.type?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"),children:"central_govt"===s.type?e("category"):"state_govt"===s.type?e("state"):e("other")}),(0,$.jsxs)("span",{className:"text-emerald-600 font-bold",children:["\u20b9",(s.amount||0).toLocaleString()]})]}),(0,$.jsx)(u.ZB,{className:"text-base mt-2",children:s.name}),s.name_hi&&(0,$.jsx)("p",{className:"text-sm text-slate-500",children:s.name_hi})]}),(0,$.jsxs)(u.Wu,{className:"pt-0",children:[s.eligibility&&(0,$.jsxs)("p",{className:"text-xs text-slate-600 mb-2",children:[(0,$.jsxs)("strong",{children:[e("required"),":"]})," ",s.eligibility]}),s.documents_required&&(0,$.jsxs)("p",{className:"text-xs text-slate-500",children:[(0,$.jsxs)("strong",{children:[e("documents"),":"]})," ",s.documents_required]}),(0,$.jsxs)("div",{className:"mt-3 pt-2 border-t flex justify-between items-center",children:[(0,$.jsx)("span",{className:"text-xs text-slate-400",children:s.academic_year}),(0,$.jsx)(d.$,{size:"sm",variant:"outline",onClick:()=>{Xe((0,t.A)((0,t.A)({},Ee),{},{scholarship_id:s.id,amount:s.amount})),Ze(!0)},children:e("save")})]})]})]},s.id)):(0,$.jsxs)("div",{className:"col-span-3 text-center py-12 text-slate-400",children:[(0,$.jsx)(k.A,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,$.jsx)("p",{children:e("discount")})]})}),(0,$.jsxs)(u.Zp,{children:[(0,$.jsx)(u.aR,{children:(0,$.jsxs)(u.ZB,{className:"text-base flex items-center gap-2",children:[(0,$.jsx)(B.A,{className:"w-4 h-4"}),"".concat(e("student")," (").concat(Te.length,")")]})}),(0,$.jsx)(u.Wu,{children:Te.length>0?(0,$.jsxs)(h.XI,{children:[(0,$.jsx)(h.A0,{children:(0,$.jsxs)(h.Hj,{children:[(0,$.jsx)(h.nd,{children:e("student")}),(0,$.jsx)(h.nd,{children:e("discount")}),(0,$.jsx)(h.nd,{children:e("amount")}),(0,$.jsx)(h.nd,{children:e("status")}),(0,$.jsx)(h.nd,{children:e("remarks")})]})}),(0,$.jsx)(h.BF,{children:Te.map((s,a)=>{const t=Q.find(e=>e.id===s.student_id);return(0,$.jsxs)(h.Hj,{children:[(0,$.jsx)(h.nA,{children:(0,$.jsxs)("div",{children:[(0,$.jsx)("p",{className:"font-medium",children:(null===t||void 0===t?void 0:t.name)||s.student_id}),(0,$.jsx)("p",{className:"text-xs text-slate-500",children:null===t||void 0===t?void 0:t.class_name})]})}),(0,$.jsx)(h.nA,{children:Ve(s.scholarship_id)}),(0,$.jsxs)(h.nA,{className:"font-medium text-emerald-600",children:["\u20b9",(s.amount||0).toLocaleString()]}),(0,$.jsx)(h.nA,{children:(0,$.jsx)("span",{className:"px-2 py-0.5 rounded text-xs ".concat("received"===s.status?"bg-green-100 text-green-700":"approved"===s.status?"bg-blue-100 text-blue-700":"rejected"===s.status?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:"received"===s.status?e("completed"):"approved"===s.status?e("approved"):"rejected"===s.status?e("rejected"):e("pending")})}),(0,$.jsx)(h.nA,{className:"text-sm text-slate-500",children:s.remarks||"-"})]},a)})})]}):(0,$.jsxs)("div",{className:"text-center py-8 text-slate-400",children:[(0,$.jsx)(B.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,$.jsx)("p",{children:e("discount")})]})})]})]})}),(0,$.jsx)(m.av,{value:"old_dues",className:"mt-4",children:(0,$.jsxs)(u.Zp,{children:[(0,$.jsxs)(u.aR,{className:"flex flex-row items-center justify-between",children:[(0,$.jsxs)("div",{children:[(0,$.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,$.jsx)(S.A,{className:"w-5 h-5 text-orange-600"}),e("pending")]}),(0,$.jsx)(u.BT,{children:e("pending")})]}),(0,$.jsxs)(d.$,{onClick:()=>fe(!0),className:"gap-2 bg-orange-600 hover:bg-orange-700",children:[(0,$.jsx)(R.A,{className:"w-4 h-4"}),e("pending")]})]}),(0,$.jsx)(u.Wu,{children:ne.length>0?(0,$.jsxs)(h.XI,{children:[(0,$.jsx)(h.A0,{children:(0,$.jsxs)(h.Hj,{children:[(0,$.jsx)(h.nd,{children:e("student")}),(0,$.jsx)(h.nd,{children:e("date")}),(0,$.jsx)(h.nd,{children:e("select_class")}),(0,$.jsx)(h.nd,{children:e("amount")}),(0,$.jsx)(h.nd,{children:e("description")}),(0,$.jsx)(h.nd,{children:e("status")}),(0,$.jsx)(h.nd,{children:e("actions")})]})}),(0,$.jsx)(h.BF,{children:ne.map(s=>{var a;const t=Q.find(e=>e.id===s.student_id);return(0,$.jsxs)(h.Hj,{children:[(0,$.jsx)(h.nA,{children:(0,$.jsxs)("div",{children:[(0,$.jsx)("p",{className:"font-medium",children:(null===t||void 0===t?void 0:t.name)||s.student_name}),(0,$.jsx)("p",{className:"text-xs text-slate-500",children:null===t||void 0===t?void 0:t.student_id})]})}),(0,$.jsx)(h.nA,{children:s.academic_year}),(0,$.jsx)(h.nA,{children:s.class_name}),(0,$.jsxs)(h.nA,{className:"font-semibold text-orange-600",children:["\u20b9",null===(a=s.amount)||void 0===a?void 0:a.toLocaleString("en-IN")]}),(0,$.jsx)(h.nA,{className:"text-sm",children:s.description}),(0,$.jsx)(h.nA,{children:(0,$.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("paid"===s.status?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"),children:"paid"===s.status?e("paid"):e("pending")})}),(0,$.jsx)(h.nA,{children:(0,$.jsx)(d.$,{size:"sm",onClick:()=>{t&&Ge(t)},className:"bg-emerald-600 hover:bg-emerald-700",children:e("collect_fee")})})]},s.id)})})]}):(0,$.jsxs)("div",{className:"text-center py-10 text-slate-500",children:[(0,$.jsx)(y.A,{className:"w-12 h-12 mx-auto mb-2 text-emerald-500"}),(0,$.jsx)("p",{children:e("pending")})]})})]})}),(0,$.jsx)(m.av,{value:"reports",className:"mt-4",children:(0,$.jsxs)(u.Zp,{children:[(0,$.jsxs)(u.aR,{children:[(0,$.jsx)(u.ZB,{children:"".concat(e("fee_reports")," (").concat(M,")")}),(0,$.jsx)(u.BT,{children:e("class_wise")})]}),(0,$.jsx)(u.Wu,{children:(0,$.jsxs)(h.XI,{children:[(0,$.jsx)(h.A0,{children:(0,$.jsxs)(h.Hj,{children:[(0,$.jsx)(h.nd,{children:e("select_class")}),(0,$.jsx)(h.nd,{children:e("student")}),(0,$.jsx)(h.nd,{children:e("total_fee")}),(0,$.jsx)(h.nd,{children:e("total")}),(0,$.jsx)(h.nd,{children:e("total_collected")}),(0,$.jsx)(h.nd,{children:e("pending")}),(0,$.jsx)(h.nd,{children:"%"})]})}),(0,$.jsx)(h.BF,{children:Y.map(e=>{const s=Qe(e.id),a=Q.filter(s=>s.class_id===e.id),n=Me(s),l=ae.filter(e=>a.some(s=>s.id===e.student_id)).reduce((e,s)=>e+(s.amount||0),0);return(0,t.A)((0,t.A)({},e),{},{totalFee:n,totalCollected:l,studentCount:a.length,expectedTotal:n*a.length,pendingTotal:n*a.length-l})}).map(e=>(0,$.jsxs)(h.Hj,{children:[(0,$.jsx)(h.nA,{className:"font-medium",children:e.name}),(0,$.jsx)(h.nA,{children:e.studentCount}),(0,$.jsxs)(h.nA,{children:["\u20b9",e.totalFee.toLocaleString("en-IN")]}),(0,$.jsxs)(h.nA,{children:["\u20b9",e.expectedTotal.toLocaleString("en-IN")]}),(0,$.jsxs)(h.nA,{className:"text-emerald-600 font-semibold",children:["\u20b9",e.totalCollected.toLocaleString("en-IN")]}),(0,$.jsxs)(h.nA,{className:"text-red-600 font-semibold",children:["\u20b9",e.pendingTotal.toLocaleString("en-IN")]}),(0,$.jsx)(h.nA,{children:(0,$.jsxs)("div",{className:"flex items-center gap-2",children:[(0,$.jsx)("div",{className:"w-20 h-2 bg-slate-200 rounded-full overflow-hidden",children:(0,$.jsx)("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:"".concat(e.expectedTotal?e.totalCollected/e.expectedTotal*100:0,"%")}})}),(0,$.jsxs)("span",{className:"text-sm",children:[e.expectedTotal?Math.round(e.totalCollected/e.expectedTotal*100):0,"%"]})]})})]},e.id))})]})})]})})]}),(0,$.jsx)(x.lG,{open:xe,onOpenChange:he,children:(0,$.jsxs)(x.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,$.jsxs)(x.c7,{children:[(0,$.jsx)(x.L3,{children:e("fee_structure")}),(0,$.jsx)(x.rr,{children:e("fee_type")})]}),(0,$.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,$.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("select_class")," *"]}),(0,$.jsxs)("select",{value:Ae.class_id,onChange:e=>we(s=>(0,t.A)((0,t.A)({},s),{},{class_id:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,$.jsx)("option",{value:"",children:e("select_class")}),Y.map(e=>(0,$.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("date")}),(0,$.jsx)("select",{value:Ae.academic_year,onChange:e=>we(s=>(0,t.A)((0,t.A)({},s),{},{academic_year:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:E().map(e=>(0,$.jsx)("option",{value:e,children:e},e))})]})]}),(0,$.jsxs)("div",{className:"border rounded-lg p-4 bg-blue-50",children:[(0,$.jsx)(o.J,{className:"text-sm font-medium",children:e("fee_type")}),(0,$.jsxs)("div",{className:"flex gap-4 mt-2",children:[(0,$.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,$.jsx)("input",{type:"radio",name:"tuition_frequency",value:"monthly",checked:"monthly"===Ae.tuition_frequency,onChange:()=>we(e=>(0,t.A)((0,t.A)({},e),{},{tuition_frequency:"monthly"})),className:"w-4 h-4"}),(0,$.jsx)("span",{className:"text-sm",children:e("monthly_fee")})]}),(0,$.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,$.jsx)("input",{type:"radio",name:"tuition_frequency",value:"yearly",checked:"yearly"===Ae.tuition_frequency,onChange:()=>we(e=>(0,t.A)((0,t.A)({},e),{},{tuition_frequency:"yearly"})),className:"w-4 h-4"}),(0,$.jsx)("span",{className:"text-sm",children:e("annual_fee")})]})]})]}),(0,$.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,$.jsx)("h4",{className:"font-medium mb-4",children:e("fee_type")}),(0,$.jsx)("div",{className:"grid grid-cols-2 gap-4",children:O.map(s=>(0,$.jsxs)("div",{className:"space-y-1",children:[(0,$.jsxs)(o.J,{className:"text-sm",children:["".concat(s.name," (").concat(s.name_hi,")"),H.includes(s.id)&&(0,$.jsx)("span",{className:"text-xs text-slate-400 ml-1",children:"tuition_fee"===s.id&&"yearly"===Ae.tuition_frequency?"(".concat(e("annual_fee"),")"):"(".concat(e("monthly_fee"),")")})]}),(0,$.jsxs)("div",{className:"flex items-center gap-2",children:[(0,$.jsx)("span",{className:"text-slate-500",children:"\u20b9"}),(0,$.jsx)(r.p,{type:"number",value:Ae.fees[s.id]||"",onChange:e=>we(a=>(0,t.A)((0,t.A)({},a),{},{fees:(0,t.A)((0,t.A)({},a.fees),{},{[s.id]:parseInt(e.target.value)||0})})),placeholder:"0"})]})]},s.id))})]}),(0,$.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,$.jsx)(d.$,{variant:"outline",onClick:()=>he(!1),children:e("cancel")}),(0,$.jsxs)(d.$,{onClick:async()=>{if(Ae.class_id){ye(!0);try{const e=localStorage.getItem("token");await z.A.post("".concat(D,"/fee-structures"),(0,t.A)((0,t.A)({},Ae),{},{school_id:s}),{headers:{Authorization:"Bearer ".concat(e)}}),T.oR.success("Fee structure saved!"),he(!1),We()}catch(n){var e,a;T.oR.error((null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||(X?"\u0938\u0947\u0935 \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to save"))}finally{ye(!1)}}else T.oR.error(X?"\u0915\u0943\u092a\u092f\u093e class select \u0915\u0930\u0947\u0902":"Please select a class")},disabled:Ne,className:"bg-emerald-600 hover:bg-emerald-700",children:[Ne?(0,$.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):null,e("save")]})]})]})]})}),(0,$.jsx)(x.lG,{open:ue,onOpenChange:e=>{e||(ve(null),Ie({}),Fe({})),pe(e)},children:(0,$.jsxs)(x.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,$.jsxs)(x.c7,{children:[(0,$.jsx)(x.L3,{children:e("collect_fee")}),(0,$.jsx)(x.rr,{children:ge?"".concat(ge.name," - ").concat(ge.class_name):e("student")})]}),(0,$.jsxs)("div",{className:"space-y-4 mt-4",children:[!ge&&(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("student")," *"]}),(0,$.jsxs)("select",{value:Ce.student_id,onChange:e=>{const s=Q.find(s=>s.id===e.target.value);s&&Ge(s)},className:"w-full px-3 py-2 border rounded-lg",children:[(0,$.jsx)("option",{value:"",children:e("student")}),Q.map(e=>(0,$.jsxs)("option",{value:e.id,children:[e.name," (",e.student_id,")"]},e.id))]})]}),ge&&Object.keys(Se).length>0&&(0,$.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,$.jsx)("h4",{className:"font-medium mb-3",children:e("fee_type")}),(0,$.jsx)("div",{className:"space-y-3",children:Object.entries(Se).map(s=>{let[a,n]=s;const l=O.find(e=>e.id===a);if(!l)return null;const c=void 0!==Re[a];return(0,$.jsxs)("div",{className:"border rounded p-3 bg-slate-50",children:[(0,$.jsxs)("div",{className:"flex items-center gap-3",children:[(0,$.jsx)("input",{type:"checkbox",checked:n.selected,onChange:e=>{Ie(s=>(0,t.A)((0,t.A)({},s),{},{[a]:(0,t.A)((0,t.A)({},s[a]),{},{selected:e.target.checked})}))},className:"w-4 h-4"}),(0,$.jsx)("div",{className:"flex-1",children:(0,$.jsx)("span",{className:"text-sm font-medium",children:"".concat(l.name," (").concat(l.name_hi,")")})}),(0,$.jsxs)("div",{className:"flex items-center gap-1",children:[(0,$.jsx)("span",{className:"text-sm text-slate-500",children:"\u20b9"}),(0,$.jsx)(r.p,{type:"number",value:n.amount,onChange:e=>{Ie(s=>(0,t.A)((0,t.A)({},s),{},{[a]:(0,t.A)((0,t.A)({},s[a]),{},{amount:parseInt(e.target.value)||0})}))},className:"w-24 h-8 text-sm"}),c&&(0,$.jsxs)("span",{className:"text-xs text-slate-400",children:["/",e("monthly_fee")]})]})]}),c&&n.selected&&(0,$.jsxs)("div",{className:"mt-2 ml-7",children:[(0,$.jsxs)("p",{className:"text-xs text-slate-500 mb-1",children:[e("monthly_fee"),":"]}),(0,$.jsx)("div",{className:"flex flex-wrap gap-1",children:Z.map(e=>{const s=(Re[a]||[]).includes(e);return(0,$.jsx)("button",{type:"button",onClick:()=>{Fe(n=>{const l=n[a]||[],c=s?l.filter(s=>s!==e):[...l,e];return(0,t.A)((0,t.A)({},n),{},{[a]:c})})},className:"px-2 py-1 text-xs rounded border ".concat(s?"bg-emerald-100 border-emerald-400 text-emerald-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-100"),children:e},e)})})]})]},a)})})]}),ge&&0===Object.keys(Se).length&&(0,$.jsxs)("div",{className:"text-center py-6 text-slate-500 border rounded-lg",children:[(0,$.jsx)(p.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,$.jsx)("p",{className:"text-sm",children:e("fee_structure")})]}),es.length>0&&(0,$.jsxs)("div",{className:"border rounded-lg p-4 bg-emerald-50",children:[(0,$.jsx)("h4",{className:"font-medium mb-2 text-emerald-800",children:e("description")}),(0,$.jsxs)("div",{className:"space-y-1",children:[es.map((e,s)=>{const a=O.find(s=>s.id===e.fee_type);return(0,$.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,$.jsxs)("span",{children:[(null===a||void 0===a?void 0:a.name)||e.fee_type,e.months&&e.months.length>0&&(0,$.jsxs)("span",{className:"text-xs text-slate-500 ml-1",children:["(",e.months.length," months: ",e.months.join(", "),")"]})]}),(0,$.jsxs)("span",{className:"font-medium",children:["\u20b9",(e.months?e.amount*e.months.length:e.amount).toLocaleString("en-IN")]})]},s)}),(0,$.jsxs)("div",{className:"border-t pt-2 mt-2 flex justify-between font-bold text-emerald-700",children:[(0,$.jsx)("span",{children:e("total")}),(0,$.jsxs)("span",{children:["\u20b9",Ke.toLocaleString("en-IN")]})]})]})]}),(0,$.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("payment_mode")}),(0,$.jsxs)("select",{value:Ce.payment_mode,onChange:e=>ke(s=>(0,t.A)((0,t.A)({},s),{},{payment_mode:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,$.jsx)("option",{value:"cash",children:e("cash")}),(0,$.jsx)("option",{value:"upi",children:e("upi")}),(0,$.jsx)("option",{value:"card",children:e("online")}),(0,$.jsx)("option",{value:"bank_transfer",children:e("bank_transfer")}),(0,$.jsx)("option",{value:"cheque",children:e("cheque")})]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("date")}),(0,$.jsx)(r.p,{type:"date",value:Ce.payment_date,onChange:e=>ke(s=>(0,t.A)((0,t.A)({},s),{},{payment_date:e.target.value}))})]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("remarks")}),(0,$.jsx)(r.p,{value:Ce.remarks,onChange:e=>ke(s=>(0,t.A)((0,t.A)({},s),{},{remarks:e.target.value})),placeholder:e("remarks")})]}),(0,$.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,$.jsx)(d.$,{variant:"outline",onClick:()=>{pe(!1),ve(null),Ie({}),Fe({})},children:e("cancel")}),(0,$.jsxs)(d.$,{onClick:async()=>{const{total:e,items:n}=Ye();if(!Ce.student_id||e<=0)T.oR.error(X?"\u0915\u0943\u092a\u092f\u093e student \u0914\u0930 fee items select \u0915\u0930\u0947\u0902":"Please select student and fee items");else{ye(!0);try{const l=localStorage.getItem("token"),c=await z.A.post("".concat(D,"/fee-collections"),(0,t.A)((0,t.A)({},Ce),{},{amount:e,fee_items:n,academic_year:M,school_id:s,collected_by:null===a||void 0===a?void 0:a.id}),{headers:{Authorization:"Bearer ".concat(l)}});T.oR.success("Fee collected! Receipt No: ".concat(c.data.receipt_no)),pe(!1),ve(null),Ie({}),Fe({}),ke({student_id:"",amount:0,fee_types:[],months:[],fee_items:[],payment_mode:"cash",payment_date:(new Date).toISOString().split("T")[0],receipt_no:"",remarks:"",academic_year:M}),We()}catch(i){var l,c;T.oR.error((null===(l=i.response)||void 0===l||null===(c=l.data)||void 0===c?void 0:c.detail)||(X?"\u092b\u0940\u0938 \u091c\u092e\u093e \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to collect fee"))}finally{ye(!1)}}},disabled:Ne||Ke<=0,className:"bg-emerald-600 hover:bg-emerald-700",children:[Ne?(0,$.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,$.jsx)(y.A,{className:"w-4 h-4 mr-2"}),e("collect_fee")," \u20b9",Ke.toLocaleString("en-IN")]})]})]})]})}),(0,$.jsx)(x.lG,{open:je,onOpenChange:fe,children:(0,$.jsxs)(x.Cf,{className:"max-w-md",children:[(0,$.jsxs)(x.c7,{children:[(0,$.jsxs)(x.L3,{className:"flex items-center gap-2",children:[(0,$.jsx)(S.A,{className:"w-5 h-5 text-orange-600"}),e("pending")]}),(0,$.jsx)(x.rr,{children:e("pending")})]}),(0,$.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("student")," *"]}),(0,$.jsxs)("select",{value:Le.student_id,onChange:e=>qe(s=>(0,t.A)((0,t.A)({},s),{},{student_id:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,$.jsx)("option",{value:"",children:e("student")}),Q.map(e=>(0,$.jsxs)("option",{value:e.id,children:[e.name," (",e.student_id,")"]},e.id))]})]}),(0,$.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("date")," *"]}),(0,$.jsxs)("select",{value:Le.academic_year,onChange:e=>qe(s=>(0,t.A)((0,t.A)({},s),{},{academic_year:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,$.jsx)("option",{value:"",children:e("date")}),Array.from({length:5},(e,s)=>{const a=(new Date).getFullYear()-s-1;return(0,$.jsxs)("option",{value:"".concat(a,"-").concat(a+1),children:[a,"-",a+1]},a)})]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("select_class")}),(0,$.jsx)(r.p,{value:Le.class_name,onChange:e=>qe(s=>(0,t.A)((0,t.A)({},s),{},{class_name:e.target.value})),placeholder:"e.g., Class 5"})]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("amount")," *"]}),(0,$.jsxs)("div",{className:"flex items-center gap-2",children:[(0,$.jsx)("span",{className:"text-xl font-bold",children:"\u20b9"}),(0,$.jsx)(r.p,{type:"number",value:Le.amount,onChange:e=>qe(s=>(0,t.A)((0,t.A)({},s),{},{amount:parseInt(e.target.value)||0})),className:"text-xl font-bold",placeholder:"0"})]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("description")}),(0,$.jsx)(r.p,{value:Le.description,onChange:e=>qe(s=>(0,t.A)((0,t.A)({},s),{},{description:e.target.value})),placeholder:e("description")})]}),(0,$.jsxs)("div",{className:"flex items-center gap-2",children:[(0,$.jsx)("input",{type:"checkbox",id:"sendNotification",checked:Le.send_notification,onChange:e=>qe(s=>(0,t.A)((0,t.A)({},s),{},{send_notification:e.target.checked})),className:"w-4 h-4"}),(0,$.jsxs)(o.J,{htmlFor:"sendNotification",className:"flex items-center gap-2 cursor-pointer",children:[(0,$.jsx)(g.A,{className:"w-4 h-4"}),e("send")," ",e("notifications")]})]}),(0,$.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,$.jsx)(d.$,{variant:"outline",onClick:()=>fe(!1),children:e("cancel")}),(0,$.jsxs)(d.$,{onClick:async()=>{if(!Le.student_id||Le.amount<=0)T.oR.error(X?"\u0915\u0943\u092a\u092f\u093e student \u0914\u0930 amount \u092d\u0930\u0947\u0902":"Please fill student and amount");else{ye(!0);try{const e=localStorage.getItem("token");await z.A.post("".concat(D,"/old-dues"),(0,t.A)((0,t.A)({},Le),{},{school_id:s,added_by:null===a||void 0===a?void 0:a.id}),{headers:{Authorization:"Bearer ".concat(e)}}),T.oR.success("Old due added successfully!"),fe(!1),qe({student_id:"",academic_year:"",class_name:"",amount:0,description:"",send_notification:!0}),We()}catch(l){var e,n;T.oR.error((null===(e=l.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||(X?"\u092a\u0941\u0930\u093e\u0928\u0940 \u092c\u0915\u093e\u092f\u093e \u091c\u094b\u0921\u093c\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to add old due"))}finally{ye(!1)}}},disabled:Ne,className:"bg-orange-600 hover:bg-orange-700",children:[Ne?(0,$.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,$.jsx)(R.A,{className:"w-4 h-4 mr-2"}),e("save")]})]})]})]})}),(0,$.jsx)(x.lG,{open:$e,onOpenChange:De,children:(0,$.jsxs)(x.Cf,{className:"max-w-lg",children:[(0,$.jsxs)(x.c7,{children:[(0,$.jsxs)(x.L3,{className:"flex items-center gap-2",children:[(0,$.jsx)(k.A,{className:"w-5 h-5 text-emerald-600"}),e("discount")]}),(0,$.jsx)(x.rr,{children:e("discount")})]}),(0,$.jsxs)("div",{className:"space-y-4",children:[(0,$.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("name")," *"]}),(0,$.jsx)(r.p,{value:He.name,onChange:e=>Pe(s=>(0,t.A)((0,t.A)({},s),{},{name:e.target.value})),placeholder:"e.g., Pre Matric Scholarship"})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("name")," (Hindi)"]}),(0,$.jsx)(r.p,{value:He.name_hi,onChange:e=>Pe(s=>(0,t.A)((0,t.A)({},s),{},{name_hi:e.target.value})),placeholder:"e.g., \u092a\u094d\u0930\u0940-\u092e\u0948\u091f\u094d\u0930\u093f\u0915 \u091b\u093e\u0924\u094d\u0930\u0935\u0943\u0924\u094d\u0924\u093f"})]})]}),(0,$.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("type")," *"]}),(0,$.jsxs)("select",{value:He.type,onChange:e=>Pe(s=>(0,t.A)((0,t.A)({},s),{},{type:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,$.jsx)("option",{value:"central_govt",children:e("category")}),(0,$.jsx)("option",{value:"state_govt",children:e("state")}),(0,$.jsx)("option",{value:"private",children:e("other")})]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("date")}),(0,$.jsx)("select",{value:He.academic_year,onChange:e=>Pe(s=>(0,t.A)((0,t.A)({},s),{},{academic_year:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:E().map(e=>(0,$.jsx)("option",{value:e,children:e},e))})]})]}),(0,$.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("amount")," (\u20b9) *"]}),(0,$.jsx)(r.p,{type:"number",value:He.amount,onChange:e=>Pe(s=>(0,t.A)((0,t.A)({},s),{},{amount:parseInt(e.target.value)||0})),placeholder:"0"})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("percentage")}),(0,$.jsx)(r.p,{type:"number",value:He.percentage,onChange:e=>Pe(s=>(0,t.A)((0,t.A)({},s),{},{percentage:parseInt(e.target.value)||0})),placeholder:"0",max:100})]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("required")}),(0,$.jsx)(r.p,{value:He.eligibility,onChange:e=>Pe(s=>(0,t.A)((0,t.A)({},s),{},{eligibility:e.target.value})),placeholder:"e.g., BPL Family, Income < 2.5 Lakh, SC/ST/OBC"})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("documents")}),(0,$.jsx)(r.p,{value:He.documents_required,onChange:e=>Pe(s=>(0,t.A)((0,t.A)({},s),{},{documents_required:e.target.value})),placeholder:"e.g., Aadhar, Income Certificate, Caste Certificate"})]}),(0,$.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,$.jsx)(d.$,{variant:"outline",onClick:()=>De(!1),children:e("cancel")}),(0,$.jsxs)(d.$,{onClick:async()=>{if(!He.name||He.amount<=0)T.oR.error(X?"\u0915\u0943\u092a\u092f\u093e scheme name \u0914\u0930 amount \u092d\u0930\u0947\u0902":"Please fill scheme name and amount");else{ye(!0);try{const e=localStorage.getItem("token");await z.A.post("".concat(D,"/scholarships"),(0,t.A)((0,t.A)({},He),{},{school_id:s}),{headers:{Authorization:"Bearer ".concat(e)}}),T.oR.success("Scheme saved successfully!"),De(!1),Pe({name:"",name_hi:"",type:"central_govt",amount:0,percentage:0,eligibility:"",documents_required:"",academic_year:P()}),We()}catch(n){var e,a;T.oR.error((null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||(X?"\u092f\u094b\u091c\u0928\u093e \u0938\u0947\u0935 \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to save scheme"))}finally{ye(!1)}}},disabled:Ne,className:"bg-emerald-600 hover:bg-emerald-700",children:[Ne?(0,$.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,$.jsx)(R.A,{className:"w-4 h-4 mr-2"}),e("save")]})]})]})]})}),(0,$.jsx)(x.lG,{open:Oe,onOpenChange:Ze,children:(0,$.jsxs)(x.Cf,{className:"max-w-lg",children:[(0,$.jsxs)(x.c7,{children:[(0,$.jsxs)(x.L3,{className:"flex items-center gap-2",children:[(0,$.jsx)(B.A,{className:"w-5 h-5 text-emerald-600"}),e("discount")]}),(0,$.jsx)(x.rr,{children:e("student")})]}),(0,$.jsxs)("div",{className:"space-y-4",children:[(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("student")," *"]}),(0,$.jsxs)("select",{value:Ee.student_id,onChange:e=>Xe(s=>(0,t.A)((0,t.A)({},s),{},{student_id:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,$.jsxs)("option",{value:"",children:["-- ",e("student")," --"]}),Q.map(e=>(0,$.jsxs)("option",{value:e.id,children:[e.name," (",e.student_id,") - ",e.class_name]},e.id))]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("discount")," *"]}),(0,$.jsxs)("select",{value:Ee.scholarship_id,onChange:e=>{const s=Be.find(s=>s.id===e.target.value);Xe(a=>(0,t.A)((0,t.A)({},a),{},{scholarship_id:e.target.value,amount:(null===s||void 0===s?void 0:s.amount)||0}))},className:"w-full px-3 py-2 border rounded-lg",children:[(0,$.jsxs)("option",{value:"",children:["-- ",e("discount")," --"]}),Be.map(e=>(0,$.jsxs)("option",{value:e.id,children:[e.name," - \u20b9",(e.amount||0).toLocaleString()]},e.id))]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsxs)(o.J,{children:[e("amount")," (\u20b9)"]}),(0,$.jsx)(r.p,{type:"number",value:Ee.amount,onChange:e=>Xe(s=>(0,t.A)((0,t.A)({},s),{},{amount:parseInt(e.target.value)||0}))})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("status")}),(0,$.jsxs)("select",{value:Ee.status,onChange:e=>Xe(s=>(0,t.A)((0,t.A)({},s),{},{status:e.target.value})),className:"w-full px-3 py-2 border rounded-lg",children:[(0,$.jsx)("option",{value:"pending",children:e("pending")}),(0,$.jsx)("option",{value:"approved",children:e("approved")}),(0,$.jsx)("option",{value:"received",children:e("completed")}),(0,$.jsx)("option",{value:"rejected",children:e("rejected")})]})]}),(0,$.jsxs)("div",{className:"space-y-2",children:[(0,$.jsx)(o.J,{children:e("remarks")}),(0,$.jsx)(r.p,{value:Ee.remarks,onChange:e=>Xe(s=>(0,t.A)((0,t.A)({},s),{},{remarks:e.target.value})),placeholder:e("remarks")})]}),(0,$.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,$.jsx)(d.$,{variant:"outline",onClick:()=>Ze(!1),children:e("cancel")}),(0,$.jsxs)(d.$,{onClick:async()=>{if(Ee.student_id&&Ee.scholarship_id){ye(!0);try{const e=localStorage.getItem("token");await z.A.post("".concat(D,"/student-scholarships"),(0,t.A)((0,t.A)({},Ee),{},{school_id:s,assigned_by:null===a||void 0===a?void 0:a.id,assigned_date:(new Date).toISOString()}),{headers:{Authorization:"Bearer ".concat(e)}}),T.oR.success("Scholarship assigned to student!"),Ze(!1),Xe({student_id:"",scholarship_id:"",amount:0,status:"pending",remarks:""}),We()}catch(l){var e,n;T.oR.error((null===(e=l.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||(X?"\u091b\u093e\u0924\u094d\u0930\u0935\u0943\u0924\u094d\u0924\u093f \u0905\u0938\u093e\u0907\u0928 \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e":"Failed to assign scholarship"))}finally{ye(!1)}}else T.oR.error(X?"\u0915\u0943\u092a\u092f\u093e student \u0914\u0930 scheme select \u0915\u0930\u0947\u0902":"Please select student and scheme")},disabled:Ne,className:"bg-emerald-600 hover:bg-emerald-700",children:[Ne?(0,$.jsx)(j.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,$.jsx)(y.A,{className:"w-4 h-4 mr-2"}),e("save")]})]})]})]})})]}):(0,$.jsx)("div",{className:"text-center py-20",children:(0,$.jsxs)("p",{className:"text-slate-500",children:[e("select")," ",e("schools")]})})}}}]);