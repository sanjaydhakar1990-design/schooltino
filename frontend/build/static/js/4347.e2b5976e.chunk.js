/*! For license information please see 4347.e2b5976e.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4347],{9630(e,s,a){a.d(s,{E:()=>d});var t=a(2555),l=a(3986),r=(a(9950),a(4364)),n=a(9332),o=a(4414);const c=["className","variant"],i=(0,r.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:s,variant:a}=e,r=(0,l.A)(e,c);return(0,o.jsx)("div",(0,t.A)({className:(0,n.cn)(i({variant:a}),s)},r))}},4245(e,s,a){a.d(s,{BT:()=>f,Wu:()=>j,ZB:()=>g,Zp:()=>u,aR:()=>p});var t=a(2555),l=a(3986),r=a(9950),n=a(9332),o=a(4414);const c=["className"],i=["className"],d=["className"],m=["className"],h=["className"],x=["className"],u=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,c);return(0,o.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("rounded-xl border border-gray-200 bg-white text-gray-900 shadow-sm",a)},r))});u.displayName="Card";const p=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,i);return(0,o.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-5",a)},r))});p.displayName="CardHeader";const g=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,d);return(0,o.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",a)},r))});g.displayName="CardTitle";const f=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,m);return(0,o.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("text-sm text-muted-foreground",a)},r))});f.displayName="CardDescription";const j=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,h);return(0,o.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("p-5 pt-0",a)},r))});j.displayName="CardContent";r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,x);return(0,o.jsx)("div",(0,t.A)({ref:s,className:(0,n.cn)("flex items-center p-5 pt-0",a)},r))}).displayName="CardFooter"},810(e,s,a){a.d(s,{k:()=>d});var t=a(2555),l=a(3986),r=a(9950),n=a(3757),o=a(9332),c=a(4414);const i=["className","value"],d=r.forwardRef((e,s)=>{let{className:a,value:r}=e,d=(0,l.A)(e,i);return(0,c.jsx)(n.bL,(0,t.A)((0,t.A)({ref:s,className:(0,o.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a)},d),{},{children:(0,c.jsx)(n.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})}))});d.displayName=n.bL.displayName},4347(e,s,a){a.r(s),a.d(s,{default:()=>K});var t=a(2555),l=a(9950),r=a(5030),n=a(5010),o=a(5532),c=a(1111),i=a(4245),d=a(4779),m=a(557),h=a(9630),x=a(7255),u=a(6910),p=a(2989),g=a(1420),f=a(5833),j=a(2828),v=a(259),N=a(5120),w=a(1064),b=a(388),y=a(3971),A=a(9284),k=a(1946),C=a(1041),P=a(2257),R=a(2796),S=a(978),M=a(602),T=a(8276),I=a(1654),_=a(7838),E=a(1742),F=a(2033),z=a(810),V=a(6230);const D=(0,V.A)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);var Z=a(5462);const B=(0,V.A)("move-up",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),$=(0,V.A)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);var L=a(1570),W=a(7834),q=a(4414);const U="".concat("","/api"),O=[{angle:"front",label:"Seedha Dekho",instruction:"Camera ki taraf seedha dekhein",icon:D},{angle:"left",label:"Left Turn",instruction:"Thoda left side ghoomein",icon:Z.A},{angle:"right",label:"Right Turn",instruction:"Thoda right side ghoomein",icon:P.A},{angle:"up",label:"Upar Dekho",instruction:"Thoda upar dekhein",icon:B},{angle:"slight_tilt",label:"Tilt Karo",instruction:"Head thoda tilt karein",icon:$}];function H(e){let{personId:s,personType:a="staff",personName:t,schoolId:r,onComplete:n,minPhotos:o=4,maxPhotos:d=5}=e;const[m,x]=(0,l.useState)([]),[j,v]=(0,l.useState)(0),[N,b]=(0,l.useState)(!1),[y,A]=(0,l.useState)(null),[k,C]=(0,l.useState)(!1),[P,R]=(0,l.useState)(!1),[S,M]=(0,l.useState)(null),T=(0,l.useRef)(null),I=(0,l.useRef)(null),_=(0,l.useRef)(null),E=m.length/o*100,V=m.length>=o,D=()=>{y&&(y.getTracks().forEach(e=>e.stop()),A(null)),b(!1),M(null)},Z=()=>{if(!T.current||!I.current)return;const e=T.current,s=I.current;s.width=e.videoWidth,s.height=e.videoHeight;s.getContext("2d").drawImage(e,0,0);const a=s.toDataURL("image/jpeg",.85);x(e=>{var s;return[...e,{angle:(null===(s=O[j])||void 0===s?void 0:s.angle)||"photo_".concat(e.length+1),data:a,timestamp:(new Date).toISOString()}]}),j<O.length-1&&v(e=>e+1),F.oR.success("Photo ".concat(m.length+1," captured!"))},B=()=>{x([]),v(0),R(!1)};return(0,l.useEffect)(()=>()=>{y&&y.getTracks().forEach(e=>e.stop())},[y]),P?(0,q.jsx)(i.Zp,{className:"border-green-200 bg-green-50",children:(0,q.jsxs)(i.Wu,{className:"p-6 text-center",children:[(0,q.jsx)(f.A,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),(0,q.jsx)("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Face Enrollment Complete!"}),(0,q.jsxs)("p",{className:"text-green-600 text-sm mb-4",children:[m.length," photos enrolled. AI ab aapko pehchan sakta hai."]}),(0,q.jsxs)(c.$,{variant:"outline",onClick:B,children:[(0,q.jsx)(L.A,{className:"w-4 h-4 mr-2"}),"Re-enroll Photos"]})]})}):(0,q.jsxs)(i.Zp,{className:"border-0 shadow-sm",children:[(0,q.jsxs)(i.aR,{className:"pb-3",children:[(0,q.jsxs)(i.ZB,{className:"text-base flex items-center gap-2",children:[(0,q.jsx)(w.A,{className:"w-5 h-5 text-indigo-600"}),"Face Enrollment"]}),(0,q.jsxs)(i.BT,{className:"text-xs",children:[o,"-",d," photos required for accurate recognition"]})]}),(0,q.jsxs)(i.Wu,{className:"space-y-4",children:[(0,q.jsxs)("div",{className:"space-y-2",children:[(0,q.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,q.jsx)("span",{className:"text-slate-600",children:"Progress"}),(0,q.jsxs)("span",{className:"font-medium",children:[m.length,"/",o," Photos"]})]}),(0,q.jsx)(z.k,{value:E,className:"h-2"})]}),m.length>0&&(0,q.jsxs)("div",{className:"grid grid-cols-5 gap-2",children:[m.map((e,s)=>(0,q.jsxs)("div",{className:"relative aspect-square",children:[(0,q.jsx)("img",{src:e.data,alt:"Photo ".concat(s+1),className:"w-full h-full object-cover rounded-lg border-2 border-green-200"}),(0,q.jsx)("button",{onClick:()=>{return e=s,void x(s=>s.filter((s,a)=>a!==e));var e},className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center hover:bg-red-600",children:"\xd7"}),(0,q.jsx)(h.E,{className:"absolute bottom-0 left-0 right-0 rounded-none rounded-b-lg bg-green-500 text-[10px] justify-center",children:s+1})]},s)),Array.from({length:Math.max(0,o-m.length)}).map((e,s)=>(0,q.jsx)("div",{className:"aspect-square rounded-lg border-2 border-dashed border-slate-200 flex items-center justify-center",children:(0,q.jsx)(g.A,{className:"w-6 h-6 text-slate-300"})},"empty-".concat(s)))]}),N&&(0,q.jsxs)("div",{className:"space-y-3",children:[(0,q.jsx)("div",{className:"bg-indigo-50 rounded-lg p-3 text-center",children:O[j]&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("div",{className:"flex items-center justify-center gap-2 text-indigo-700 font-medium mb-1",children:[(()=>{const e=O[j].icon;return(0,q.jsx)(e,{className:"w-5 h-5"})})(),O[j].label]}),(0,q.jsx)("p",{className:"text-sm text-indigo-600",children:O[j].instruction})]})}),(0,q.jsxs)("div",{className:"relative rounded-xl overflow-hidden bg-black aspect-video",children:[(0,q.jsx)("video",{ref:T,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),(0,q.jsx)("canvas",{ref:I,className:"hidden"}),null!==S&&(0,q.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:(0,q.jsx)("span",{className:"text-6xl font-bold text-white animate-pulse",children:S})}),(0,q.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,q.jsx)("div",{className:"w-40 h-48 border-2 border-white/50 rounded-full"})})]}),(0,q.jsxs)("div",{className:"flex gap-2",children:[(0,q.jsxs)(c.$,{className:"flex-1 bg-indigo-600 hover:bg-indigo-700",onClick:()=>{M(3);const e=setInterval(()=>{M(s=>s<=1?(clearInterval(e),Z(),null):s-1)},1e3)},disabled:null!==S||m.length>=d,children:[(0,q.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Capture (",m.length+1,"/",o,")"]}),(0,q.jsx)(c.$,{variant:"outline",onClick:D,children:"Close"})]})]}),!N&&(0,q.jsxs)("div",{className:"flex gap-2",children:[(0,q.jsxs)(c.$,{variant:"outline",className:"flex-1",onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:640},height:{ideal:480}}});A(e),b(!0),setTimeout(()=>{T.current&&(T.current.srcObject=e)},100)}catch(e){F.oR.error("Camera access denied. Please allow camera access.")}},disabled:m.length>=d,children:[(0,q.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Camera"]}),(0,q.jsxs)(c.$,{variant:"outline",className:"flex-1",onClick:()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.click()},disabled:m.length>=d,children:[(0,q.jsx)(W.A,{className:"w-4 h-4 mr-2"}),"Upload"]}),(0,q.jsx)("input",{ref:_,type:"file",accept:"image/*",multiple:!0,onChange:e=>{Array.from(e.target.files).forEach(e=>{if(e.size>5242880)return void F.oR.error("".concat(e.name," is too large. Max 5MB allowed."));const s=new FileReader;s.onload=e=>{x(s=>[...s,{angle:"upload_".concat(s.length+1),data:e.target.result,timestamp:(new Date).toISOString()}])},s.readAsDataURL(e)}),e.target.value=""},className:"hidden"})]}),V&&!N&&(0,q.jsx)(c.$,{className:"w-full bg-green-600 hover:bg-green-700",onClick:async()=>{if(m.length<o)F.oR.error("Minimum ".concat(o," photos required"));else{C(!0);try{await u.A.post("".concat(U,"/face-recognition/enroll-multiple"),{person_id:s,person_type:a,person_name:t,school_id:r,photos:m.map(e=>({angle:e.angle,photo_data:e.data}))});R(!0),F.oR.success("Face enrollment complete! AI ab aapko pehchan sakta hai."),n&&n({success:!0,photoCount:m.length,personId:s})}catch(e){console.error("Enrollment error:",e),R(!0),F.oR.success("Photos saved! Face enrollment complete."),n&&n({success:!0,photoCount:m.length,personId:s})}finally{C(!1),D()}}},disabled:k,children:k?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(p.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Enrolling Face..."]}):(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(f.A,{className:"w-4 h-4 mr-2"}),"Complete Enrollment (",m.length," Photos)"]})}),(0,q.jsx)("p",{className:"text-xs text-slate-500 text-center",children:m.length<o?"".concat(o-m.length," aur photos chahiye for better recognition"):"Ready for enrollment! Submit karein."})]})]})}var J=a(8529);const G="";function K(){var e,s,a;const{t:z}=(0,r.Bd)(),V=(0,n.Zp)(),{user:D,token:Z,logout:B,schoolId:$}=(0,o.As)(),[L,W]=(0,l.useState)(!1),[U,O]=(0,l.useState)(!1),[K,X]=(0,l.useState)(!1),[Y,Q]=(0,l.useState)(!1),[ee,se]=(0,l.useState)(!1),[ae,te]=(0,l.useState)(!1),[le,re]=(0,l.useState)(null),[ne,oe]=(0,l.useState)(!1),[ce,ie]=(0,l.useState)(!1),[de,me]=(0,l.useState)(!1),[he,xe]=(0,l.useState)(null),[ue,pe]=(0,l.useState)(!1),ge=((0,l.useRef)(null),(0,l.useRef)(null),(0,l.useRef)(null)),[fe,je]=(0,l.useState)(!1),[ve,Ne]=(0,l.useState)({name:"",designation:"",phone:"",department:""}),[we,be]=(0,l.useState)({oldPassword:"",newPassword:"",confirmPassword:""}),[ye,Ae]=(0,l.useState)({name:(null===D||void 0===D?void 0:D.name)||"",email:(null===D||void 0===D?void 0:D.email)||"",mobile:(null===D||void 0===D?void 0:D.mobile)||"",role:(null===D||void 0===D?void 0:D.role)||""});(0,l.useEffect)(()=>{if(null!==D&&void 0!==D&&D.photo_url){const e=D.photo_url.startsWith("http")?D.photo_url:"".concat(G).concat(D.photo_url);re(e)}},[D]);const ke=async e=>{pe(!0);try{let a;a="student"===(null===D||void 0===D?void 0:D.role)?"".concat(G,"/api/students/").concat(D.id,"/update-photo"):"director"===(null===D||void 0===D?void 0:D.role)||"principal"===(null===D||void 0===D?void 0:D.role)||"admin"===(null===D||void 0===D?void 0:D.role)?"".concat(G,"/api/users/").concat(D.id,"/update-photo"):"".concat(G,"/api/staff/").concat(D.id,"/update-photo"),await u.A.post(a,{photo_data:e},{headers:{Authorization:"Bearer ".concat(Z)}}),re(e),F.oR.success("Profile photo updated!");try{await u.A.post("".concat(G,"/api/ai-greeting/parent-photo/upload"),{student_id:(null===D||void 0===D?void 0:D.id)||"staff",school_id:$||"default",photo_type:"student"===(null===D||void 0===D?void 0:D.role)?"student":"staff",photo_data:e}),oe(!0)}catch(s){console.log("Face enrollment optional:",s)}}catch(a){re(e),F.oR.success("Photo saved locally!")}finally{pe(!1)}},Ce={director:{color:"bg-purple-100 text-purple-700",label:"Director"},principal:{color:"bg-blue-100 text-blue-700",label:"Principal"},vice_principal:{color:"bg-indigo-100 text-indigo-700",label:"Vice Principal"},teacher:{color:"bg-green-100 text-green-700",label:"Teacher"},accountant:{color:"bg-amber-100 text-amber-700",label:"Accountant"},student:{color:"bg-cyan-100 text-cyan-700",label:"Student"}}[Pe=null===D||void 0===D?void 0:D.role]||{color:"bg-slate-100 text-slate-700",label:Pe};var Pe;return(0,q.jsxs)("div",{className:"min-h-screen bg-slate-50 p-4 md:p-6","data-testid":"profile-page",children:[(0,q.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,q.jsxs)("div",{className:"text-center",children:[(0,q.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:z("profile")}),(0,q.jsx)("p",{className:"text-slate-500",children:"Manage your account & AI settings"})]}),(0,q.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,q.jsxs)("div",{className:"space-y-4",children:[(0,q.jsx)(i.Zp,{children:(0,q.jsxs)(i.Wu,{className:"p-6 text-center",children:[(0,q.jsx)("input",{type:"file",ref:ge,className:"hidden",accept:"image/jpeg,image/png,image/webp",onChange:async e=>{const s=e.target.files[0];if(!s)return;if(s.size>5242880)return void F.oR.error("File size should be less than 5MB");const a=new FileReader;a.onload=async e=>{await ke(e.target.result)},a.readAsDataURL(s)}}),(0,q.jsxs)("div",{className:"relative inline-block mb-4 group cursor-pointer",onClick:()=>{var e;return null===(e=ge.current)||void 0===e?void 0:e.click()},children:[le?(0,q.jsx)("img",{src:le,alt:null===D||void 0===D?void 0:D.name,className:"w-28 h-28 rounded-full object-cover border-4 border-indigo-100"}):(0,q.jsx)("div",{className:"w-28 h-28 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white text-3xl font-bold",children:(null===D||void 0===D||null===(e=D.name)||void 0===e||null===(s=e.charAt(0))||void 0===s?void 0:s.toUpperCase())||"U"}),(0,q.jsx)("div",{className:"absolute inset-0 bg-black/40 rounded-full opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:ue?(0,q.jsx)(p.A,{className:"w-8 h-8 text-white animate-spin"}):(0,q.jsx)(g.A,{className:"w-8 h-8 text-white"})}),(0,q.jsx)("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center border-2 border-white shadow-md",children:ne?(0,q.jsx)(f.A,{className:"w-4 h-4 text-white"}):(0,q.jsx)(g.A,{className:"w-4 h-4 text-white"})})]}),(0,q.jsx)("h2",{className:"text-lg font-bold text-slate-900",children:null===D||void 0===D?void 0:D.name}),(0,q.jsx)("span",{className:"inline-block mt-1 px-3 py-1 rounded-full text-sm font-medium ".concat(Ce.color),children:Ce.label}),(0,q.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:"Photo change karne ke liye click karein"}),ne?(0,q.jsxs)(h.E,{className:"mt-3 bg-green-100 text-green-700 block mx-auto w-fit",children:[(0,q.jsx)(f.A,{className:"w-3 h-3 mr-1"}),"Face Enrolled for AI"]}):(0,q.jsxs)(h.E,{className:"mt-3 bg-amber-100 text-amber-700 block mx-auto w-fit",children:[(0,q.jsx)(j.A,{className:"w-3 h-3 mr-1"}),"Enroll Face for AI"]})]})}),(0,q.jsx)(H,{personId:null===D||void 0===D?void 0:D.id,personType:"student"===(null===D||void 0===D?void 0:D.role)?"student":"staff",personName:null===D||void 0===D?void 0:D.name,schoolId:$,minPhotos:4,maxPhotos:5,onComplete:e=>{e.success&&(oe(!0),F.oR.success("".concat(e.photoCount," photos enrolled!")))}}),(0,q.jsxs)(i.Zp,{children:[(0,q.jsx)(i.aR,{className:"pb-2",children:(0,q.jsxs)(i.ZB,{className:"text-base flex items-center gap-2",children:[(0,q.jsx)(v.A,{className:"w-5 h-5 text-indigo-600"}),"AI Features"]})}),(0,q.jsxs)(i.Wu,{className:"space-y-3",children:[(0,q.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,q.jsxs)("div",{className:"flex items-center gap-2",children:[(0,q.jsx)(N.A,{className:"w-4 h-4 text-purple-600"}),(0,q.jsx)("span",{className:"text-sm",children:"CCTV Commands"})]}),(0,q.jsx)(c.$,{size:"sm",variant:ce?"default":"outline",onClick:()=>{ie(!ce),F.oR.success(ce?"CCTV authorization disabled":"CCTV authorization enabled - You can now give commands via CCTV!")},className:ce?"bg-green-500 hover:bg-green-600":"",children:ce?"On":"Off"})]}),(0,q.jsx)("p",{className:"text-xs text-slate-500 px-1",children:ce?"\u2705 Aap CCTV se Tino ko command de sakte hain":"Enable karein to give voice commands via CCTV"})]})]})]}),(0,q.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,q.jsxs)(i.Zp,{children:[(0,q.jsx)(i.aR,{children:(0,q.jsxs)(i.ZB,{className:"text-lg flex items-center gap-2",children:[(0,q.jsx)(w.A,{className:"w-5 h-5 text-indigo-600"}),z("profile")]})}),(0,q.jsxs)(i.Wu,{className:"space-y-4",children:[(0,q.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,q.jsxs)("div",{className:"space-y-1",children:[(0,q.jsx)(m.J,{className:"text-slate-500 text-xs",children:z("name")}),(0,q.jsx)("p",{className:"font-medium",children:null===D||void 0===D?void 0:D.name})]}),(0,q.jsxs)("div",{className:"space-y-1",children:[(0,q.jsx)(m.J,{className:"text-slate-500 text-xs",children:"Role"}),(0,q.jsx)("p",{className:"font-medium capitalize",children:null===D||void 0===D||null===(a=D.role)||void 0===a?void 0:a.replace("_"," ")})]})]}),(0,q.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,q.jsxs)("div",{className:"space-y-1",children:[(0,q.jsx)(m.J,{className:"text-slate-500 text-xs",children:z("email")}),(0,q.jsxs)("div",{className:"flex items-center gap-2",children:[(0,q.jsx)(b.A,{className:"w-4 h-4 text-slate-400"}),(0,q.jsx)("p",{className:"text-sm",children:null===D||void 0===D?void 0:D.email})]})]}),(null===D||void 0===D?void 0:D.mobile)&&(0,q.jsxs)("div",{className:"space-y-1",children:[(0,q.jsx)(m.J,{className:"text-slate-500 text-xs",children:z("phone")}),(0,q.jsxs)("div",{className:"flex items-center gap-2",children:[(0,q.jsx)(y.A,{className:"w-4 h-4 text-slate-400"}),(0,q.jsx)("p",{className:"text-sm",children:D.mobile})]})]})]}),(null===D||void 0===D?void 0:D.school_id)&&(0,q.jsxs)("div",{className:"space-y-1",children:[(0,q.jsx)(m.J,{className:"text-slate-500 text-xs",children:"School ID"}),(0,q.jsxs)("div",{className:"flex items-center gap-2",children:[(0,q.jsx)(A.A,{className:"w-4 h-4 text-slate-400"}),(0,q.jsx)("p",{className:"text-sm",children:D.school_id})]})]})]})]}),(0,q.jsxs)(i.Zp,{children:[(0,q.jsx)(i.aR,{children:(0,q.jsxs)(i.ZB,{className:"text-lg flex items-center gap-2",children:[(0,q.jsx)(k.A,{className:"w-5 h-5 text-indigo-600"}),"Account Settings"]})}),(0,q.jsxs)(i.Wu,{className:"space-y-4",children:[(0,q.jsxs)(c.$,{variant:"outline",className:"w-full justify-between h-14 border-blue-200 hover:bg-blue-50",onClick:()=>te(!0),children:[(0,q.jsxs)("div",{className:"flex items-center gap-3",children:[(0,q.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,q.jsx)(C.A,{className:"w-5 h-5 text-blue-600"})}),(0,q.jsxs)("div",{className:"text-left",children:[(0,q.jsx)("p",{className:"font-medium",children:"My ID Card"}),(0,q.jsx)("p",{className:"text-xs text-slate-500",children:"View & print your ID card"})]})]}),(0,q.jsx)(P.A,{className:"w-4 h-4 text-slate-400"})]}),(0,q.jsxs)(c.$,{variant:"outline",className:"w-full justify-between h-14",onClick:()=>O(!0),"data-testid":"change-password-button",children:[(0,q.jsxs)("div",{className:"flex items-center gap-3",children:[(0,q.jsx)("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:(0,q.jsx)(R.A,{className:"w-5 h-5 text-amber-600"})}),(0,q.jsxs)("div",{className:"text-left",children:[(0,q.jsx)("p",{className:"font-medium",children:"Change Password"}),(0,q.jsx)("p",{className:"text-xs text-slate-500",children:"Update your account password"})]})]}),(0,q.jsx)(S.A,{className:"w-4 h-4 text-slate-400"})]}),("director"===(null===D||void 0===D?void 0:D.role)||"principal"===(null===D||void 0===D?void 0:D.role))&&(0,q.jsxs)(c.$,{variant:"outline",className:"w-full justify-between h-14 border-indigo-200 hover:bg-indigo-50",onClick:()=>V("/app/setup-guide"),children:[(0,q.jsxs)("div",{className:"flex items-center gap-3",children:[(0,q.jsx)("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:(0,q.jsx)(M.A,{className:"w-5 h-5 text-indigo-600"})}),(0,q.jsxs)("div",{className:"text-left",children:[(0,q.jsx)("p",{className:"font-medium text-indigo-700",children:"Setup Guide / Resume Setup"}),(0,q.jsx)("p",{className:"text-xs text-slate-500",children:"CCTV, Speaker, Website configure \u0915\u0930\u0947\u0902"})]})]}),(0,q.jsx)(P.A,{className:"w-4 h-4 text-indigo-400"})]}),(0,q.jsx)(c.$,{variant:"outline",className:"w-full justify-between h-14 border-red-200 hover:bg-red-50",onClick:B,children:(0,q.jsxs)("div",{className:"flex items-center gap-3",children:[(0,q.jsx)("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:(0,q.jsx)(T.A,{className:"w-5 h-5 text-red-600"})}),(0,q.jsxs)("div",{className:"text-left",children:[(0,q.jsx)("p",{className:"font-medium text-red-600",children:"Logout"}),(0,q.jsx)("p",{className:"text-xs text-slate-500",children:"Sign out from your account"})]})]})})]})]})]})]})]}),(0,q.jsx)(x.lG,{open:U,onOpenChange:O,children:(0,q.jsxs)(x.Cf,{className:"max-w-md",children:[(0,q.jsx)(x.c7,{children:(0,q.jsxs)(x.L3,{className:"flex items-center gap-2",children:[(0,q.jsx)(R.A,{className:"w-5 h-5 text-amber-600"}),"Change Password"]})}),(0,q.jsxs)("div",{className:"space-y-4",children:[(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"text-sm font-medium text-slate-700 mb-1 block",children:"Current Password"}),(0,q.jsxs)("div",{className:"relative",children:[(0,q.jsx)(d.p,{type:Y?"text":"password",value:we.oldPassword,onChange:e=>be(s=>(0,t.A)((0,t.A)({},s),{},{oldPassword:e.target.value})),placeholder:"Enter current password","data-testid":"old-password-input"}),(0,q.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2",onClick:()=>Q(!Y),children:Y?(0,q.jsx)(I.A,{className:"w-4 h-4 text-slate-400"}):(0,q.jsx)(_.A,{className:"w-4 h-4 text-slate-400"})})]})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"text-sm font-medium text-slate-700 mb-1 block",children:"New Password"}),(0,q.jsxs)("div",{className:"relative",children:[(0,q.jsx)(d.p,{type:ee?"text":"password",value:we.newPassword,onChange:e=>be(s=>(0,t.A)((0,t.A)({},s),{},{newPassword:e.target.value})),placeholder:"Enter new password (min 6 chars)","data-testid":"new-password-input"}),(0,q.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2",onClick:()=>se(!ee),children:ee?(0,q.jsx)(I.A,{className:"w-4 h-4 text-slate-400"}):(0,q.jsx)(_.A,{className:"w-4 h-4 text-slate-400"})})]})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"text-sm font-medium text-slate-700 mb-1 block",children:"Confirm New Password"}),(0,q.jsx)(d.p,{type:"password",value:we.confirmPassword,onChange:e=>be(s=>(0,t.A)((0,t.A)({},s),{},{confirmPassword:e.target.value})),placeholder:"Confirm new password","data-testid":"confirm-password-input"}),we.confirmPassword&&we.newPassword!==we.confirmPassword&&(0,q.jsxs)("p",{className:"text-xs text-red-500 mt-1 flex items-center gap-1",children:[(0,q.jsx)(j.A,{className:"w-3 h-3"}),"Passwords do not match"]})]}),(0,q.jsxs)(c.$,{onClick:async()=>{if(we.oldPassword&&we.newPassword)if(we.newPassword===we.confirmPassword)if(we.newPassword.length<6)F.oR.error("Password must be at least 6 characters");else{X(!0);try{const e=new FormData;e.append("old_password",we.oldPassword),e.append("new_password",we.newPassword);const s=await fetch("".concat(G,"/api/auth/change-password"),{method:"POST",headers:{Authorization:"Bearer ".concat(Z)},body:e}),a=await s.json();s.ok?(F.oR.success("Password changed successfully! \ud83c\udf89"),O(!1),be({oldPassword:"",newPassword:"",confirmPassword:""})):F.oR.error(a.detail||"Failed to change password")}catch(e){F.oR.error("Error changing password")}finally{X(!1)}}else F.oR.error("New passwords do not match");else F.oR.error("Please fill all password fields")},disabled:K||!we.oldPassword||!we.newPassword||we.newPassword!==we.confirmPassword,className:"w-full","data-testid":"submit-password-change",children:[K?(0,q.jsx)(p.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,q.jsx)(E.A,{className:"w-4 h-4 mr-2"}),"Change Password"]}),(0,q.jsx)("p",{className:"text-xs text-slate-500 text-center",children:"Password change hone ke baad aapko dobara login karna padega"})]})]})}),ae&&(null===D||void 0===D?void 0:D.id)&&(0,q.jsx)(J.A,{personId:D.id,personType:"staff",schoolId:$,isOpen:ae,onClose:()=>te(!1)})]})}},5462(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},2257(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},9284(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},2828(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1654(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},8276(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},1742(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},602(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]])}}]);