"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8190],{1111(e,a,s){s.d(a,{$:()=>p});var t=s(2555),l=s(3986),r=s(9950),n=s(2962),i=s(4364),d=s(9332),c=s(4414);const o=["className","variant","size","asChild"],m=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-blue-500 text-white shadow-sm hover:bg-blue-600 rounded-lg",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-gray-200 bg-white shadow-sm hover:bg-gray-50 text-gray-700 rounded-lg",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),p=r.forwardRef((e,a)=>{let{className:s,variant:r,size:i,asChild:p=!1}=e,x=(0,l.A)(e,o);const u=p?n.DX:"button";return(0,c.jsx)(u,(0,t.A)({className:(0,d.cn)(m({variant:r,size:i,className:s})),ref:a},x))});p.displayName="Button"},7255(e,a,s){s.d(a,{Cf:()=>b,L3:()=>j,c7:()=>N,lG:()=>f,rr:()=>y,zM:()=>h});var t=s(2555),l=s(3986),r=s(9950),n=s(9710),i=s(6479),d=s(9332),c=s(4414);const o=["className"],m=["className","children"],p=["className"],x=["className"],u=["className"],f=n.bL,h=n.l9,v=n.ZL,g=(n.bm,r.forwardRef((e,a)=>{let{className:s}=e,r=(0,l.A)(e,o);return(0,c.jsx)(n.hJ,(0,t.A)({ref:a,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},r))}));g.displayName=n.hJ.displayName;const b=r.forwardRef((e,a)=>{let{className:s,children:r}=e,o=(0,l.A)(e,m);return(0,c.jsxs)(v,{children:[(0,c.jsx)(g,{}),(0,c.jsxs)(n.UC,(0,t.A)((0,t.A)({ref:a,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},o),{},{children:[r,(0,c.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,c.jsx)(i.A,{className:"h-4 w-4"}),(0,c.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});b.displayName=n.UC.displayName;const N=e=>{let{className:a}=e,s=(0,l.A)(e,p);return(0,c.jsx)("div",(0,t.A)({className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a)},s))};N.displayName="DialogHeader";const j=r.forwardRef((e,a)=>{let{className:s}=e,r=(0,l.A)(e,x);return(0,c.jsx)(n.hE,(0,t.A)({ref:a,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",s)},r))});j.displayName=n.hE.displayName;const y=r.forwardRef((e,a)=>{let{className:s}=e,r=(0,l.A)(e,u);return(0,c.jsx)(n.VY,(0,t.A)({ref:a,className:(0,d.cn)("text-sm text-muted-foreground",s)},r))});y.displayName=n.VY.displayName},4779(e,a,s){s.d(a,{p:()=>c});var t=s(2555),l=s(3986),r=s(9950),n=s(9332),i=s(4414);const d=["className","type"],c=r.forwardRef((e,a)=>{let{className:s,type:r}=e,c=(0,l.A)(e,d);return(0,i.jsx)("input",(0,t.A)({type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a},c))});c.displayName="Input"},557(e,a,s){s.d(a,{J:()=>p});var t=s(2555),l=s(3986),r=s(9950),n=s(1611),i=s(4364),d=s(9332),c=s(4414);const o=["className"],m=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),p=r.forwardRef((e,a)=>{let{className:s}=e,r=(0,l.A)(e,o);return(0,c.jsx)(n.b,(0,t.A)({ref:a,className:(0,d.cn)(m(),s)},r))});p.displayName=n.b.displayName},5475(e,a,s){s.d(a,{Xi:()=>u,av:()=>f,j7:()=>x,tU:()=>p});var t=s(2555),l=s(3986),r=s(9950),n=s(7970),i=s(9332),d=s(4414);const c=["className"],o=["className"],m=["className"],p=n.bL,x=r.forwardRef((e,a)=>{let{className:s}=e,r=(0,l.A)(e,c);return(0,d.jsx)(n.B8,(0,t.A)({ref:a,className:(0,i.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-gray-100 border border-gray-200 p-1 text-muted-foreground",s)},r))});x.displayName=n.B8.displayName;const u=r.forwardRef((e,a)=>{let{className:s}=e,r=(0,l.A)(e,o);return(0,d.jsx)(n.l9,(0,t.A)({ref:a,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-blue-500",s)},r))});u.displayName=n.l9.displayName;const f=r.forwardRef((e,a)=>{let{className:s}=e,r=(0,l.A)(e,m);return(0,d.jsx)(n.UC,(0,t.A)({ref:a,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s)},r))});f.displayName=n.UC.displayName},9093(e,a,s){s.d(a,{T:()=>c});var t=s(2555),l=s(3986),r=s(9950),n=s(9332),i=s(4414);const d=["className"],c=r.forwardRef((e,a)=>{let{className:s}=e,r=(0,l.A)(e,d);return(0,i.jsx)("textarea",(0,t.A)({className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a},r))});c.displayName="Textarea"},9332(e,a,s){s.d(a,{cn:()=>r});var t=s(2004),l=s(9800);function r(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,l.QP)((0,t.$)(a))}},8190(e,a,s){s.r(a),s.d(a,{default:()=>A});var t=s(2555),l=s(9950),r=s(5030),n=s(5532),i=s(6910),d=s(1111),c=s(4779),o=s(557),m=s(9093),p=s(7255),x=s(5475),u=s(5833),f=s(9469),h=s(2989),v=s(9201),g=s(7637),b=s(2737),N=s(1064),j=s(2033),y=s(4414);const w="".concat("","/api");function A(){const{t:e}=(0,r.Bd)(),{user:a}=(0,n.As)(),[s,A]=(0,l.useState)(!0),[_,k]=(0,l.useState)(!1),[C,R]=(0,l.useState)([]),[z,L]=(0,l.useState)([]),[S,J]=(0,l.useState)(null),[F,U]=(0,l.useState)(!1),D=["director","principal","vice_principal"].includes(null===a||void 0===a?void 0:a.role),$=["teacher","staff","student"].includes(null===a||void 0===a?void 0:a.role),[E,q]=(0,l.useState)(D&&!$?"pending":"my-leaves"),[B,P]=(0,l.useState)({leave_type:"casual",from_date:"",to_date:"",reason:"",half_day:!1}),V=[{id:"sick",name:e("sick_leave"),color:"rose"},{id:"casual",name:e("casual_leave"),color:"blue"},{id:"personal",name:e("personal_leave")||"Personal Leave",color:"purple"},{id:"emergency",name:e("emergency_leave")||"Emergency Leave",color:"amber"}];(0,l.useEffect)(()=>{X()},[]);const X=async()=>{A(!0);try{const[e,s]=await Promise.all([i.A.get("".concat(w,"/leave/my-leaves")),i.A.get("".concat(w,"/leave/balance"))]);if(R(e.data),J(s.data.balance),["director","principal","vice_principal","teacher"].includes(null===a||void 0===a?void 0:a.role)){const e=await i.A.get("".concat(w,"/leave/pending"));L(e.data)}}catch(e){console.error("Failed to fetch leave data")}finally{A(!1)}};if(s)return(0,y.jsx)("div",{className:"flex justify-center py-20",children:(0,y.jsx)(h.A,{className:"w-10 h-10 animate-spin"})});const T=["director","principal","vice_principal","teacher"].includes(null===a||void 0===a?void 0:a.role);return(0,y.jsxs)("div",{className:"space-y-6","data-testid":"leave-management",children:[(0,y.jsx)("div",{className:"bg-gradient-to-r from-teal-600 to-cyan-600 rounded-2xl p-6 text-white",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("h1",{className:"text-3xl font-bold font-heading flex items-center gap-3",children:[(0,y.jsx)(v.A,{className:"w-8 h-8"}),e("leave_management")]}),(0,y.jsx)("p",{className:"text-teal-100 mt-2",children:T&&!$?"Approve or reject leave applications":"Apply for leave, check balance & track status"})]}),$&&(0,y.jsxs)(d.$,{onClick:()=>U(!0),className:"bg-white text-teal-600 hover:bg-teal-50",children:[(0,y.jsx)(b.A,{className:"w-4 h-4 mr-2"}),e("apply_leave")]})]})}),S&&(0,y.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(S).map(e=>{let[a,s]=e;const t=V.find(e=>e.id===a)||{name:a,color:"slate"};return(0,y.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[(0,y.jsx)("p",{className:"text-sm text-slate-500 capitalize",children:t.name}),(0,y.jsxs)("div",{className:"flex items-end gap-1 mt-1",children:[(0,y.jsx)("span",{className:"text-2xl font-bold text-slate-900",children:s.remaining}),(0,y.jsxs)("span",{className:"text-sm text-slate-400 mb-1",children:["/ ",s.total]})]}),(0,y.jsx)("div",{className:"w-full bg-slate-100 rounded-full h-2 mt-2",children:(0,y.jsx)("div",{className:"bg-".concat(t.color,"-500 h-2 rounded-full"),style:{width:"".concat(s.remaining/s.total*100,"%"),backgroundColor:"rose"===t.color?"#f43f5e":"blue"===t.color?"#3b82f6":"purple"===t.color?"#a855f7":"#f59e0b"}})})]},a)})}),(0,y.jsxs)(x.tU,{value:E,onValueChange:q,children:[(0,y.jsxs)(x.j7,{className:"bg-slate-100",children:[$&&(0,y.jsx)(x.Xi,{value:"my-leaves",children:e("leave_management")}),T&&(0,y.jsxs)(x.Xi,{value:"pending",children:[e("pending"),z.length>0&&(0,y.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-amber-500 text-white text-xs rounded-full",children:z.length})]})]}),(0,y.jsx)(x.av,{value:"my-leaves",className:"mt-4",children:(0,y.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:0===C.length?(0,y.jsxs)("div",{className:"p-12 text-center",children:[(0,y.jsx)(g.A,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),(0,y.jsx)("p",{className:"text-slate-500",children:"No leave applications yet"})]}):(0,y.jsx)("div",{className:"divide-y divide-slate-100",children:C.map(e=>{return(0,y.jsx)("div",{className:"p-4 hover:bg-slate-50",children:(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsxs)("span",{className:"font-medium text-slate-900 capitalize",children:[e.leave_type," Leave"]}),(a=e.status,(0,y.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({pending:"bg-amber-100 text-amber-700",approved:"bg-emerald-100 text-emerald-700",rejected:"bg-rose-100 text-rose-700"}[a]),children:a.charAt(0).toUpperCase()+a.slice(1)}))]}),(0,y.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:[e.from_date," to ",e.to_date," (",e.days," ",1===e.days?"day":"days",")"]}),(0,y.jsx)("p",{className:"text-sm text-slate-600 mt-2",children:e.reason})]}),(0,y.jsx)("div",{className:"text-right text-xs text-slate-400",children:new Date(e.created_at).toLocaleDateString()})]})},e.id);var a})})})}),(0,y.jsx)(x.av,{value:"pending",className:"mt-4",children:(0,y.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:0===z.length?(0,y.jsxs)("div",{className:"p-12 text-center",children:[(0,y.jsx)(u.A,{className:"w-12 h-12 text-emerald-300 mx-auto mb-3"}),(0,y.jsx)("p",{className:"text-slate-500",children:"No pending approvals"})]}):(0,y.jsx)("div",{className:"divide-y divide-slate-100",children:z.map(a=>(0,y.jsx)("div",{className:"p-4",children:(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)(N.A,{className:"w-5 h-5 text-slate-400"}),(0,y.jsx)("span",{className:"font-medium text-slate-900",children:a.applicant_name}),(0,y.jsxs)("span",{className:"text-xs text-slate-500 capitalize",children:["(",a.applicant_type,")"]})]}),(0,y.jsxs)("p",{className:"text-sm text-slate-600 mt-1 capitalize",children:[a.leave_type," Leave: ",a.from_date," to ",a.to_date," (",a.days," days)"]}),(0,y.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:a.reason})]}),(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsxs)(d.$,{size:"sm",className:"bg-emerald-600 hover:bg-emerald-700",onClick:()=>(async e=>{try{await i.A.post("".concat(w,"/leave/").concat(e,"/approve")),j.oR.success("Leave approved!"),X()}catch(a){j.oR.error("Failed to approve")}})(a.id),children:[(0,y.jsx)(u.A,{className:"w-4 h-4 mr-1"}),e("approve")]}),(0,y.jsxs)(d.$,{size:"sm",variant:"destructive",onClick:()=>(async e=>{try{await i.A.post("".concat(w,"/leave/").concat(e,"/reject")),j.oR.success("Leave rejected"),X()}catch(a){j.oR.error("Failed to reject")}})(a.id),children:[(0,y.jsx)(f.A,{className:"w-4 h-4 mr-1"}),e("reject")]})]})]})},a.id))})})})]}),(0,y.jsx)(p.lG,{open:F,onOpenChange:U,children:(0,y.jsxs)(p.Cf,{children:[(0,y.jsx)(p.c7,{children:(0,y.jsx)(p.L3,{children:e("apply_leave")})}),(0,y.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),B.from_date&&B.to_date&&B.reason){k(!0);try{await i.A.post("".concat(w,"/leave/apply"),B),j.oR.success("Leave application submitted!"),U(!1),P({leave_type:"casual",from_date:"",to_date:"",reason:"",half_day:!1}),X()}catch(a){j.oR.error("Failed to apply for leave")}finally{k(!1)}}else j.oR.error("Please fill all required fields")},className:"space-y-4",children:[(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(o.J,{children:e("leave_type")}),(0,y.jsx)("select",{value:B.leave_type,onChange:e=>P(a=>(0,t.A)((0,t.A)({},a),{},{leave_type:e.target.value})),className:"w-full h-10 rounded-lg border border-slate-200 px-3",children:V.map(e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(o.J,{children:e("from_date")}),(0,y.jsx)(c.p,{type:"date",value:B.from_date,onChange:e=>P(a=>(0,t.A)((0,t.A)({},a),{},{from_date:e.target.value})),required:!0})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(o.J,{children:e("to_date")}),(0,y.jsx)(c.p,{type:"date",value:B.to_date,onChange:e=>P(a=>(0,t.A)((0,t.A)({},a),{},{to_date:e.target.value})),required:!0})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("input",{type:"checkbox",id:"half_day",checked:B.half_day,onChange:e=>P(a=>(0,t.A)((0,t.A)({},a),{},{half_day:e.target.checked})),className:"rounded"}),(0,y.jsx)(o.J,{htmlFor:"half_day",children:"Half Day"})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(o.J,{children:"Reason"}),(0,y.jsx)(m.T,{value:B.reason,onChange:e=>P(a=>(0,t.A)((0,t.A)({},a),{},{reason:e.target.value})),placeholder:"Enter reason for leave...",rows:3,required:!0})]}),(0,y.jsxs)(d.$,{type:"submit",className:"w-full",disabled:_,children:[_?(0,y.jsx)(h.A,{className:"w-4 h-4 animate-spin mr-2"}):(0,y.jsx)(b.A,{className:"w-4 h-4 mr-2"}),"Submit Application"]})]})]})})]})}}}]);