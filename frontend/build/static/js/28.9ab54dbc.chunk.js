/*! For license information please see 28.9ab54dbc.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[28],{28(e,t,a){a.r(t),a.d(t,{default:()=>F});var s=a(5043),n=a(5029),l=a(6930),i=a(8729),r=a(9722),o=a(2024),c=a(9797),d=a(7365),m=a(7118),h=a(6873),p=a(1527),x=a(5247),g=a(2029),u=a(1884),b=a(9233),f=a(1680),y=a(6382),v=a(3165),j=a(5088),k=a(2626),_=a(780),w=a(2414),N=a(4669),A=a(2489),C=a(2244),S=a(8646),q=a(7033),z=a(9333),B=a(1990),M=a(5264),I=a(7010);const U=(0,a(7784).A)("arrow-down-right",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);var D=a(6401),E=a(8326),H=a(579);const O="".concat("","/api");function F(){var e,t;const{t:a}=(0,l.Bd)(),F=(0,n.Zp)(),{schoolId:J,user:L,schoolData:R}=(0,i.As)(),[K,P]=(0,s.useState)(null),[T,Z]=(0,s.useState)(!0),[G,Q]=(0,s.useState)(null),[V,W]=(0,s.useState)([]),[X,Y]=(0,s.useState)(0),[$,ee]=(0,s.useState)({}),te=(0,s.useRef)(!1),ae=(0,s.useCallback)(async()=>{try{const e=localStorage.getItem("module_visibility_settings");if(e)return void ee(JSON.parse(e))}catch(e){}if(!te.current){te.current=!0;try{const e=localStorage.getItem("token");if(e){const t=await fetch("".concat(O,"/settings/module-visibility"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){const e=await t.json();e&&Object.keys(e).length>0&&(ee(e),localStorage.setItem("module_visibility_settings",JSON.stringify(e)))}}}catch(e){}}},[]);(0,s.useEffect)(()=>{ae();const e=()=>{try{const e=localStorage.getItem("module_visibility_settings");e&&ee(JSON.parse(e))}catch(e){}};return window.addEventListener("module_visibility_changed",e),()=>window.removeEventListener("module_visibility_changed",e)},[ae]);const se=(0,s.useCallback)(async()=>{if(J)try{Q(null);const e=localStorage.getItem("token"),t=await r.A.get("".concat(O,"/dashboard/stats?school_id=").concat(J),{headers:{Authorization:"Bearer ".concat(e)}});P(t.data)}catch(e){console.error("Failed to fetch stats:",e),P({total_students:0,total_staff:0,fee_collection_month:0,attendance_today:{present:0},pending_fees:0})}finally{Z(!1)}else Z(!1)},[J]),ne=(0,s.useCallback)(async()=>{try{const e=localStorage.getItem("token"),t=await r.A.get("".concat(O,"/admin/teacher-requests?status=pending"),{headers:{Authorization:"Bearer ".concat(e)}});W(t.data||[])}catch(e){console.error("Teacher requests fetch failed:",e)}},[]),le=(0,s.useCallback)(async()=>{try{var e;const t=localStorage.getItem("token"),a=await r.A.get("".concat(O,"/admin/pending-count"),{headers:{Authorization:"Bearer ".concat(t)}});Y((null===(e=a.data)||void 0===e?void 0:e.pending_requests)||0)}catch(t){console.error("Pending count fetch failed:",t)}},[]);(0,s.useEffect)(()=>{J?(se(),"director"!==(null===L||void 0===L?void 0:L.role)&&"principal"!==(null===L||void 0===L?void 0:L.role)&&"admin"!==(null===L||void 0===L?void 0:L.role)||(ne(),le())):Z(!1)},[J,null===L||void 0===L?void 0:L.role,se,ne,le]);if(T)return(0,H.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 gap-3",children:[(0,H.jsx)(o.A,{className:"w-8 h-8 animate-spin text-blue-500"}),(0,H.jsx)("p",{className:"text-sm text-gray-400",children:a("loading")})]});if(!J)return(0,H.jsxs)("div",{className:"text-center py-20",children:[(0,H.jsx)("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center",children:(0,H.jsx)(c.A,{className:"w-10 h-10 text-white"})}),(0,H.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:a("welcome_to_dashboard")}),(0,H.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:a("setup_school_desc")}),(0,H.jsxs)("button",{onClick:()=>F("/app/settings"),className:"px-6 py-3 bg-blue-600 text-white rounded-xl font-medium text-sm hover:bg-blue-700 inline-flex items-center gap-2",children:[(0,H.jsx)(d.A,{className:"w-4 h-4"}),a("get_started")]})]});const ie=K||{total_students:0,total_staff:0,fee_collection_month:0,attendance_today:{present:0},pending_fees:0},re=[{label:a("total_students"),value:ie.total_students||0,icon:m.A,gradient:"from-blue-500 to-blue-600",trend:"+12%",trendUp:!0},{label:a("total_staff"),value:ie.total_staff||0,icon:h.A,gradient:"from-purple-500 to-purple-600",trend:"+5%",trendUp:!0},{label:a("fee_collected"),value:"\u20b9".concat(((ie.fee_collection_month||0)/1e3).toFixed(0),"K"),icon:p.A,gradient:"from-emerald-500 to-teal-600",trend:"+18%",trendUp:!0},{label:a("attendance_today"),value:"".concat((null===(e=ie.attendance_today)||void 0===e?void 0:e.present)||0,"%"),icon:x.A,gradient:"from-orange-500 to-amber-600",trend:"+2%",trendUp:!0},{label:a("pending_fees"),value:"\u20b9".concat(((ie.pending_fees||0)/1e3).toFixed(0),"K"),icon:g.A,gradient:"from-red-500 to-rose-600",trend:"-8%",trendUp:!1}],oe=[{icon:u.A,label:a("new_admissions"),path:"/app/students",color:"bg-blue-500",lightBg:"bg-blue-50",textColor:"text-blue-600"},{icon:x.A,label:a("mark_attendance"),path:"/app/attendance",color:"bg-purple-500",lightBg:"bg-purple-50",textColor:"text-purple-600"},{icon:p.A,label:a("collect_fee"),path:"/app/fees",color:"bg-emerald-500",lightBg:"bg-emerald-50",textColor:"text-emerald-600"},{icon:b.A,label:a("send_notice"),path:"/app/communication",color:"bg-orange-500",lightBg:"bg-orange-50",textColor:"text-orange-600"},{icon:f.A,label:a("create_exam"),path:"/app/exams",color:"bg-pink-500",lightBg:"bg-pink-50",textColor:"text-pink-600"},{icon:y.A,label:a("ai_tools"),path:"/app/ai-tools",color:"bg-indigo-500",lightBg:"bg-indigo-50",textColor:"text-indigo-600"}],ce=[{icon:m.A,label:a("students"),desc:a("student_list"),path:"/app/students",gradient:"from-blue-500 to-blue-600",mk:"students"},{icon:h.A,label:a("staff"),desc:a("staff_management"),path:"/app/staff",gradient:"from-purple-500 to-violet-500",mk:"staff"},{icon:c.A,label:a("classes"),desc:a("class_list"),path:"/app/classes",gradient:"from-cyan-500 to-blue-500",mk:"classes"},{icon:x.A,label:a("attendance"),desc:a("view_attendance"),path:"/app/attendance",gradient:"from-teal-500 to-emerald-500",mk:"attendance"},{icon:p.A,label:a("fees"),desc:a("fee_management"),path:"/app/fees",gradient:"from-emerald-500 to-green-500",mk:"fee_management"},{icon:v.A,label:a("admissions"),desc:a("admissions_crm"),path:"/app/admissions",gradient:"from-cyan-500 to-blue-500",mk:"admissions"},{icon:f.A,label:a("exams"),desc:a("exams_reports"),path:"/app/exams",gradient:"from-pink-500 to-rose-500",mk:"exams_reports"},{icon:j.A,label:a("timetable"),desc:a("schedule_class"),path:"/app/timetable",gradient:"from-indigo-500 to-blue-500",mk:"timetable"},{icon:k.A,label:a("library"),desc:a("digital_library"),path:"/app/library",gradient:"from-purple-500 to-fuchsia-500",mk:"digital_library"},{icon:_.A,label:a("homework"),desc:a("homework_list"),path:"/app/homework",gradient:"from-amber-500 to-orange-500",mk:"homework"},{icon:w.A,label:a("live_classes"),desc:a("online_class"),path:"/app/live-classes",gradient:"from-red-500 to-rose-500",mk:"live_classes"},{icon:N.A,label:a("communication"),desc:a("communication_hub"),path:"/app/communication",gradient:"from-sky-500 to-cyan-500",mk:"communication_hub"},{icon:A.A,label:a("front_office"),desc:a("visitor_management"),path:"/app/front-office",gradient:"from-teal-500 to-cyan-500",mk:"front_office"},{icon:C.A,label:a("transport"),desc:a("gps_tracking"),path:"/app/transport",gradient:"from-orange-500 to-red-500",mk:"transport"},{icon:S.A,label:a("calendar"),desc:a("events"),path:"/app/calendar",gradient:"from-emerald-500 to-teal-500",mk:"calendar"},{icon:q.A,label:a("analytics"),desc:a("reports"),path:"/app/analytics",gradient:"from-blue-500 to-indigo-500",mk:"analytics"},{icon:y.A,label:a("ai_tools"),desc:a("ai_paper"),path:"/app/ai-tools",gradient:"from-purple-500 to-pink-500",mk:"ai_tools"},{icon:z.A,label:a("cctv"),desc:a("cctv_integration"),path:"/app/cctv",gradient:"from-red-500 to-rose-500",mk:"cctv"},{icon:B.A,label:a("inventory"),desc:a("item_list"),path:"/app/inventory",gradient:"from-slate-500 to-zinc-600",mk:"inventory"},{icon:M.A,label:a("multi_branch"),desc:a("branch_list"),path:"/app/multi-branch",gradient:"from-blue-500 to-indigo-500",mk:"multi_branch"}].filter(e=>{return!(t=e.mk)||!$[t]||!1!==$[t].schooltino;var t}),de=(new Date).getHours(),me=a(de<12?"good_morning":de<17?"good_afternoon":"good_evening");return(0,H.jsxs)("div",{className:"space-y-8 max-w-7xl",children:[(0,H.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4",children:[(0,H.jsxs)("div",{children:[(0,H.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:me}),(0,H.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:(null===L||void 0===L||null===(t=L.name)||void 0===t?void 0:t.split(" ")[0])||a("dashboard")}),(0,H.jsx)("p",{className:"text-sm text-gray-400 mt-0.5",children:(null===R||void 0===R?void 0:R.name)||a("dashboard")})]}),(0,H.jsxs)("div",{className:"flex items-center gap-3",children:[(0,H.jsxs)("button",{onClick:()=>F("/app/analytics"),className:"inline-flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl text-sm font-medium text-gray-700 hover:bg-gray-50 transition-all shadow-sm",children:[(0,H.jsx)(q.A,{className:"w-4 h-4 text-blue-500"}),(0,H.jsx)("span",{className:"hidden sm:inline",children:a("analytics")})]}),(0,H.jsxs)("button",{onClick:()=>F("/app/settings"),className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-xl text-sm font-medium hover:bg-blue-700 transition-all shadow-sm",children:[(0,H.jsx)(d.A,{className:"w-4 h-4"}),(0,H.jsx)("span",{className:"hidden sm:inline",children:a("settings")})]})]})]}),(0,H.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:re.map((e,t)=>(0,H.jsxs)("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300",children:[(0,H.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,H.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br ".concat(e.gradient," flex items-center justify-center"),children:(0,H.jsx)(e.icon,{className:"w-5 h-5 text-white"})}),(0,H.jsxs)("div",{className:"flex items-center gap-1 text-xs font-semibold px-2 py-1 rounded-full ".concat(e.trendUp?"bg-emerald-50 text-emerald-600":"bg-red-50 text-red-500"),children:[e.trendUp?(0,H.jsx)(I.A,{className:"w-3 h-3"}):(0,H.jsx)(U,{className:"w-3 h-3"}),e.trend]})]}),(0,H.jsx)("div",{className:"text-2xl font-bold text-gray-900 mb-0.5",children:e.value}),(0,H.jsx)("div",{className:"text-xs text-gray-500 font-medium",children:e.label})]},t))}),(0,H.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[(0,H.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:a("quick_actions")}),(0,H.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3",children:oe.map((e,t)=>(0,H.jsxs)("button",{onClick:()=>F(e.path),className:"flex flex-col items-center gap-2.5 p-4 ".concat(e.lightBg," rounded-xl hover:shadow-md hover:-translate-y-0.5 transition-all duration-200 border border-transparent hover:border-gray-200"),children:[(0,H.jsx)("div",{className:"w-10 h-10 ".concat(e.color," rounded-xl flex items-center justify-center shadow-sm"),children:(0,H.jsx)(e.icon,{className:"w-5 h-5 text-white"})}),(0,H.jsx)("span",{className:"text-xs font-semibold ".concat(e.textColor),children:e.label})]},t))})]}),V.length>0&&("director"===(null===L||void 0===L?void 0:L.role)||"principal"===(null===L||void 0===L?void 0:L.role))&&(0,H.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-amber-200 p-6",children:[(0,H.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,H.jsxs)("div",{className:"flex items-center gap-3",children:[(0,H.jsx)("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:(0,H.jsx)(b.A,{className:"w-5 h-5 text-amber-600"})}),(0,H.jsxs)("div",{children:[(0,H.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:a("teacher_requests_pending")}),(0,H.jsxs)("p",{className:"text-xs text-gray-500",children:[V.length," ",a("requests_waiting_action")]})]})]})}),(0,H.jsx)("div",{className:"space-y-3",children:V.slice(0,5).map(e=>{var t;return(0,H.jsxs)("div",{className:"flex items-center justify-between p-4 bg-amber-50 rounded-xl border border-amber-100",children:[(0,H.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,H.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,H.jsx)("span",{className:"text-sm font-bold text-gray-800",children:e.title}),(0,H.jsx)("span",{className:"inline-flex px-2 py-0.5 rounded-full text-[10px] font-medium bg-blue-100 text-blue-700 capitalize",children:e.request_type})]}),(0,H.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:[e.teacher_name," - ",null===(t=e.description)||void 0===t?void 0:t.slice(0,80)]}),(0,H.jsx)("p",{className:"text-[10px] text-gray-400 mt-1",children:new Date(e.created_at).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,H.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,H.jsx)("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("token");await r.A.put("".concat(O,"/admin/teacher-requests/").concat(e),{action:"approved",note:"Approved by admin"},{headers:{Authorization:"Bearer ".concat(t)}}),W(t=>t.filter(t=>t.id!==e)),Y(e=>Math.max(0,e-1))}catch(t){console.error("Approve failed:",t)}})(e.id),className:"px-4 py-2 bg-green-500 text-white text-xs font-medium rounded-lg hover:bg-green-600 transition-colors",children:a("approve")}),(0,H.jsx)("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("token");await r.A.put("".concat(O,"/admin/teacher-requests/").concat(e),{action:"rejected",note:"Rejected by admin"},{headers:{Authorization:"Bearer ".concat(t)}}),W(t=>t.filter(t=>t.id!==e)),Y(e=>Math.max(0,e-1))}catch(t){console.error("Reject failed:",t)}})(e.id),className:"px-4 py-2 bg-red-500 text-white text-xs font-medium rounded-lg hover:bg-red-600 transition-colors",children:a("reject")})]})]},e.id)})})]}),(0,H.jsxs)("div",{children:[(0,H.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,H.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:a("all_modules")}),(0,H.jsx)("span",{className:"text-xs text-gray-400 font-medium",children:ce.length})]}),(0,H.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-5 gap-4",children:ce.map((e,t)=>(0,H.jsxs)("button",{onClick:()=>F(e.path),className:"flex flex-col items-center gap-3 p-5 bg-white rounded-xl border border-gray-100 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-200 group",children:[(0,H.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br ".concat(e.gradient," rounded-xl flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform duration-200"),children:(0,H.jsx)(e.icon,{className:"w-6 h-6 text-white"})}),(0,H.jsxs)("div",{className:"text-center",children:[(0,H.jsx)("span",{className:"text-xs font-semibold text-gray-800 block",children:e.label}),(0,H.jsx)("span",{className:"text-[10px] text-gray-400",children:e.desc})]})]},t))})]}),(0,H.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl p-6 text-white",children:(0,H.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,H.jsxs)("div",{children:[(0,H.jsx)("h3",{className:"text-lg font-bold mb-1",children:a("need_help_setup")}),(0,H.jsx)("p",{className:"text-white/70 text-sm",children:a("setup_wizard_desc")})]}),(0,H.jsxs)("button",{onClick:()=>F("/app/setup-wizard"),className:"inline-flex items-center gap-2 px-6 py-3 bg-white text-blue-600 rounded-xl font-semibold text-sm hover:bg-blue-50 transition-all shadow-lg",children:[(0,H.jsx)(D.A,{className:"w-4 h-4"}),a("setup_wizard"),(0,H.jsx)(E.A,{className:"w-4 h-4"})]})]})})]})}},7010(e,t,a){a.d(t,{A:()=>s});const s=(0,a(7784).A)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]])},1527(e,t,a){a.d(t,{A:()=>s});const s=(0,a(7784).A)("indian-rupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]])},2024(e,t,a){a.d(t,{A:()=>s});const s=(0,a(7784).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6873(e,t,a){a.d(t,{A:()=>s});const s=(0,a(7784).A)("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},1884(e,t,a){a.d(t,{A:()=>s});const s=(0,a(7784).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},6401(e,t,a){a.d(t,{A:()=>s});const s=(0,a(7784).A)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]])}}]);
//# sourceMappingURL=28.9ab54dbc.chunk.js.map