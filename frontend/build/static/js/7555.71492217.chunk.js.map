{"version":3,"file":"static/js/7555.71492217.chunk.js","mappings":"2OAMMA,GAAiBC,EAAAA,EAAAA,GACrB,wSACA,CACEC,SAAU,CACRC,QAAS,CACPC,QACE,gEACFC,YACE,+EACFC,QACE,sFACFC,UACE,yEACFC,MAAO,+CACPC,KAAM,mDAERC,KAAM,CACJN,QAAS,gBACTO,GAAI,8BACJC,GAAI,uBACJC,KAAM,YAGVC,gBAAiB,CACfX,QAAS,UACTO,KAAM,aAKNK,EAASC,EAAAA,WAAiB,CAAAC,EAA0DC,KAAS,IAAlE,UAAEC,EAAS,QAAEhB,EAAO,KAAEO,EAAI,QAAEU,GAAU,GAAiBH,EAAPI,GAAKC,EAAAA,EAAAA,GAAAL,EAAAM,GACpF,MAAMC,EAAOJ,EAAUK,EAAAA,GAAO,SAC9B,OACEC,EAAAA,EAAAA,KAACF,GAAIG,EAAAA,EAAAA,GAAA,CACHR,WAAWS,EAAAA,EAAAA,IAAG5B,EAAe,CAAEG,UAASO,OAAMS,eAC9CD,IAAKA,GACDG,MAGVN,EAAOc,YAAc,Q,+NCzCfC,EAAOd,EAAAA,WAAiB,CAAAC,EAA0BC,KAAG,IAA5B,UAAEC,GAAqBF,EAAPI,GAAKC,EAAAA,EAAAA,GAAAL,EAAAM,GAAA,OAClDG,EAAAA,EAAAA,KAAA,OAAAC,EAAAA,EAAAA,GAAA,CACET,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IAAG,qEAAsET,IAChFE,MAERS,EAAKD,YAAc,OAEnB,MAAME,EAAaf,EAAAA,WAAiB,CAAAgB,EAA0Bd,KAAG,IAA5B,UAAEC,GAAqBa,EAAPX,GAAKC,EAAAA,EAAAA,GAAAU,EAAAC,GAAA,OACxDP,EAAAA,EAAAA,KAAA,OAAAC,EAAAA,EAAAA,GAAA,CACET,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IAAG,gCAAiCT,IAC3CE,MAERU,EAAWF,YAAc,aAEzB,MAAMK,EAAYlB,EAAAA,WAAiB,CAAAmB,EAA0BjB,KAAG,IAA5B,UAAEC,GAAqBgB,EAAPd,GAAKC,EAAAA,EAAAA,GAAAa,EAAAC,GAAA,OACvDV,EAAAA,EAAAA,KAAA,OAAAC,EAAAA,EAAAA,GAAA,CACET,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IAAG,4CAA6CT,IACvDE,MAERa,EAAUL,YAAc,YAExB,MAAMQ,EAAkBrB,EAAAA,WAAiB,CAAAsB,EAA0BpB,KAAG,IAA5B,UAAEC,GAAqBmB,EAAPjB,GAAKC,EAAAA,EAAAA,GAAAgB,EAAAC,GAAA,OAC7Db,EAAAA,EAAAA,KAAA,OAAAC,EAAAA,EAAAA,GAAA,CACET,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IAAG,gCAAiCT,IAC3CE,MAERgB,EAAgBR,YAAc,kBAE9B,MAAMW,EAAcxB,EAAAA,WAAiB,CAAAyB,EAA0BvB,KAAG,IAA5B,UAAEC,GAAqBsB,EAAPpB,GAAKC,EAAAA,EAAAA,GAAAmB,EAAAC,GAAA,OACzDhB,EAAAA,EAAAA,KAAA,OAAAC,EAAAA,EAAAA,GAAA,CAAKT,IAAKA,EAAKC,WAAWS,EAAAA,EAAAA,IAAG,WAAYT,IAAgBE,MAE3DmB,EAAYX,YAAc,cAEPb,EAAAA,WAAiB,CAAA2B,EAA0BzB,KAAG,IAA5B,UAAEC,GAAqBwB,EAAPtB,GAAKC,EAAAA,EAAAA,GAAAqB,EAAAC,GAAA,OACxDlB,EAAAA,EAAAA,KAAA,OAAAC,EAAAA,EAAAA,GAAA,CACET,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IAAG,6BAA8BT,IACxCE,MAEGQ,YAAc,Y,sPCzCnBgB,EAASC,EAAAA,GAETC,EAAgBD,EAAAA,GAEhBE,EAAeF,EAAAA,GAIfG,GAFcH,EAAAA,GAEE9B,EAAAA,WAAiB,CAAAC,EAA0BC,KAAG,IAA5B,UAAEC,GAAqBF,EAAPI,GAAKC,EAAAA,EAAAA,GAAAL,EAAAM,GAAA,OAC3DG,EAAAA,EAAAA,KAACoB,EAAAA,IAAuBnB,EAAAA,EAAAA,GAAA,CACtBT,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IACT,0JACAT,IAEEE,OAER4B,EAAcpB,YAAciB,EAAAA,GAAwBjB,YAEpD,MAAMqB,EAAgBlC,EAAAA,WAAiB,CAAAgB,EAAoCd,KAAG,IAAtC,UAAEC,EAAS,SAAEgC,GAAoBnB,EAAPX,GAAKC,EAAAA,EAAAA,GAAAU,EAAAC,GAAA,OACrEmB,EAAAA,EAAAA,MAACJ,EAAY,CAAAG,SAAA,EACXzB,EAAAA,EAAAA,KAACuB,EAAa,KACdG,EAAAA,EAAAA,MAACN,EAAAA,IAAuBnB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CACtBT,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IACT,8fACAT,IAEEE,GAAK,IAAA8B,SAAA,CACRA,GACDC,EAAAA,EAAAA,MAACN,EAAAA,GAAqB,CACpB3B,UAAU,gRAA+QgC,SAAA,EACzRzB,EAAAA,EAAAA,KAAC2B,EAAAA,EAAC,CAAClC,UAAU,aACbO,EAAAA,EAAAA,KAAA,QAAMP,UAAU,UAASgC,SAAC,sBAKlCD,EAAcrB,YAAciB,EAAAA,GAAwBjB,YAEpD,MAAMyB,EAAenB,IAAA,IAAC,UACpBhB,GAEDgB,EADId,GAAKC,EAAAA,EAAAA,GAAAa,EAAAC,GAAA,OAERV,EAAAA,EAAAA,KAAA,OAAAC,EAAAA,EAAAA,GAAA,CACER,WAAWS,EAAAA,EAAAA,IAAG,qDAAsDT,IAChEE,KAERiC,EAAazB,YAAc,eAE3B,MAUM0B,EAAcvC,EAAAA,WAAiB,CAAAyB,EAA0BvB,KAAG,IAA5B,UAAEC,GAAqBsB,EAAPpB,GAAKC,EAAAA,EAAAA,GAAAmB,EAAAC,GAAA,OACzDhB,EAAAA,EAAAA,KAACoB,EAAAA,IAAqBnB,EAAAA,EAAAA,GAAA,CACpBT,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IAAG,oDAAqDT,IAC/DE,MAERkC,EAAY1B,YAAciB,EAAAA,GAAsBjB,YAEhD,MAAM2B,EAAoBxC,EAAAA,WAAiB,CAAA2B,EAA0BzB,KAAG,IAA5B,UAAEC,GAAqBwB,EAAPtB,GAAKC,EAAAA,EAAAA,GAAAqB,EAAAC,GAAA,OAC/DlB,EAAAA,EAAAA,KAACoB,EAAAA,IAA2BnB,EAAAA,EAAAA,GAAA,CAC1BT,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IAAG,gCAAiCT,IAC3CE,MAERmC,EAAkB3B,YAAciB,EAAAA,GAA4BjB,W,iHC5EtD4B,EAAQzC,EAAAA,WAAiB,CAAAC,EAAgCC,KAAS,IAAxC,UAAEC,EAAS,KAAEuC,GAAgBzC,EAAPI,GAAKC,EAAAA,EAAAA,GAAAL,EAAAM,GACzD,OACEG,EAAAA,EAAAA,KAAA,SAAAC,EAAAA,EAAAA,GAAA,CACE+B,KAAMA,EACNvC,WAAWS,EAAAA,EAAAA,IACT,kXACAT,GAEFD,IAAKA,GACDG,MAGVoC,EAAM5B,YAAc,O,6HCVd8B,GAAgB1D,EAAAA,EAAAA,GACpB,8FAGI2D,EAAQ5C,EAAAA,WAAiB,CAAAC,EAA0BC,KAAG,IAA5B,UAAEC,GAAqBF,EAAPI,GAAKC,EAAAA,EAAAA,GAAAL,EAAAM,GAAA,OACnDG,EAAAA,EAAAA,KAACmC,EAAAA,GAAmBlC,EAAAA,EAAAA,GAAA,CAACT,IAAKA,EAAKC,WAAWS,EAAAA,EAAAA,IAAG+B,IAAiBxC,IAAgBE,MAEhFuC,EAAM/B,YAAcgC,EAAAA,EAAoBhC,W,gLCRlCiC,EAAOC,EAAAA,GAEPC,EAAWhD,EAAAA,WAAiB,CAAAC,EAA0BC,KAAG,IAA5B,UAAEC,GAAqBF,EAAPI,GAAKC,EAAAA,EAAAA,GAAAL,EAAAM,GAAA,OACtDG,EAAAA,EAAAA,KAACqC,EAAAA,IAAkBpC,EAAAA,EAAAA,GAAA,CACjBT,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IACT,sHACAT,IAEEE,MAER2C,EAASnC,YAAckC,EAAAA,GAAmBlC,YAE1C,MAAMoC,EAAcjD,EAAAA,WAAiB,CAAAgB,EAA0Bd,KAAG,IAA5B,UAAEC,GAAqBa,EAAPX,GAAKC,EAAAA,EAAAA,GAAAU,EAAAC,GAAA,OACzDP,EAAAA,EAAAA,KAACqC,EAAAA,IAAqBpC,EAAAA,EAAAA,GAAA,CACpBT,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IACT,gYACAT,IAEEE,MAER4C,EAAYpC,YAAckC,EAAAA,GAAsBlC,YAEhD,MAAMqC,EAAclD,EAAAA,WAAiB,CAAAmB,EAA0BjB,KAAG,IAA5B,UAAEC,GAAqBgB,EAAPd,GAAKC,EAAAA,EAAAA,GAAAa,EAAAC,GAAA,OACzDV,EAAAA,EAAAA,KAACqC,EAAAA,IAAqBpC,EAAAA,EAAAA,GAAA,CACpBT,IAAKA,EACLC,WAAWS,EAAAA,EAAAA,IACT,kIACAT,IAEEE,MAER6C,EAAYrC,YAAckC,EAAAA,GAAsBlC,W,wDCnCzC,SAASD,IAAe,IAAD,IAAAuC,EAAAC,UAAAC,OAARC,EAAM,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAANF,EAAME,GAAAJ,UAAAI,GAC1B,OAAOC,EAAAA,EAAAA,KAAQC,EAAAA,EAAAA,GAAKJ,GACtB,C,yVCYA,MAAMK,EAAG,GAAAC,OAA4C,GAAE,QAEjDC,EAAO,CAAC,SAAU,UAAW,YAAa,WAAY,SAAU,YAChEC,EAAU,CAAC,uCAAU,6CAAW,uCAAU,6CAAW,mDAAY,wCAEjEC,EAAiB,CACrB,MAAS,kDACT,QAAW,4CACX,YAAe,+CACf,QAAW,kDACX,iBAAkB,kDAClB,SAAY,4CACZ,qBAAsB,yCACtB,QAAW,4CACX,MAAS,kDACT,GAAM,4CACN,gBAAiB,+CACjB,SAAY,4CACZ,QAAW,gDAGPC,EAAmB,CACvBC,uBAAwB,GACxBC,wBAAyB,GACzBC,kBAAmB,QACnBC,eAAgB,GAChBC,eAAgB,GAChBC,mBAAoB,EACpBC,mBAAoB,EACpBC,gBAAiB,EACjBC,aAAc,CAAC,SAAU,UAAW,YAAa,WAAY,SAAU,aAGnEC,EAAmBC,GAAgBZ,EAAeY,IAAgBZ,EAAe3E,QA4CxE,SAASwF,IAAuB,IAADC,EAC5C,MAAM,EAAEC,IAAMC,EAAAA,EAAAA,OACR,SAAEC,EAAQ,KAAEC,IAASC,EAAAA,EAAAA,OAEpBC,EAASC,IAAcC,EAAAA,EAAAA,UAAS,KAChCC,EAAUC,IAAeF,EAAAA,EAAAA,UAAS,KAClCG,EAAUC,IAAeJ,EAAAA,EAAAA,UAAS,KAClCK,EAAYC,IAAiBN,EAAAA,EAAAA,UAAS,CAAC,IACvCO,EAAUC,IAAeR,EAAAA,EAAAA,UAASrB,IAClC8B,EAAeC,IAAoBV,EAAAA,EAAAA,UAAS,KAC5CW,EAAoBC,IAAyBZ,EAAAA,EAAAA,UAAS,KAEtDa,GAASC,KAAcd,EAAAA,EAAAA,WAAS,IAChCe,GAAQC,KAAahB,EAAAA,EAAAA,WAAS,IAC9BiB,GAAYC,KAAiBlB,EAAAA,EAAAA,WAAS,IACtCmB,GAAWC,KAAgBpB,EAAAA,EAAAA,UAAS,UACpCqB,GAAeC,KAAoBtB,EAAAA,EAAAA,UAAS,OAC5CuB,GAAiBC,KAAsBxB,EAAAA,EAAAA,UAAS,OAChDyB,GAASC,KAAc1B,EAAAA,EAAAA,WAAS,IAAI2B,MAAOC,cAAcC,MAAM,KAAK,KAEpEC,GAAgBC,KAAqB/B,EAAAA,EAAAA,WAAS,IAC9CgC,GAAkBC,KAAuBjC,EAAAA,EAAAA,WAAS,IAClDkC,GAAeC,KAAoBnC,EAAAA,EAAAA,WAAS,IAC5CoC,GAAyBC,KAA8BrC,EAAAA,EAAAA,WAAS,IAChEsC,GAAoBC,KAAyBvC,EAAAA,EAAAA,UAAS,KACtDwC,GAAiBC,KAAsBzC,EAAAA,EAAAA,UAAS,KAChD0C,GAAUC,KAAe3C,EAAAA,EAAAA,UAAS,CAAE4C,IAAK,GAAIC,OAAQ,GAAIC,WAAY,GAAIC,WAAY,GAAIC,KAAM,MAC/FC,GAASC,KAAclD,EAAAA,EAAAA,UAAS,CAAEmD,SAAU,GAAIC,UAAW,GAAIC,oBAAqB,GAAIC,sBAAuB,GAAIC,OAAQ,GAAIC,aAAa,IAE7IC,GAAQC,aAAaC,QAAQ,SAC7BC,GAAU,CAAEC,cAAc,UAADtF,OAAYkF,KAErCK,GA1EmBvD,KACzB,MAAMwD,GAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQqD,GAAqB4B,GAC9ByD,EAAQ,GACd,IAAKC,EAAGC,GAAKH,EAAEjF,kBAAkB+C,MAAM,KAAKsC,IAAIC,QAC5CC,EAAY,EAEhB,IAAK,IAAIC,EAAI,EAAGA,EAAIP,EAAE5E,gBAAiBmF,IAAK,CAC1C,GAAID,EAAY,IAAMN,EAAE9E,mBAAoB,CAC1C,MAAMsF,EAAOL,EAAIH,EAAEhF,eACbyF,EAAOP,EAAIQ,KAAKC,MAAMH,EAAO,IACnCP,EAAMW,KAAK,CACTC,GAAG,SAADrG,OAAW8F,GAAaQ,MAAO,yCAAiBC,SAAS,EAC3DC,MAAM,GAADxG,OAAKyG,OAAOf,GAAGgB,SAAS,EAAE,KAAI,KAAA1G,OAAIyG,OAAOd,GAAGe,SAAS,EAAE,MAC5DC,IAAI,GAAD3G,OAAKyG,OAAOR,GAAMS,SAAS,EAAE,KAAI,KAAA1G,OAAIyG,OAAOT,EAAO,IAAIU,SAAS,EAAE,QAEvEhB,EAAIO,EAAMN,EAAIK,EAAO,EACvB,CACA,GAAIF,EAAY,IAAMN,EAAE7E,mBAAoB,CAC1C,MAAMqF,EAAOL,EAAIH,EAAE/E,eACbwF,EAAOP,EAAIQ,KAAKC,MAAMH,EAAO,IACnCP,EAAMW,KAAK,CACTC,GAAG,SAADrG,OAAW8F,GAAaQ,MAAO,mCAAgBC,SAAS,EAC1DC,MAAM,GAADxG,OAAKyG,OAAOf,GAAGgB,SAAS,EAAE,KAAI,KAAA1G,OAAIyG,OAAOd,GAAGe,SAAS,EAAE,MAC5DC,IAAI,GAAD3G,OAAKyG,OAAOR,GAAMS,SAAS,EAAE,KAAI,KAAA1G,OAAIyG,OAAOT,EAAO,IAAIU,SAAS,EAAE,QAEvEhB,EAAIO,EAAMN,EAAIK,EAAO,EACvB,CAEA,MACMA,EAAOL,GADa,IAAdG,EAAkBN,EAAEnF,uBAAyBmF,EAAElF,wBAA0BkF,EAAEnF,wBAEjF4F,EAAOP,EAAIQ,KAAKC,MAAMH,EAAO,IACnCP,EAAMW,KAAK,CACTC,GAAIP,EAAWQ,MAAM,UAADtG,OAAY8F,GAAaS,SAAS,EACtDC,MAAM,GAADxG,OAAKyG,OAAOf,GAAGgB,SAAS,EAAE,KAAI,KAAA1G,OAAIyG,OAAOd,GAAGe,SAAS,EAAE,MAC5DC,IAAI,GAAD3G,OAAKyG,OAAOR,GAAMS,SAAS,EAAE,KAAI,KAAA1G,OAAIyG,OAAOT,EAAO,IAAIU,SAAS,EAAE,QAEvEhB,EAAIO,EAAMN,EAAIK,EAAO,GACrBF,GACF,CACA,OAAOL,GAmCWmB,CAAkB5E,GAC9B6E,GAAUtB,GAAUuB,OAAOtB,IAAMA,EAAEe,SACnCQ,GAAc/E,EAASnB,cAAgBZ,EAEvC+G,IAAeC,EAAAA,EAAAA,aAAYC,UAC/B,GAAK9F,EAAL,CACAmB,IAAW,GACX,IAAK,IAAD4E,EACF,MAAOC,EAAUC,EAAUC,EAAYC,EAAOC,EAAaC,SAAkBC,QAAQC,IAAI,CACvFC,EAAAA,EAAMC,IAAI,GAAD7H,OAAID,EAAG,uBAAAC,OAAsBoB,GAAY,CAAEiE,aAAWyC,MAAM,MAASC,KAAM,MACpFH,EAAAA,EAAMC,IAAI,GAAD7H,OAAID,EAAG,qBAAAC,OAAoBoB,GAAY,CAAEiE,aAAWyC,MAAM,MAASC,KAAM,MAClFH,EAAAA,EAAMC,IAAI,GAAD7H,OAAID,EAAG,wBAAAC,OAAuBoB,GAAY,CAAEiE,aAAWyC,MAAM,MAASC,KAAM,MACrFH,EAAAA,EAAMC,IAAI,GAAD7H,OAAID,EAAG,0BAAAC,OAAyBoB,GAAY,CAAEiE,aAAWyC,MAAM,MAASC,KAAM,CAAC,KACxFH,EAAAA,EAAMC,IAAI,GAAD7H,OAAID,EAAG,kCAAAC,OAAiCoB,GAAY,CAAEiE,aAAWyC,MAAM,MAASC,KAAM,QAC/FH,EAAAA,EAAMC,IAAI,GAAD7H,OAAID,EAAG,mCAAAC,OAAkCoB,GAAY,CAAEiE,aAAWyC,MAAM,MAASC,KAAM,QAG5FC,EAAMZ,EAASW,MAAQ,GAC7BvG,EAAWwG,GACXrG,GAAa0F,EAASU,MAAQ,IAAIjB,OAAO5F,IAAC,IAAA+G,EAAA,MAAe,YAAX/G,EAAEgH,OAAmC,QAAjBD,EAAI/G,EAAEiH,mBAAW,IAAAF,OAAA,EAAbA,EAAeG,cAAcC,SAAS,eAE5G,MAAMC,EAAkB,CACtB,CAAEjC,GAAI,QAASkC,KAAM,QAASC,QAAS,kCACvC,CAAEnC,GAAI,UAAWkC,KAAM,UAAWC,QAAS,oDAC3C,CAAEnC,GAAI,OAAQkC,KAAM,cAAeC,QAAS,4BAC5C,CAAEnC,GAAI,UAAWkC,KAAM,UAAWC,QAAS,8CAC3C,CAAEnC,GAAI,MAAOkC,KAAM,iBAAkBC,QAAS,yFAC9C,CAAEnC,GAAI,WAAYkC,KAAM,WAAYC,QAAS,oDAC7C,CAAEnC,GAAI,KAAMkC,KAAM,qBAAsBC,QAAS,mFACjD,CAAEnC,GAAI,UAAWkC,KAAM,UAAWC,QAAS,oDAC3C,CAAEnC,GAAI,QAASkC,KAAM,QAASC,QAAS,kCACvC,CAAEnC,GAAI,KAAMkC,KAAM,KAAMC,QAAS,6EACjC,CAAEnC,GAAI,QAASkC,KAAM,gBAAiBC,QAAS,uEAC/C,CAAEnC,GAAI,WAAYkC,KAAM,WAAYC,QAAS,+CAE/C3G,GAA2B,QAAfsF,EAAAG,EAAWS,YAAI,IAAAZ,OAAA,EAAfA,EAAiB1H,QAAS,EAAI6H,EAAWS,KAAOO,GAC5DvG,EAAcwF,EAAMQ,MAAQ,CAAC,GACzBP,EAAYO,MAAQU,OAAOC,KAAKlB,EAAYO,MAAMtI,OAAS,GAC7DwC,EAAY0G,IAAI5L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAU4L,GAASnB,EAAYO,OAEjD1F,EAAsBoF,EAASM,MAAQ,IACnCC,EAAIvI,OAAS,IAAMqD,IAAeC,GAAiBiF,EAAI,GAC7D,CAAE,MAAOY,GACPC,QAAQD,MAAM,uBAAwBA,GACtCE,EAAAA,GAAMF,MAAM,sBACd,CAAC,QACCrG,IAAW,EACb,CA1CqB,GA2CpB,CAACnB,IAEE2H,IAAqB9B,EAAAA,EAAAA,aAAYC,UACrC,GAAK9F,EACL,IACE,MAAM4H,QAAYpB,EAAAA,EAAMC,IAAI,GAAD7H,OAAID,EAAG,6BAAAC,OAA4BoB,EAAQ,UAAApB,OAASkD,IAAW,CAAEmC,aAAWyC,MAAM,MAASC,KAAM,MAC5H5F,EAAiB6G,EAAIjB,MAAQ,GAC/B,CAAE,MAAAkB,GAAQ9G,EAAiB,GAAK,GAC/B,CAACf,EAAU8B,MAEdgG,EAAAA,EAAAA,WAAU,KAAQlC,MAAmB,CAACA,MACtCkC,EAAAA,EAAAA,WAAU,KAAQH,MAAyB,CAACA,KAE5C,MAAMI,GAAuBC,IAC3B,IAAKA,EAAU,OAAO,KACtB,MAAMC,EAAOD,EAASE,kBAAoBF,EAASG,eACnD,GAAIF,EAAM,CACR,MAAMG,EAAU9H,EAAS+H,KAAKvI,GAAKA,EAAEmF,KAAOgD,GAAQnI,EAAEwI,MAAQL,GAC9D,GAAIG,EAAS,CACX,MAAMG,EAAQvH,EAAmBqH,KAAKG,IACnCA,EAAEpF,aAAegF,EAAQnD,IAAMuD,EAAEpF,aAAegF,EAAQE,OACxDE,EAAEhF,WAAawE,EAAS/C,IAAMuD,EAAEhF,WAAawE,EAASM,MAEzD,MAAO,CAAEF,UAASzI,aAAkB,OAAL4I,QAAK,IAALA,OAAK,EAALA,EAAOE,eAAgBL,EAAQM,SAAW,KAAMC,WAAgB,OAALJ,QAAK,IAALA,OAAK,EAALA,EAAOpF,aAAc,KACjH,CACF,CACA,GAAI6E,EAASY,cAAe,CAC1B,MAAMR,EAAU9H,EAAS+H,KAAKvI,GAAKA,EAAEqH,OAASa,EAASY,eACvD,GAAIR,EAAS,MAAO,CAAEA,UAASzI,YAAayI,EAAQM,SAAW,KAAMC,UAAW,KAClF,CACA,OAAO,MAGHE,GAAgBA,CAACC,EAAW7F,EAAK8F,KACrC,IAAK,MAAOC,EAASC,KAAY5B,OAAO6B,QAAQxI,GAAa,CAAC,IAADyI,EAAAC,EAC8BC,EAAzF,IAAgB,QAAZF,EAAAF,EAAQhG,UAAI,IAAAkG,GAAY,QAAZC,EAAZD,EAAeJ,UAAS,IAAAK,OAAZ,EAAZA,EAA0BhG,cAAe0F,IAA0B,OAAbpH,SAAa,IAAbA,QAAa,EAAbA,GAAeuD,MAAO+D,EAC9E,OAA0C,QAAnCK,EAAAlJ,EAAQkI,KAAKiB,GAAKA,EAAErE,KAAO+D,UAAQ,IAAAK,OAAA,EAAnCA,EAAqClC,OAAQ,eAExD,CACA,OAAO,MAgOT,IAAKnH,EAAU,OAAOtE,EAAAA,EAAAA,KAAA,OAAKP,UAAU,oBAAmBgC,UAACzB,EAAAA,EAAAA,KAAA,KAAGP,UAAU,iBAAgBgC,SAAE2C,EAAE,oBAE1F,MAAMmJ,GAAUvI,EAAwB,OAAbgB,SAAa,IAAbA,QAAa,EAAbA,GAAeuD,KAAO,CAAC,EAC5CsE,GAAe7H,GAAgBqG,GAAoBrG,IAAiB,KAE1E,OACEtE,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,YAAY,cAAY,uBAAsBgC,SAAA,EAC3DC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,oDAAmDgC,SAAA,EAChEC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEC,EAAAA,EAAAA,MAAA,MAAIjC,UAAU,yEAAwEgC,SAAA,EACpFzB,EAAAA,EAAAA,KAAC8N,EAAAA,EAAK,CAACrO,UAAU,4BAChB2E,EAAE,iBAELpE,EAAAA,EAAAA,KAAA,KAAGP,UAAU,sBAAqBgC,SAAE2C,EAAE,wBAExCpE,EAAAA,EAAAA,KAAA,OAAKP,UAAU,aAAYgC,SACV,UAAdqE,KACCpE,EAAAA,EAAAA,MAAAqM,EAAAA,SAAA,CAAAtM,SAAA,EACEC,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAAC2O,QA1HY5D,UAC9B,GAAKpE,GAAL,CACAH,IAAc,GACd,IACE,IAAK,IAADoI,EACF,MAAM/B,QAAYpB,EAAAA,EAAMoD,KAAK,GAADhL,OAAID,EAAG,uBAAuB,CAAEkL,UAAW7J,EAAUwD,SAAU9B,GAAcuD,IAAMvD,GAAc4G,KAAO,CAAErE,aACtI,GAAY,QAAZ0F,EAAI/B,EAAIjB,YAAI,IAAAgD,GAARA,EAAUG,UAIZ,OAHAnJ,EAAc4G,IAAI5L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAU4L,GAAI,IAAE,CAAC7F,GAAcuD,IAAMvD,GAAc4G,KAAMV,EAAIjB,KAAKmD,aACpFpC,EAAAA,GAAMqC,QAAQ,6BACdxI,IAAc,EAGlB,CAAE,MAAAyI,GAA+B,CAEjC,MAAMhB,EAAUtH,GAAcuD,IAAMvD,GAAc4G,IAC5C2B,EAAKlC,GAAoBrG,IACzBwI,EAAQ1J,EAASkF,OAAOtB,GAAKA,EAAEa,IAAMb,EAAE+C,MACvCgD,EAAQ,CAAC,EAEfxE,GAAYyE,QAAQnH,IAClBkH,EAAMlH,GAAO,CAAC,EACd,MAAMoH,EAAW,IAAIH,GAAOI,KAAK,IAAMxF,KAAKyF,SAAW,IACvD,IAAIC,EAAK,EAET/E,GAAQ2E,QAASlH,IACf,GAAkB,IAAdA,EAAO+B,IAAc,OAAFgF,QAAE,IAAFA,GAAAA,EAAI7B,QAEzB,YADA+B,EAAMlH,GAAK,GAAK,CAAEE,WAAY,WAAYsF,aAAc,WAAYrF,WAAY6G,EAAG7B,QAAQnD,IAAMgF,EAAG7B,QAAQE,IAAKmC,aAAcR,EAAG7B,QAAQjB,KAAM9D,KAAM,GAAIQ,aAAa,IAGzK,MAAM6G,EAAML,EAASG,EAAKH,EAAShM,QACnCmM,IACA,MAAMpC,EAAU9H,EAAS+H,KAAKvI,GACrBkB,EAAmBqH,KAAKG,IAAMA,EAAEpF,aAAetD,EAAEmF,IAAMuD,EAAEpF,aAAetD,EAAEwI,MAASE,EAAEhF,WAAawF,IAAaR,EAAEC,gBAAoB,OAAHiC,QAAG,IAAHA,OAAG,EAAHA,EAAKvD,OAAQqB,EAAErF,cAAkB,OAAHuH,QAAG,IAAHA,OAAG,EAAHA,EAAKzF,QACxK3E,EAASwE,KAAKC,MAAMD,KAAKyF,UAAYjK,EAASjC,QAAU,MAAQ,KAElEqM,IACFP,EAAMlH,GAAKC,EAAO+B,IAAM,CAAE9B,WAAYuH,EAAIzF,GAAIwD,aAAciC,EAAIvD,KAAM/D,YAAmB,OAAPgF,QAAO,IAAPA,OAAO,EAAPA,EAASnD,KAAM,GAAIwF,cAAqB,OAAPrC,QAAO,IAAPA,OAAO,EAAPA,EAASjB,OAAQ,GAAI9D,KAAM,SAKpJ1C,EAAc4G,IAAI5L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAU4L,GAAI,IAAE,CAACyB,GAAUmB,KAC7C,UAAY3D,EAAAA,EAAMoD,KAAK,GAADhL,OAAID,EAAG,oBAAoB,CAAEkL,UAAW7J,EAAUwD,SAAUwF,EAASc,UAAWK,GAAS,CAAElG,YAAY,CAAE,MAAA0G,GAAO,CACtIjD,EAAAA,GAAMqC,QAAU,OAAFE,QAAE,IAAFA,GAAAA,EAAItK,YAAW,gDAAqD,uBACpF,CAAE,MAAAiL,GAAQlD,EAAAA,GAAMF,MAAM,qBAAuB,CAAC,QACpCjG,IAAc,EAAQ,CA5CmC,MAA7CmG,EAAAA,GAAMF,MAAM,yBAyHkBqD,SAAUvJ,KAAeI,GAAevG,UAAU,0CAAyCgC,SAAA,CAClImE,IAAa5F,EAAAA,EAAAA,KAACoP,EAAAA,EAAO,CAAC3P,UAAU,0BAA4BO,EAAAA,EAAAA,KAACqP,EAAAA,EAAQ,CAAC5P,UAAU,YACnE2E,EAAbwB,GAAe,UAAe,wBAEjClE,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAACZ,QAAQ,UAAUuP,QAxClBsB,KAClB,MAAMC,EAAKC,SAASC,eAAe,kBACnC,IAAKF,EAAI,OACT,MAAMG,EAAIC,OAAOC,KAAK,GAAI,UAC1BF,EAAEF,SAASK,MAAM,4bAAD3M,OAOM,UAAd4C,GAAqC,OAAbE,SAAa,IAAbA,QAAa,EAAbA,GAAeyF,KAAsB,OAAfvF,SAAe,IAAfA,QAAe,EAAfA,GAAiBuF,KAAI,6BAAAvI,OACvEqM,EAAGO,UAAS,oFAGhBJ,EAAEF,SAASO,SAyB+CtQ,UAAU,QAAOgC,SAAA,EAC/DzB,EAAAA,EAAAA,KAACgQ,EAAAA,EAAO,CAACvQ,UAAU,YAAY,IAAE2E,EAAE,qBAO7C1C,EAAAA,EAAAA,MAACU,EAAAA,GAAI,CAAC6N,MAAOnK,GAAWoK,cAAenK,GAActG,UAAU,SAAQgC,SAAA,EACrEC,EAAAA,EAAAA,MAACY,EAAAA,GAAQ,CAAC7C,UAAU,oCAAmCgC,SAAA,EACrDC,EAAAA,EAAAA,MAACa,EAAAA,GAAW,CAAC0N,MAAM,QAAQxQ,UAAU,UAASgC,SAAA,EAC5CzB,EAAAA,EAAAA,KAACmQ,EAAAA,EAAa,CAAC1Q,UAAU,YAAY,IAAE2E,EAAE,iBAE3C1C,EAAAA,EAAAA,MAACa,EAAAA,GAAW,CAAC0N,MAAM,UAAUxQ,UAAU,UAASgC,SAAA,EAC9CzB,EAAAA,EAAAA,KAACoQ,EAAAA,EAAI,CAAC3Q,UAAU,YAAY,IAAE2E,EAAE,eAElC1C,EAAAA,EAAAA,MAACa,EAAAA,GAAW,CAAC0N,MAAM,gBAAgBxQ,UAAU,UAASgC,SAAA,EACpDzB,EAAAA,EAAAA,KAACqQ,EAAAA,EAAS,CAAC5Q,UAAU,YAAY,IAAE2E,EAAE,oBAEvC1C,EAAAA,EAAAA,MAACa,EAAAA,GAAW,CAAC0N,MAAM,WAAWxQ,UAAU,UAASgC,SAAA,EAC/CzB,EAAAA,EAAAA,KAACsQ,EAAAA,EAAQ,CAAC7Q,UAAU,YAAY,IAAE2E,EAAE,mBAKxCpE,EAAAA,EAAAA,KAACwC,EAAAA,GAAW,CAACyN,MAAM,QAAQxQ,UAAU,OAAMgC,UACzCC,EAAAA,EAAAA,MAACtB,EAAAA,GAAI,CAAAqB,SAAA,EACHzB,EAAAA,EAAAA,KAACK,EAAAA,GAAU,CAACZ,UAAU,OAAMgC,UAC1BC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,oDAAmDgC,SAAA,EAChEzB,EAAAA,EAAAA,KAACQ,EAAAA,GAAS,CAAAiB,SAAE2C,EAAE,gBACd1C,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,oCAAmCgC,SAAA,EAChDC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,0BAAyBgC,SAAA,EACtCC,EAAAA,EAAAA,MAACQ,EAAAA,EAAK,CAAAT,SAAA,CAAE2C,EAAE,gBAAgB,QAC1BpE,EAAAA,EAAAA,KAAA,UACEP,UAAU,6DACVwQ,OAAoB,OAAbjK,SAAa,IAAbA,QAAa,EAAbA,GAAeuD,KAAM,GAC5BgH,SAAUC,GAAKvK,GAAiBxB,EAAQkI,KAAKiB,GAAKA,EAAErE,KAAOiH,EAAEC,OAAOR,QAAQxO,SAE3EgD,EAAQqE,IAAI8E,IAAK5N,EAAAA,EAAAA,KAAA,UAAmBiQ,MAAOrC,EAAErE,GAAG9H,SAAEmM,EAAEnC,MAAtBmC,EAAErE,UAIpCsE,IACCnM,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,mFAAkFgC,SAAA,EAC/FzB,EAAAA,EAAAA,KAAC0Q,EAAAA,EAAS,CAACjR,UAAU,2BACrBiC,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,oCAAmCgC,SAAA,CAAE2C,EAAE,iBAAiB,KAAGyJ,GAAanB,QAAQjB,YAGlG/J,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAACL,KAAK,KAAKP,QAAQ,UAAUuP,QAASA,IAAMpH,IAAoB,GAAOnH,UAAU,4DAA2DgC,SAAA,EACjJzB,EAAAA,EAAAA,KAAC2Q,EAAAA,EAAW,CAAClR,UAAU,YAAY,IAAE2E,EAAE,qBAI3C1C,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAACL,KAAK,KAAKP,QAAQ,QAAQuP,QAASA,IAAMpH,IAAoB,GAAOnH,UAAU,QAAOgC,SAAA,EAC3FzB,EAAAA,EAAAA,KAAC4Q,EAAAA,EAAI,CAACnR,UAAU,gBAAgB,IAAE2E,EAAE,YAEtC1C,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAACL,KAAK,KAAKP,QAAQ,UAAUuP,QAnRpB6C,KAC9B3J,IAAmC,OAAblB,SAAa,IAAbA,QAAa,EAAbA,GAAelB,WAAY,IACjDkC,IAA2B,IAiRyDvH,UAAU,+DAA8DgC,SAAA,EAC5IzB,EAAAA,EAAAA,KAAC8Q,EAAAA,EAAQ,CAACrR,UAAU,iBACN,OAAbuG,SAAa,IAAbA,IAAuB,QAAV7B,EAAb6B,GAAelB,gBAAQ,IAAAX,OAAV,EAAbA,EAAyBxB,QAAS,EAAC,GAAAO,OAAMkB,EAAE,YAAW,MAAAlB,OAAK8C,GAAclB,SAASnC,OAAM,KAAMyB,EAAE,wBAKzG1C,EAAAA,EAAAA,MAACZ,EAAAA,GAAW,CAAAW,SAAA,CACT+D,IACCxF,EAAAA,EAAAA,KAAA,OAAKP,UAAU,4BAA2BgC,UAACzB,EAAAA,EAAAA,KAACoP,EAAAA,EAAO,CAAC3P,UAAU,4CAE9DO,EAAAA,EAAAA,KAAA,OAAKP,UAAU,kBAAkB8J,GAAG,iBAAgB9H,UAClDC,EAAAA,EAAAA,MAAA,SAAOjC,UAAU,uCAAsCgC,SAAA,EACrDzB,EAAAA,EAAAA,KAAA,SAAAyB,UACEC,EAAAA,EAAAA,MAAA,MAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAAA,MAAIP,UAAU,sEAAqEgC,SAAC,6BACnFgH,GAAUK,IAAIiI,IACbrP,EAAAA,EAAAA,MAAA,MAAkBjC,UAAS,qDAAAyD,OAAuD6N,EAAKtH,QAAU,cAA4B,IAAZsH,EAAKxH,GAAW,8BAAgC,gBAAiB9H,SAAA,EAChLzB,EAAAA,EAAAA,KAAA,OAAAyB,SAAMsP,EAAKvH,SACX9H,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,yCAAwCgC,SAAA,CAAEsP,EAAKrH,MAAM,MAAIqH,EAAKlH,OAChE,IAAZkH,EAAKxH,KACJ7H,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,gGAA+FgC,SAAA,CAAC,IAAEyD,EAAS1B,wBAAwB,YAJ9IuN,EAAKxH,WAUpBvJ,EAAAA,EAAAA,KAAA,SAAAyB,SACGwI,GAAYnB,IAAI,CAACvB,EAAKyJ,KACrBtP,EAAAA,EAAAA,MAAA,MAAAD,SAAA,EACEC,EAAAA,EAAAA,MAAA,MAAIjC,UAAU,8DAA6DgC,SAAA,EACzEzB,EAAAA,EAAAA,KAAA,OAAAyB,SAAM8F,KACNvH,EAAAA,EAAAA,KAAA,OAAKP,UAAU,6BAA4BgC,SAAE2B,EAAQD,EAAK8N,QAAQ1J,SAEnEkB,GAAUK,IAAIiI,IAAS,IAADG,EACrB,GAAIH,EAAKtH,QACP,OACEzJ,EAAAA,EAAAA,KAAA,MAAkBP,UAAU,sDAAqDgC,UAC/EzB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,qCAAoCgC,SAAEsP,EAAKvH,SADpDuH,EAAKxH,IAMlB,GAAgB,IAAZwH,EAAKxH,GAAU,CAAC,IAAD4H,EACjB,MAAMC,GAAqB,OAAZvD,SAAY,IAAZA,IAAqB,QAATsD,EAAZtD,GAAcnB,eAAO,IAAAyE,OAAT,EAAZA,EAAuB1F,OAAQ,eAC9C,OACEzL,EAAAA,EAAAA,KAAA,MAAkBP,UAAU,6DAA6D4R,MAAM,4DAA2D5P,UACxJC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,qCAAoCgC,SAAA,EACjDzB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,UAASgC,SAAC,oCAC1BzB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,kCAAiCgC,SAAE2C,EAAE,eACrDpE,EAAAA,EAAAA,KAAA,QAAMP,UAAU,4BAA2BgC,SAAC,sDAC5CzB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,8DAA6DgC,SAAE2P,KAC/E1P,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,uFAAsFgC,SAAA,CAAC,IAAEyD,EAAS1B,wBAAwB,cANrIuN,EAAKxH,GAUlB,CAEA,MAAM+H,EAAuB,QAAfJ,EAAG3D,GAAQhG,UAAI,IAAA2J,OAAA,EAAZA,EAAeH,EAAKxH,IACrC,OACEvJ,EAAAA,EAAAA,KAAA,MAEEP,UAAS,gGAAAyD,OAAkGoO,EAAWtN,EAAgBsN,EAASvE,cAAgB,IAC/JiB,QAASA,IAzTfuD,EAAChK,EAAKC,KAAY,IAADgK,EAAAC,EACvC,GAAkB,IAAdjK,EAAO+B,GAAU,OACrB,MAAMwH,GAAoC,QAA7BS,EAAAxM,EAAwB,OAAbgB,SAAa,IAAbA,QAAa,EAAbA,GAAeuD,WAAG,IAAAiI,GAAO,QAAPC,EAA7BD,EAAgCjK,UAAI,IAAAkK,OAAP,EAA7BA,EAAuCjK,EAAO+B,MAAO,CAAC,EACnEjC,GAAY,CAAEC,MAAKC,OAAQA,EAAO+B,GAAI9B,WAAYsJ,EAAKtJ,YAAc,GAAIC,WAAYqJ,EAAKrJ,YAAc,GAAIC,KAAMoJ,EAAKpJ,MAAQ,KAC/HjB,IAAkB,IAqTyB6K,CAAgBhK,EAAKwJ,GAAMtP,SAEzC6P,GACC5P,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,qCAAoCgC,SAAA,EACjDzB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,wBAAuBgC,SAAE6P,EAASvE,gBAClD/M,EAAAA,EAAAA,KAAA,QAAMP,UAAU,6BAA4BgC,SAAE6P,EAASvC,mBAGzDrN,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,yBAAwBgC,SAAA,CAAC,KAAG2C,EAAE,WAV3C2M,EAAKxH,QAhCThC,YAsDnB7F,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,4BAA2BgC,SAAA,CACvCkK,OAAOC,KAAKvI,GAAgB2G,OAAO0H,GAAW,YAANA,GAAiB5I,IAAIkG,IAC5DhP,EAAAA,EAAAA,KAAA,QAAgBP,UAAS,sDAAAyD,OAAwDG,EAAe2L,IAAOvN,SAAEuN,GAA9FA,KAEbtN,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,+FAA8FgC,SAAA,CAAC,gBAAI2C,EAAE,2BAO7HpE,EAAAA,EAAAA,KAACwC,EAAAA,GAAW,CAACyN,MAAM,UAAUxQ,UAAU,OAAMgC,UAC3CC,EAAAA,EAAAA,MAACtB,EAAAA,GAAI,CAAAqB,SAAA,EACHzB,EAAAA,EAAAA,KAACK,EAAAA,GAAU,CAACZ,UAAU,OAAMgC,UAC1BC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,oDAAmDgC,SAAA,EAChEzB,EAAAA,EAAAA,KAACQ,EAAAA,GAAS,CAAAiB,SAAE2C,EAAE,cACd1C,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,0BAAyBgC,SAAA,EACtCC,EAAAA,EAAAA,MAACQ,EAAAA,EAAK,CAAAT,SAAA,CAAE2C,EAAE,WAAW,QACrB1C,EAAAA,EAAAA,MAAA,UACEjC,UAAU,6DACVwQ,OAAsB,OAAf/J,SAAe,IAAfA,QAAe,EAAfA,GAAiBqD,KAAM,GAC9BgH,SAAUC,GAAKrK,GAAmBvB,EAAS+H,KAAKvI,GAAKA,EAAEmF,KAAOiH,EAAEC,OAAOR,QAAQxO,SAAA,EAE/EC,EAAAA,EAAAA,MAAA,UAAQuO,MAAM,GAAExO,SAAA,CAAC,MAAI2C,EAAE,mBAAmB,SACzCQ,EAASkE,IAAI1E,IAAKpE,EAAAA,EAAAA,KAAA,UAAmBiQ,MAAO7L,EAAEmF,GAAG9H,SAAE2C,EAAEqH,MAAtBrH,EAAEmF,iBAK1CvJ,EAAAA,EAAAA,KAACc,EAAAA,GAAW,CAAAW,SACRyE,GAEE,MACF,MAAMyL,EA/ZQvE,KAC1B,MAAMuE,EAAW,CAAC,EAWlB,OAVAhG,OAAO6B,QAAQxI,GAAY0J,QAAQnP,IAAyB,IAAvB+N,EAASC,GAAQhO,EACpDoM,OAAO6B,QAAQD,GAASmB,QAAQpO,IAAwB,IAAtBiH,EAAKqK,GAAWtR,EAChDqL,OAAO6B,QAAQoE,GAAYlD,QAAQjO,IAAkB,IAAhBoR,EAAKd,GAAKtQ,EACT,IAADqR,EAA/Bf,EAAKrJ,aAAe0F,IACjBuE,EAASpK,KAAMoK,EAASpK,GAAO,CAAC,GACrCoK,EAASpK,GAAKsK,IAAI5R,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQ8Q,GAAI,IAAEjJ,SAAUwF,EAASyE,WAA+C,QAArCD,EAAErN,EAAQkI,KAAKiB,GAAKA,EAAErE,KAAO+D,UAAQ,IAAAwE,OAAA,EAAnCA,EAAqCrG,cAKrGkG,GAmZsBK,CAAmB9L,GAAgBqD,IAC9C0I,EAAmBxN,EAAQuF,OAAO4D,IACtC,MAAMrB,EAAOqB,EAAEpB,kBAAoBoB,EAAEnB,eACrC,OAAOF,IAASrG,GAAgBqD,IAAMgD,IAASrG,GAAgB0G,KAAOgB,EAAEV,gBAAkBhH,GAAgBuF,OAG5G,OACE/J,EAAAA,EAAAA,MAAA,OAAAD,SAAA,CACGwQ,EAAiBtP,OAAS,IACzB3C,EAAAA,EAAAA,KAAA,OAAKP,UAAU,4BAA2BgC,SACvCwQ,EAAiBnJ,IAAI8E,IACpBlM,EAAAA,EAAAA,MAAA,QAAiBjC,UAAU,8FAA6FgC,SAAA,CACrH2C,EAAE,iBAAiB,KAAGwJ,EAAEnC,OADhBmC,EAAErE,QAMnBvJ,EAAAA,EAAAA,KAAA,OAAKP,UAAU,kBAAiBgC,UAC9BC,EAAAA,EAAAA,MAAA,SAAOjC,UAAU,uCAAsCgC,SAAA,EACrDzB,EAAAA,EAAAA,KAAA,SAAAyB,UACEC,EAAAA,EAAAA,MAAA,MAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAAA,MAAIP,UAAU,sEAAqEgC,SAAE2C,EAAE,UACtF2F,GAAQjB,IAAIoJ,IACXxQ,EAAAA,EAAAA,MAAA,MAAejC,UAAS,qDAAAyD,OAAgE,IAATgP,EAAE3I,GAAW,8BAAgC,gBAAiB9H,SAAA,EAC3IzB,EAAAA,EAAAA,KAAA,OAAAyB,SAAMyQ,EAAE1I,SACR9H,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,6BAA4BgC,SAAA,CAAEyQ,EAAExI,MAAM,IAAEwI,EAAErI,OAC/C,IAATqI,EAAE3I,KAAY7H,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,uFAAsFgC,SAAA,CAAC,IAAEyD,EAAS1B,wBAAwB,SAHlJ0O,EAAE3I,WAQjBvJ,EAAAA,EAAAA,KAAA,SAAAyB,SACGwI,GAAYnB,IAAI,CAACvB,EAAKyJ,KACrBtP,EAAAA,EAAAA,MAAA,MAAAD,SAAA,EACEC,EAAAA,EAAAA,MAAA,MAAIjC,UAAU,8DAA6DgC,SAAA,EACzEzB,EAAAA,EAAAA,KAAA,OAAAyB,SAAM8F,KACNvH,EAAAA,EAAAA,KAAA,OAAKP,UAAU,6BAA4BgC,SAAE2B,EAAQD,EAAK8N,QAAQ1J,SAEnEwC,GAAQjB,IAAIoJ,IAAM,IAADC,EAChB,MAAMpB,EAAoB,QAAhBoB,EAAGR,EAASpK,UAAI,IAAA4K,OAAA,EAAbA,EAAgBD,EAAE3I,IAG/B,OAF4B,IAAT2I,EAAE3I,IAAY0I,EAAiBtP,OAAS,GAIvD3C,EAAAA,EAAAA,KAAA,MAAeP,UAAU,0CAAyCgC,UAChEC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,qCAAoCgC,SAAA,EACjDzB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,UAASgC,SAAC,oCAC1BzB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,oEAAmEgC,SAAE2C,EAAE,eACvFpE,EAAAA,EAAAA,KAAA,QAAMP,UAAU,4BAA2BgC,SAAEwQ,EAAiBnJ,IAAI8E,GAAKA,EAAEnC,MAAM2G,KAAK,YAJ/EF,EAAE3I,KAWbvJ,EAAAA,EAAAA,KAAA,MAAeP,UAAS,6CAAAyD,OAA+C6N,EAAO/M,EAAgB+M,EAAKhE,cAAgB,eAAgBtL,SAChIsP,GACCrP,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,qCAAoCgC,SAAA,EACjDzB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,wBAAuBgC,SAAEsP,EAAKhE,gBAC9C/M,EAAAA,EAAAA,KAAA,QAAMP,UAAU,6BAA4BgC,SAAEsP,EAAKgB,iBAGrD/R,EAAAA,EAAAA,KAAA,QAAMP,UAAU,qCAAoCgC,SAAE2C,EAAE,gBAPnD8N,EAAE3I,QAtBRhC,aAyCtB,EA3EG,IADF7F,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,mCAAkCgC,SAAA,EAACzB,EAAAA,EAAAA,KAACqS,EAAAA,EAAK,CAAC5S,UAAU,uCAAsCO,EAAAA,EAAAA,KAAA,KAAAyB,SAAI2C,EAAE,gCAkFvHpE,EAAAA,EAAAA,KAACwC,EAAAA,GAAW,CAACyN,MAAM,gBAAgBxQ,UAAU,OAAMgC,UACjDC,EAAAA,EAAAA,MAACtB,EAAAA,GAAI,CAAAqB,SAAA,EACHzB,EAAAA,EAAAA,KAACK,EAAAA,GAAU,CAACZ,UAAU,OAAMgC,UAC1BC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,oDAAmDgC,SAAA,EAChEzB,EAAAA,EAAAA,KAACQ,EAAAA,GAAS,CAAAiB,SAAE2C,EAAE,mBACd1C,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,0BAAyBgC,SAAA,EACtCzB,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACC,KAAK,OAAOiO,MAAO7J,GAASmK,SAAUC,GAAKnK,GAAWmK,EAAEC,OAAOR,OAAQxQ,UAAU,UACxFiC,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAAC2O,QAASA,KAAQnG,GAAW,CAAEC,SAAU,GAAIC,UAAW,GAAIC,oBAAqB,GAAIC,sBAAuB,GAAIC,OAAQ,GAAIC,aAAa,IAAUrB,IAAiB,IAAUrH,UAAU,4CAA2CgC,SAAA,EACxOzB,EAAAA,EAAAA,KAACsS,EAAAA,EAAI,CAAC7S,UAAU,YAAY,IAAE2E,EAAE,iCAKxCpE,EAAAA,EAAAA,KAACc,EAAAA,GAAW,CAAAW,SACgB,IAAzB2D,EAAczC,QACbjB,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,mCAAkCgC,SAAA,EAC/CzB,EAAAA,EAAAA,KAACqQ,EAAAA,EAAS,CAAC5Q,UAAU,uCACrBO,EAAAA,EAAAA,KAAA,KAAAyB,SAAI2C,EAAE,iBAGRpE,EAAAA,EAAAA,KAAA,OAAKP,UAAU,kBAAiBgC,UAC9BC,EAAAA,EAAAA,MAAA,SAAOjC,UAAU,yBAAwBgC,SAAA,EACvCzB,EAAAA,EAAAA,KAAA,SAAAyB,UACEC,EAAAA,EAAAA,MAAA,MAAIjC,UAAU,cAAagC,SAAA,EACzBzB,EAAAA,EAAAA,KAAA,MAAIP,UAAU,gDAA+CgC,SAAE2C,EAAE,cACjEpE,EAAAA,EAAAA,KAAA,MAAIP,UAAU,gDAA+CgC,SAAE2C,EAAE,aACjEpE,EAAAA,EAAAA,KAAA,MAAIP,UAAU,gDAA+CgC,SAAE2C,EAAE,cACjEpE,EAAAA,EAAAA,KAAA,MAAIP,UAAU,gDAA+CgC,SAAE2C,EAAE,mBACjEpE,EAAAA,EAAAA,KAAA,MAAIP,UAAU,gDAA+CgC,SAAE2C,EAAE,aACjEpE,EAAAA,EAAAA,KAAA,MAAIP,UAAU,uDAAsDgC,SAAE2C,EAAE,mBAG5EpE,EAAAA,EAAAA,KAAA,SAAAyB,SACG2D,EAAc0D,IAAIkG,IACjB,MAAM9D,EAAMzG,EAAQkI,KAAKiB,GAAKA,EAAErE,KAAOyF,EAAIlH,UACrCyK,EAAQ3N,EAAS+H,KAAKvI,GAAKA,EAAEmF,KAAOyF,EAAIhH,qBACxCwK,EAAO5N,EAAS+H,KAAKvI,GAAKA,EAAEmF,KAAOyF,EAAI/G,uBAC7C,OACEvG,EAAAA,EAAAA,MAAA,MAA4BjC,UAAU,oBAAmBgC,SAAA,EACvDzB,EAAAA,EAAAA,KAAA,MAAIP,UAAU,sCAAqCgC,UAAK,OAAHyJ,QAAG,IAAHA,OAAG,EAAHA,EAAKO,OAAQuD,EAAIlH,YACtEpG,EAAAA,EAAAA,MAAA,MAAIjC,UAAU,sCAAqCgC,SAAA,CAChD2C,EAAE,UAAU,IAAE4K,EAAIjH,WACjBiH,EAAI7G,aAAiC,IAAlB6G,EAAIjH,aAAoB/H,EAAAA,EAAAA,KAAA,QAAMP,UAAU,4EAA2EgC,SAAE2C,EAAE,kBAE9IpE,EAAAA,EAAAA,KAAA,MAAIP,UAAU,sCAAqCgC,UAAO,OAAL8Q,QAAK,IAALA,OAAK,EAALA,EAAO9G,OAAQuD,EAAIyD,uBAAyB,OACjGzS,EAAAA,EAAAA,KAAA,MAAIP,UAAU,iEAAgEgC,UAAM,OAAJ+Q,QAAI,IAAJA,OAAI,EAAJA,EAAM/G,OAAQuD,EAAI0D,yBAA2B,OAC7H1S,EAAAA,EAAAA,KAAA,MAAIP,UAAU,qDAAoDgC,SAAEuN,EAAI9G,QAAU,OAClFlI,EAAAA,EAAAA,KAAA,MAAIP,UAAU,0CAAyCgC,UACrDzB,EAAAA,EAAAA,KAACX,EAAAA,EAAM,CAACL,KAAK,KAAKP,QAAQ,QAAQgB,UAAU,8CAA8CuO,QAASA,IA5V9F5D,WAC/B,UACQU,EAAAA,EAAM6H,OAAO,GAADzP,OAAID,EAAG,mBAAAC,OAAkB0P,GAAS,CAAErK,aACtDyD,EAAAA,GAAMqC,QAAQ,wBACdpC,IACF,CAAE,MAAA4G,GAAQ7G,EAAAA,GAAMF,MAAM,mBAAqB,GAuVwFgH,CAAyB9D,EAAIzF,IAAMyF,EAAIpC,KAAKnL,UACnJzB,EAAAA,EAAAA,KAAC+S,EAAAA,EAAM,CAACtT,UAAU,sBAXfuP,EAAIzF,IAAMyF,EAAIpC,sBA0BzC5M,EAAAA,EAAAA,KAACwC,EAAAA,GAAW,CAACyN,MAAM,WAAWxQ,UAAU,OAAMgC,UAC5CC,EAAAA,EAAAA,MAACtB,EAAAA,GAAI,CAAAqB,SAAA,EACHzB,EAAAA,EAAAA,KAACK,EAAAA,GAAU,CAAAoB,UACTC,EAAAA,EAAAA,MAAClB,EAAAA,GAAS,CAACf,UAAU,0BAAyBgC,SAAA,EAACzB,EAAAA,EAAAA,KAACsQ,EAAAA,EAAQ,CAAC7Q,UAAU,YAAY,IAAE2E,EAAE,kBAErF1C,EAAAA,EAAAA,MAACZ,EAAAA,GAAW,CAAAW,SAAA,EACVC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,wCAAuCgC,SAAA,EACpDC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,YAAWgC,SAAA,EACxBC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEC,EAAAA,EAAAA,MAACQ,EAAAA,EAAK,CAAAT,SAAA,CAAE2C,EAAE,UAAU,KAAGA,EAAE,aAAa,QACtCpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACC,KAAK,SAASgR,IAAK,GAAIC,IAAK,GAAIhD,MAAO/K,EAAS3B,uBAAwBgN,SAAUC,GAAKrL,EAAYuD,IAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUyI,GAAC,IAAEnF,uBAAwB2P,SAAS1C,EAAEC,OAAOR,QAAU,YAE9KvO,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,iBACVpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACC,KAAK,SAASgR,IAAK,EAAGC,IAAK,GAAIhD,MAAO/K,EAAS1B,wBAAyB+M,SAAUC,GAAKrL,EAAYuD,IAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUyI,GAAC,IAAElF,wBAAyB0P,SAAS1C,EAAEC,OAAOR,QAAU,SAC7KvO,EAAAA,EAAAA,MAAA,KAAGjC,UAAU,8BAA6BgC,SAAA,CAAC,cAAYyD,EAAS3B,uBAAyB2B,EAAS1B,wBAAwB,6EAE5H9B,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,iBACVpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACC,KAAK,OAAOiO,MAAO/K,EAASzB,kBAAmB8M,SAAUC,GAAKrL,EAAYuD,IAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUyI,GAAC,IAAEjF,kBAAmB+M,EAAEC,OAAOR,eAE7HvO,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,aACVpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACC,KAAK,SAASgR,IAAK,EAAGC,IAAK,GAAIhD,MAAO/K,EAASpB,gBAAiByM,SAAUC,GAAKrL,EAAYuD,IAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUyI,GAAC,IAAE5E,gBAAiBoP,SAAS1C,EAAEC,OAAOR,QAAU,cAIjKvO,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,YAAWgC,SAAA,EACxBC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,iBACVpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACC,KAAK,SAASgR,IAAK,EAAGC,IAAK,GAAIhD,MAAO/K,EAASxB,eAAgB6M,SAAUC,GAAKrL,EAAYuD,IAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUyI,GAAC,IAAEhF,eAAgBwP,SAAS1C,EAAEC,OAAOR,QAAU,YAE7JvO,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,YACVpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACC,KAAK,SAASgR,IAAK,GAAIC,IAAK,GAAIhD,MAAO/K,EAASvB,eAAgB4M,SAAUC,GAAKrL,EAAYuD,IAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUyI,GAAC,IAAE/E,eAAgBuP,SAAS1C,EAAEC,OAAOR,QAAU,YAE9JvO,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,iBACVpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACC,KAAK,SAASgR,IAAK,EAAGC,IAAK,GAAIhD,MAAO/K,EAAStB,mBAAoB2M,SAAUC,GAAKrL,EAAYuD,IAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUyI,GAAC,IAAE9E,mBAAoBsP,SAAS1C,EAAEC,OAAOR,QAAU,WAErKvO,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,YACVpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACC,KAAK,SAASgR,IAAK,EAAGC,IAAK,GAAIhD,MAAO/K,EAASrB,mBAAoB0M,SAAUC,GAAKrL,EAAYuD,IAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUyI,GAAC,IAAE7E,mBAAoBqP,SAAS1C,EAAEC,OAAOR,QAAU,iBAKzKvO,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,OAAMgC,SAAA,EACnBzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAACzC,UAAU,aAAYgC,SAAE2C,EAAE,mBACjCpE,EAAAA,EAAAA,KAAA,OAAKP,UAAU,uBAAsBgC,SAClC0B,EAAK2F,IAAI,CAACvB,EAAK0B,KAAC,IAAAkK,EAAA,OACfzR,EAAAA,EAAAA,MAAA,SAAiBjC,UAAU,yCAAwCgC,SAAA,EACjEzB,EAAAA,EAAAA,KAAA,SACEgC,KAAK,WACLoR,QAA8B,QAAvBD,EAAEjO,EAASnB,oBAAY,IAAAoP,OAAA,EAArBA,EAAuB5H,SAAShE,GACzCgJ,SAAUC,IACRrL,EAAYuD,IAACzI,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACRyI,GAAC,IACJ3E,aAAcyM,EAAEC,OAAO2C,QACnB,IAAK1K,EAAE3E,cAAgB,GAAKwD,IAC3BmB,EAAE3E,cAAgB,IAAIiG,OAAOqJ,GAAKA,IAAM9L,OAGjD9H,UAAU,8BAEZiC,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,UAASgC,SAAA,CAAE8F,EAAI,KAAC7F,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,yBAAwBgC,SAAA,CAAC,IAAE2B,EAAQ6F,GAAG,YAd5E1B,WAoBlBvH,EAAAA,EAAAA,KAAA,OAAKP,UAAU,OAAMgC,UACnBC,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAAC2O,QAldK5D,UACzBzE,IAAU,GACV,UACQmF,EAAAA,EAAMoD,KAAK,GAADhL,OAAID,EAAG,wBAAAhD,EAAAA,EAAAA,GAAA,CAAyBkO,UAAW7J,GAAaY,GAAY,CAAEqD,aACtFyD,EAAAA,GAAMqC,QAAQ,kBAChB,CAAE,MAAAiF,GAAQtH,EAAAA,GAAMF,MAAM,0BAA4B,CAAC,QACzCnG,IAAU,EAAQ,GA4cqBwJ,SAAUzJ,GAAQjG,UAAU,0CAAyCgC,SAAA,CACvGiE,IAAS1F,EAAAA,EAAAA,KAACoP,EAAAA,EAAO,CAAC3P,UAAU,0BAA4BO,EAAAA,EAAAA,KAACuT,EAAAA,EAAI,CAAC9T,UAAU,YACxE2E,EAAE,uBAIP1C,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,qBAAoBgC,SAAA,EACjCzB,EAAAA,EAAAA,KAAA,MAAIP,UAAU,4CAA2CgC,SAAE2C,EAAE,gBAC7DpE,EAAAA,EAAAA,KAAA,OAAKP,UAAU,wCAAuCgC,SACnDgH,GAAUK,IAAIiI,IACbrP,EAAAA,EAAAA,MAAA,OAAmBjC,UAAS,6CAAAyD,OAA+C6N,EAAKtH,QAAU,+BAA6C,IAAZsH,EAAKxH,GAAW,6BAA+B,6BAA8B9H,SAAA,EACtMzB,EAAAA,EAAAA,KAAA,OAAKP,UAAU,cAAagC,SAAEsP,EAAKvH,SACnC9H,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,iBAAgBgC,SAAA,CAAEsP,EAAKrH,MAAM,MAAIqH,EAAKlH,OACxC,IAAZkH,EAAKxH,KAAY7H,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,qCAAoCgC,SAAA,CAAE2C,EAAE,YAAY,KAAGc,EAAS1B,wBAAwB,SAHlHuN,EAAKxH,sBAc7BvJ,EAAAA,EAAAA,KAACmB,EAAAA,GAAM,CAACyO,KAAMnJ,GAAgB+M,aAAc9M,GAAkBjF,UAC5DC,EAAAA,EAAAA,MAACF,EAAAA,GAAa,CAAC/B,UAAU,WAAUgC,SAAA,EACjCC,EAAAA,EAAAA,MAACE,EAAAA,GAAY,CAAAH,SAAA,EACXzB,EAAAA,EAAAA,KAAC6B,EAAAA,GAAW,CAAAJ,SAAE2C,EAAE,aAChB1C,EAAAA,EAAAA,MAACI,EAAAA,GAAiB,CAAAL,SAAA,CAAE4F,GAASE,IAAI,MAAInD,EAAE,UAAU,IAAEiD,GAASG,cAE9D9F,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,YAAWgC,SAAA,EACxBC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,gBACM,OAAb4B,SAAa,IAAbA,IAAAA,GAAelB,WAA8C,IAAlCkB,GAAclB,SAASnC,UACnDjB,EAAAA,EAAAA,MAAA,KAAGjC,UAAU,sDAAqDgC,SAAA,EAChEzB,EAAAA,EAAAA,KAAC2Q,EAAAA,EAAW,CAAClR,UAAU,YAAY,4UAIvCiC,EAAAA,EAAAA,MAAA,UAAQjC,UAAU,sDAAsDwQ,MAAO5I,GAASI,WAAY8I,SAAUC,GAAKlJ,GAAYmM,IAACxT,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUwT,GAAC,IAAEhM,WAAY+I,EAAEC,OAAOR,SAAUxO,SAAA,EAC1KC,EAAAA,EAAAA,MAAA,UAAQuO,MAAM,GAAExO,SAAA,CAAC,MAAI2C,EAAE,WAAW,SAhpBvBsP,MACvB,IAAK1N,GAAe,OAAOlB,EAC3B,MAAM6O,EAAkB3N,GAAclB,SACtC,OAAI6O,GAAmBA,EAAgBhR,OAAS,EACvCmC,EAASkF,OAAOtB,GAAKiL,EAAgBpI,SAAS7C,EAAEa,KAElDzE,GA2oBM4O,GAAmB5K,IAAIJ,IAAKhH,EAAAA,EAAAA,MAAA,UAAmBuO,MAAOvH,EAAEa,GAAG9H,SAAA,CAAEiH,EAAE+C,KAAM/C,EAAEgD,QAAO,KAAAxI,OAAQwF,EAAEgD,QAAO,KAAM,KAA5DhD,EAAEa,YAGhD7H,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,cACV1C,EAAAA,EAAAA,MAAA,UAAQjC,UAAU,sDAAsDwQ,MAAO5I,GAASK,WAAY6I,SAAUC,GAAKlJ,GAAYmM,IAACxT,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUwT,GAAC,IAAE/L,WAAY8I,EAAEC,OAAOR,SAAUxO,SAAA,EAC1KC,EAAAA,EAAAA,MAAA,UAAQuO,MAAM,GAAExO,SAAA,CAAC,MAAI2C,EAAE,WAAW,SACjCQ,EAASkE,IAAI1E,IACZ,MAAMwP,EAAOzG,GAAc/I,EAAEmF,GAAIlC,GAASE,IAAKF,GAASG,QACxD,OAAO9F,EAAAA,EAAAA,MAAA,UAAmBuO,MAAO7L,EAAEmF,GAAI4F,WAAYyE,EAAKnS,SAAA,CAAE2C,EAAEqH,KAAMmI,EAAI,WAAA1Q,OAAc0Q,EAAI,KAAM,KAA1ExP,EAAEmF,aAI5B7H,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEC,EAAAA,EAAAA,MAACQ,EAAAA,EAAK,CAAAT,SAAA,CAAE2C,EAAE,eAAe,KAAGA,EAAE,YAAY,QAC1CpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACkO,MAAO5I,GAASM,KAAM4I,SAAUC,GAAKlJ,GAAYmM,IAACxT,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUwT,GAAC,IAAE9L,KAAM6I,EAAEC,OAAOR,SAAW4D,YAAY,oBAE9GnS,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,kBAAiBgC,SAAA,EAC9BC,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAACZ,QAAQ,cAAcO,KAAK,KAAKgP,QA1lB3B5D,UACvBzE,IAAU,GACV,UACQmF,EAAAA,EAAM6H,OAAO,GAADzP,OAAID,EAAG,oBAAoB,CAAEsF,WAAS0C,KAAM,CAAEkD,UAAW7J,EAAUwD,SAAU9B,GAAcuD,GAAIhC,IAAKF,GAASE,IAAKQ,UAAWV,GAASG,UACxJvC,EAAc4G,IAAS,IAADiI,EACpB,MAAMC,GAAC9T,EAAAA,EAAAA,GAAA,GAAQ4L,GAEf,OADuB,QAAvBiI,EAAIC,EAAE/N,GAAcuD,WAAG,IAAAuK,GAAnBA,EAAsBzM,GAASE,aAAawM,EAAE/N,GAAcuD,IAAIlC,GAASE,KAAKF,GAASG,QACpFuM,IAET/H,EAAAA,GAAMqC,QAAQ,kBACd3H,IAAkB,EACpB,CAAE,MAAAsN,GAAQhI,EAAAA,GAAMF,MAAM,mBAAqB,CAAC,QAClCnG,IAAU,EAAQ,GA8kBiDwJ,SAAUzJ,GAAQjG,UAAU,QAAOgC,SAAA,EACpGzB,EAAAA,EAAAA,KAAC+S,EAAAA,EAAM,CAACtT,UAAU,gBAAgB,IAAE2E,EAAE,cAExCpE,EAAAA,EAAAA,KAAA,OAAKP,UAAU,YACfO,EAAAA,EAAAA,KAACX,EAAAA,EAAM,CAACZ,QAAQ,UAAUuP,QAASA,IAAMtH,IAAkB,GAAOjF,SAAE2C,EAAE,aACtE1C,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAAC2O,QA/nBG5D,UACrB,GAAK/C,GAASI,WAAd,CACA,GAAIJ,GAASK,WAAY,CACvB,MAAMkM,EAAOzG,GAAc9F,GAASK,WAAYL,GAASE,IAAKF,GAASG,QACvE,GAAIoM,EAAwD,YAAhD5H,EAAAA,GAAMF,MAAM,2BAAD5I,OAA4B0Q,GACrD,CACAjO,IAAU,GACV,IACE,MAAMqH,EAAUlI,EAAS6H,KAAKjE,GAAKA,EAAEa,KAAOlC,GAASI,YAC/CiF,EAAU9H,EAAS+H,KAAKvI,GAAKA,EAAEmF,KAAOlC,GAASK,kBAC/CoD,EAAAA,EAAMoD,KAAK,GAADhL,OAAID,EAAG,oBAAoB,CACzCkL,UAAW7J,EAAUwD,SAAU9B,GAAcuD,GAAIhC,IAAKF,GAASE,IAC/DQ,UAAWV,GAASG,OAAQC,WAAYJ,GAASI,WAAYsF,aAAqB,OAAPC,QAAO,IAAPA,OAAO,EAAPA,EAASvB,KACpF/D,WAAYL,GAASK,WAAYqH,aAAqB,OAAPrC,QAAO,IAAPA,OAAO,EAAPA,EAASjB,KAAM9D,KAAMN,GAASM,MAC5E,CAAEY,aACLtD,EAAc4G,IAAI,IAAAoI,EAAA,OAAAhU,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACb4L,GAAI,IACP,CAAC7F,GAAcuD,KAAEtJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACZ4L,EAAK7F,GAAcuD,KAAG,IACzB,CAAClC,GAASE,MAAGtH,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACc,QADdgU,EACRpI,EAAK7F,GAAcuD,WAAG,IAAA0K,OAAA,EAAtBA,EAAyB5M,GAASE,MAAI,IACzC,CAACF,GAASG,QAAS,CAAEC,WAAYJ,GAASI,WAAYsF,aAAqB,OAAPC,QAAO,IAAPA,OAAO,EAAPA,EAASvB,KAAM/D,WAAYL,GAASK,WAAYqH,aAAqB,OAAPrC,QAAO,IAAPA,OAAO,EAAPA,EAASjB,KAAM9D,KAAMN,GAASM,cAItKqE,EAAAA,GAAMqC,QAAQ,iBACd3H,IAAkB,EACpB,CAAE,MAAOoF,GAAQ,IAADoI,EAAAC,EACdnI,EAAAA,GAAMF,OAAoB,QAAdoI,EAAApI,EAAMsI,gBAAQ,IAAAF,GAAM,QAANC,EAAdD,EAAgBjJ,YAAI,IAAAkJ,OAAN,EAAdA,EAAsBE,SAAU,wBAC9C,CAAC,QAAW1O,IAAU,EAAQ,CA5B8C,MAAhDqG,EAAAA,GAAMF,MAAM,4BA8nBGqD,SAAUzJ,GAAQjG,UAAU,0CAAyCgC,SAAA,CACnGiE,IAAS1F,EAAAA,EAAAA,KAACoP,EAAAA,EAAO,CAAC3P,UAAU,0BAA4BO,EAAAA,EAAAA,KAACuT,EAAAA,EAAI,CAAC9T,UAAU,YAAa,IAAE2E,EAAE,uBAQpGpE,EAAAA,EAAAA,KAACmB,EAAAA,GAAM,CAACyO,KAAMjJ,GAAkB6M,aAAc5M,GAAoBnF,UAChEC,EAAAA,EAAAA,MAACF,EAAAA,GAAa,CAAC/B,UAAU,WAAUgC,SAAA,EACjCC,EAAAA,EAAAA,MAACE,EAAAA,GAAY,CAAAH,SAAA,EACXzB,EAAAA,EAAAA,KAAC6B,EAAAA,GAAW,CAAAJ,SAAE2C,EAAE,oBAChB1C,EAAAA,EAAAA,MAACI,EAAAA,GAAiB,CAAAL,SAAA,CACF,OAAbuE,SAAa,IAAbA,QAAa,EAAbA,GAAeyF,KAAK,iEAGzB/J,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,YAAWgC,SAAA,EACxBC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,cACV1C,EAAAA,EAAAA,MAAA,UAAQjC,UAAU,sDAAsDwQ,MAAO9I,GAAiBoJ,SAAUC,GAAKpJ,GAAmBoJ,EAAEC,OAAOR,OAAOxO,SAAA,EAChJC,EAAAA,EAAAA,MAAA,UAAQuO,MAAM,GAAExO,SAAA,CAAC,MAAI2C,EAAE,WAAW,SACjCQ,EAASkE,IAAI1E,IAAK1C,EAAAA,EAAAA,MAAA,UAAmBuO,MAAO7L,EAAEmF,GAAG9H,SAAA,CAAE2C,EAAEqH,KAAMrH,EAAE4I,QAAO,KAAA9J,OAAQkB,EAAE4I,QAAO,KAAM,KAA5D5I,EAAEmF,YAGtCvJ,EAAAA,EAAAA,KAAA,OAAKP,UAAU,mDAAkDgC,UAC/DC,EAAAA,EAAAA,MAAA,KAAGjC,UAAU,wBAAuBgC,SAAA,EAClCzB,EAAAA,EAAAA,KAAA,UAAAyB,SAAQ,UAAc,uKAA6HyD,EAAS1B,wBAAwB,uCAGxL9B,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,yBAAwBgC,SAAA,EACrCzB,EAAAA,EAAAA,KAACX,EAAAA,EAAM,CAACZ,QAAQ,UAAUuP,QAASA,IAAMpH,IAAoB,GAAOnF,SAAE2C,EAAE,aACxE1C,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAAC2O,QAhnBa5D,UAC/B,GAAKjD,IAAoBnB,GAAzB,CACAL,IAAU,GACV,IAAK,IAAD2O,EACF,MAAMpI,QAAYpB,EAAAA,EAAMoD,KAAK,GAADhL,OAAID,EAAG,yBAAyB,CAAEkL,UAAW7J,EAAUwD,SAAU9B,GAAcuD,GAAI7B,WAAYP,IAAmB,CAAEoB,aAChJyD,EAAAA,GAAMqC,SAAgB,QAARiG,EAAApI,EAAIjB,YAAI,IAAAqJ,OAAA,EAARA,EAAUC,UAAW,qDACnC3N,IAAoB,GACpBQ,GAAmB,IACnB8C,IACF,CAAE,MAAO4B,GAAQ,IAAD0I,EAAAC,EACdzI,EAAAA,GAAMF,OAAoB,QAAd0I,EAAA1I,EAAMsI,gBAAQ,IAAAI,GAAM,QAANC,EAAdD,EAAgBvJ,YAAI,IAAAwJ,OAAN,EAAdA,EAAsBJ,SAAU,iCAC9C,CAAC,QAAW1O,IAAU,EAAQ,CAVgB,GA+mBOwJ,SAAUzJ,KAAWyB,GAAiB1H,UAAU,0CAAyCgC,SAAA,CACjIiE,IAAS1F,EAAAA,EAAAA,KAACoP,EAAAA,EAAO,CAAC3P,UAAU,0BAA4BO,EAAAA,EAAAA,KAAC0Q,EAAAA,EAAS,CAACjR,UAAU,YAAa,IAAE2E,EAAE,uBAQzGpE,EAAAA,EAAAA,KAACmB,EAAAA,GAAM,CAACyO,KAAM/I,GAAe2M,aAAc1M,GAAiBrF,UAC1DC,EAAAA,EAAAA,MAACF,EAAAA,GAAa,CAAC/B,UAAU,WAAUgC,SAAA,EACjCC,EAAAA,EAAAA,MAACE,EAAAA,GAAY,CAAAH,SAAA,EACXzB,EAAAA,EAAAA,KAAC6B,EAAAA,GAAW,CAAAJ,SAAE2C,EAAE,mBAChB1C,EAAAA,EAAAA,MAACI,EAAAA,GAAiB,CAAAL,SAAA,CAAC,SAAO2E,UAE5B1E,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,YAAWgC,SAAA,EACxBC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,cACV1C,EAAAA,EAAAA,MAAA,UACEjC,UAAU,sDACVwQ,MAAOrI,GAAQE,SACfyI,SAAUC,IACR,MAAMkE,EAAMlE,EAAEC,OAAOR,MACrBpI,GAAW4L,IAACxT,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUwT,GAAC,IAAE3L,SAAU4M,EAAK3M,UAAW,GAAIC,oBAAqB,OAC5EvG,SAAA,EAEFC,EAAAA,EAAAA,MAAA,UAAQuO,MAAM,GAAExO,SAAA,CAAC,MAAI2C,EAAE,gBAAgB,SACtCK,EAAQqE,IAAI8E,IAAK5N,EAAAA,EAAAA,KAAA,UAAmBiQ,MAAOrC,EAAErE,GAAG9H,SAAEmM,EAAEnC,MAAtBmC,EAAErE,YAGrC7H,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,aACV1C,EAAAA,EAAAA,MAAA,UACEjC,UAAU,sDACVwQ,MAAOrI,GAAQG,UACfwI,SAAUC,IAAM,IAADmE,EAAAC,EACb,MAAMC,EAAMrE,EAAEC,OAAOR,MACfc,EAAmC,QAA/B4D,EAAG3P,EAAW4C,GAAQE,iBAAS,IAAA6M,GAAkB,QAAlBC,EAA5BD,EAA+B1K,GAAY,WAAG,IAAA2K,OAAlB,EAA5BA,EAAiD1B,SAAS2B,IACvEhN,GAAW4L,IAACxT,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUwT,GAAC,IAAE1L,UAAW8M,EAAK7M,qBAAyB,OAAJ+I,QAAI,IAAJA,OAAI,EAAJA,EAAMrJ,aAAc,GAAIS,YAAqB,MAAR0M,MACnGpT,SAAA,EAEFC,EAAAA,EAAAA,MAAA,UAAQuO,MAAM,GAAExO,SAAA,CAAC,MAAI2C,EAAE,UAAU,SAChC2F,GAAQjB,IAAIoJ,IACXxQ,EAAAA,EAAAA,MAAA,UAAmBuO,MAAOiC,EAAE3I,GAAG9H,SAAA,CAC5B2C,EAAE,UAAU,IAAE8N,EAAE3I,GAAa,IAAT2I,EAAE3I,GAAQ,KAAArG,OAAQkB,EAAE,YAAW,KAAM,KAD/C8N,EAAE3I,YAMrB7H,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,cACV1C,EAAAA,EAAAA,MAAA,UAAQjC,UAAU,sDAAsDwQ,MAAOrI,GAAQI,oBAAqBuI,SAAUC,GAAK3I,GAAW4L,IAACxT,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUwT,GAAC,IAAEzL,oBAAqBwI,EAAEC,OAAOR,SAAUxO,SAAA,EAC1LC,EAAAA,EAAAA,MAAA,UAAQuO,MAAM,GAAExO,SAAA,CAAC,MAAI2C,EAAE,WAAW,SACjCQ,EAASkE,IAAI1E,IAAKpE,EAAAA,EAAAA,KAAA,UAAmBiQ,MAAO7L,EAAEmF,GAAG9H,SAAE2C,EAAEqH,MAAtBrH,EAAEmF,YAGtC7H,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,mBACV1C,EAAAA,EAAAA,MAAA,UAAQjC,UAAU,sDAAsDwQ,MAAOrI,GAAQK,sBAAuBsI,SAAUC,GAAK3I,GAAW4L,IAACxT,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUwT,GAAC,IAAExL,sBAAuBuI,EAAEC,OAAOR,SAAUxO,SAAA,EAC9LC,EAAAA,EAAAA,MAAA,UAAQuO,MAAM,GAAExO,SAAA,CAAC,MAAI2C,EAAE,qBAAqB,SAC3CQ,EAASoF,OAAO5F,GAAKA,EAAEmF,KAAO3B,GAAQI,qBAAqBc,IAAI1E,IAC9D,MAAMwP,EAAOhM,GAAQG,UAAYoF,GAAc/I,EAAEmF,GAAIU,GAAY,GAAIiJ,SAAStL,GAAQG,YAAc,KACpG,OAAOrG,EAAAA,EAAAA,MAAA,UAAmBuO,MAAO7L,EAAEmF,GAAI4F,WAAYyE,EAAKnS,SAAA,CAAE2C,EAAEqH,KAAMmI,EAAI,WAAA1Q,OAAc0Q,EAAI,KAAM,KAA1ExP,EAAEmF,aAI5B7H,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEzB,EAAAA,EAAAA,KAACkC,EAAAA,EAAK,CAAAT,SAAE2C,EAAE,aACVpE,EAAAA,EAAAA,KAAC+B,EAAAA,EAAK,CAACkO,MAAOrI,GAAQM,OAAQqI,SAAUC,GAAK3I,GAAW4L,IAACxT,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUwT,GAAC,IAAEvL,OAAQsI,EAAEC,OAAOR,SAAW4D,YAAazP,EAAE,gBAEnH1C,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,yBAAwBgC,SAAA,EACrCzB,EAAAA,EAAAA,KAACX,EAAAA,EAAM,CAACZ,QAAQ,UAAUuP,QAASA,IAAMlH,IAAiB,GAAOrF,SAAE2C,EAAE,aACrE1C,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAAC2O,QAjnBU5D,UAC5B,GAAKxC,GAAQE,UAAaF,GAAQG,WAAcH,GAAQK,sBAAxD,CAGAtC,IAAU,GACV,UACQmF,EAAAA,EAAMoD,KAAK,GAADhL,OAAID,EAAG,kBAAkB,CACvCkL,UAAW7J,EAAUwD,SAAUF,GAAQE,SAAUgN,KAAM1O,GACvD2B,UAAWmL,SAAStL,GAAQG,WAAYC,oBAAqBJ,GAAQI,oBACrEC,sBAAuBL,GAAQK,sBAAuBC,OAAQN,GAAQM,OACtEC,YAAmC,MAAtBP,GAAQG,WAA2C,IAAtBH,GAAQG,WACjD,CAAEQ,aACLyD,EAAAA,GAAMqC,QAAQ,uBACdvH,IAAiB,GACjBe,GAAW,CAAEC,SAAU,GAAIC,UAAW,GAAIC,oBAAqB,GAAIC,sBAAuB,GAAIC,OAAQ,GAAIC,aAAa,IACvH8D,IACF,CAAE,MAAOH,GAAQ,IAADiJ,EAAAC,EACdhJ,EAAAA,GAAMF,OAAoB,QAAdiJ,EAAAjJ,EAAMsI,gBAAQ,IAAAW,GAAM,QAANC,EAAdD,EAAgB9J,YAAI,IAAA+J,OAAN,EAAdA,EAAsBX,SAAU,6BAC9C,CAAC,QAAW1O,IAAU,EAAQ,CAf9B,MADEqG,EAAAA,GAAMF,MAAM,oCA+mBoCqD,SAAUzJ,GAAQjG,UAAU,0CAAyCgC,SAAA,CAC1GiE,IAAS1F,EAAAA,EAAAA,KAACoP,EAAAA,EAAO,CAAC3P,UAAU,0BAA4BO,EAAAA,EAAAA,KAACiV,EAAAA,EAAK,CAACxV,UAAU,YAAa,IAAE2E,EAAE,uBAQrGpE,EAAAA,EAAAA,KAACmB,EAAAA,GAAM,CAACyO,KAAM7I,GAAyByM,aAAcxM,GAA2BvF,UAC9EC,EAAAA,EAAAA,MAACF,EAAAA,GAAa,CAAC/B,UAAU,WAAUgC,SAAA,EACjCC,EAAAA,EAAAA,MAACE,EAAAA,GAAY,CAAAH,SAAA,EACXC,EAAAA,EAAAA,MAACG,EAAAA,GAAW,CAAAJ,SAAA,CAAE2C,EAAE,YAAY,MAAiB,OAAb4B,SAAa,IAAbA,QAAa,EAAbA,GAAeyF,SAC/CzL,EAAAA,EAAAA,KAAC8B,EAAAA,GAAiB,CAAAL,SAAC,sbAErBzB,EAAAA,EAAAA,KAAA,OAAKP,UAAU,0CAAyCgC,SACrDqD,EAASgE,IAAIJ,IACZhH,EAAAA,EAAAA,MAAA,SAAkBjC,UAAS,oFAAAyD,OAAsF+D,GAAmBsE,SAAS7C,EAAEa,IAAM,iCAAmC,+CAAgD9H,SAAA,EACtOzB,EAAAA,EAAAA,KAAA,SACEgC,KAAK,WACLoR,QAASnM,GAAmBsE,SAAS7C,EAAEa,IACvCgH,SAAUA,KAAM2E,OAzwBAjI,EAywBuBvE,EAAEa,QAxwBvDrC,GAAsB2E,GACpBA,EAAKN,SAAS0B,GAAapB,EAAK7B,OAAOT,GAAMA,IAAO0D,GAAa,IAAIpB,EAAMoB,IAF/CA,OA0wBhBxN,UAAU,qCAEZiC,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,SAAQgC,SAAA,EACrBzB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,sBAAqBgC,SAAEiH,EAAE+C,OACxC/C,EAAEgD,UAAWhK,EAAAA,EAAAA,MAAA,QAAMjC,UAAU,8BAA6BgC,SAAA,CAAC,IAAEiH,EAAEgD,QAAQ,UAEzEzE,GAAmBsE,SAAS7C,EAAEa,MAAOvJ,EAAAA,EAAAA,KAACiV,EAAAA,EAAK,CAACxV,UAAU,8BAX7CiJ,EAAEa,QAelB7H,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,kDAAiDgC,SAAA,EAC9DC,EAAAA,EAAAA,MAAA,KAAGjC,UAAU,yBAAwBgC,SAAA,CAAEwF,GAAmBtE,OAAO,qEAAiBsE,GAAmBtE,OAAO,yBAC5GjB,EAAAA,EAAAA,MAAA,OAAKjC,UAAU,aAAYgC,SAAA,EACzBzB,EAAAA,EAAAA,KAACX,EAAAA,EAAM,CAACZ,QAAQ,UAAUuP,QAASA,IAAMhH,IAA2B,GAAOvF,SAAE2C,EAAE,aAC/E1C,EAAAA,EAAAA,MAACrC,EAAAA,EAAM,CAAC2O,QAtyBY5D,UAC9B,GAAKpE,GAAL,CACAL,IAAU,GACV,UACQmF,EAAAA,EAAMqK,IAAI,GAADjS,OAAID,EAAG,aAAAC,OAAY8C,GAAcuD,GAAE,aAAa,CAAEzE,SAAUmC,IAAsB,CAAEsB,aACnG7D,EAAWmH,GAAQA,EAAK/C,IAAI8E,GAAKA,EAAErE,KAAOvD,GAAcuD,IAAEtJ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQ2N,GAAC,IAAE9I,SAAUmC,KAAuB2G,IACtG3H,GAAiB4F,IAAI5L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAU4L,GAAI,IAAE/G,SAAUmC,MAC/C+E,EAAAA,GAAMqC,QAAQ,8KACdrH,IAA2B,EAC7B,CAAE,MAAO8E,GACPE,EAAAA,GAAMF,MAAM,0BACd,CAAC,QAAWnG,IAAU,EAAQ,CAVJ,GAqyB0BwJ,SAAUzJ,IAAwC,IAA9BuB,GAAmBtE,OAAclD,UAAU,0CAAyCgC,SAAA,CAC/IiE,IAAS1F,EAAAA,EAAAA,KAACoP,EAAAA,EAAO,CAAC3P,UAAU,0BAA4BO,EAAAA,EAAAA,KAACuT,EAAAA,EAAI,CAAC9T,UAAU,YAAa,IAAE2E,EAAE,wBAQ1G,C","sources":["components/ui/button.jsx","components/ui/card.jsx","components/ui/dialog.jsx","components/ui/input.jsx","components/ui/label.jsx","components/ui/tabs.jsx","lib/utils.js","pages/TimetableManagement.js"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-blue-500 text-white shadow-sm hover:bg-blue-600 rounded-lg\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90\",\n        outline:\n          \"border border-gray-200 bg-white shadow-sm hover:bg-gray-50 text-gray-700 rounded-lg\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2\",\n        sm: \"h-8 rounded-md px-3 text-xs\",\n        lg: \"h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Button = React.forwardRef(({ className, variant, size, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n  return (\n    <Comp\n      className={cn(buttonVariants({ variant, size, className }))}\n      ref={ref}\n      {...props} />\n  );\n})\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"rounded-xl border border-gray-200 bg-white text-gray-900 shadow-sm\", className)}\n    {...props} />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-5\", className)}\n    {...props} />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props} />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-5 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-5 pt-0\", className)}\n    {...props} />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props} />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}>\n      {children}\n      <DialogPrimitive.Close\n        className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col space-y-1.5 text-center sm:text-left\", className)}\n    {...props} />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className)}\n    {...props} />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold leading-none tracking-tight\", className)}\n    {...props} />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef(({ className, type, ...props }, ref) => {\n  return (\n    <input\n      type={type}\n      className={cn(\n        \"flex h-9 w-full rounded-md border border-input bg-white px-3 py-1 text-base text-gray-900 shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props} />\n  );\n})\nInput.displayName = \"Input\"\n\nexport { Input }\n","import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root ref={ref} className={cn(labelVariants(), className)} {...props} />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-gray-100 border border-gray-200 p-1 text-muted-foreground\",\n      className\n    )}\n    {...props} />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-blue-500\",\n      className\n    )}\n    {...props} />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props} />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","import { clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs) {\n  return twMerge(clsx(inputs));\n}\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../context/AuthContext';\nimport { Button } from '../components/ui/button';\nimport { Input } from '../components/ui/input';\nimport { Label } from '../components/ui/label';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '../components/ui/dialog';\nimport { Card, CardContent, CardHeader, CardTitle } from '../components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '../components/ui/tabs';\nimport {\n  Clock, Plus, Save, Loader2, Calendar, Users, BookOpen,\n  Edit, Trash2, Printer, AlertCircle, Check, X,\n  GraduationCap, User, Settings, RefreshCw, UserCheck\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport axios from 'axios';\n\nconst API = `${(process.env.REACT_APP_BACKEND_URL || '')}/api`;\n\nconst DAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\nconst DAYS_HI = ['', '', '', '', '', ''];\n\nconst SUBJECT_COLORS = {\n  'Hindi': 'bg-orange-100 border-orange-300 text-orange-800',\n  'English': 'bg-blue-100 border-blue-300 text-blue-800',\n  'Mathematics': 'bg-green-100 border-green-300 text-green-800',\n  'Science': 'bg-purple-100 border-purple-300 text-purple-800',\n  'Social Science': 'bg-yellow-100 border-yellow-300 text-yellow-800',\n  'Computer': 'bg-cyan-100 border-cyan-300 text-cyan-800',\n  'Physical Education': 'bg-red-100 border-red-300 text-red-800',\n  'Drawing': 'bg-pink-100 border-pink-300 text-pink-800',\n  'Music': 'bg-indigo-100 border-indigo-300 text-indigo-800',\n  'GK': 'bg-teal-100 border-teal-300 text-teal-800',\n  'Moral Science': 'bg-amber-100 border-amber-300 text-amber-800',\n  'Sanskrit': 'bg-rose-100 border-rose-300 text-rose-800',\n  'default': 'bg-slate-100 border-slate-300 text-slate-800'\n};\n\nconst DEFAULT_SETTINGS = {\n  normal_period_duration: 40,\n  first_period_extra_mins: 10,\n  school_start_time: '08:00',\n  break_duration: 15,\n  lunch_duration: 30,\n  break_after_period: 3,\n  lunch_after_period: 5,\n  periods_per_day: 8,\n  working_days: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']\n};\n\nconst getSubjectColor = (subjectName) => SUBJECT_COLORS[subjectName] || SUBJECT_COLORS.default;\n\nconst generateTimeSlots = (settings) => {\n  const s = { ...DEFAULT_SETTINGS, ...settings };\n  const slots = [];\n  let [h, m] = s.school_start_time.split(':').map(Number);\n  let periodNum = 1;\n\n  for (let i = 0; i < s.periods_per_day; i++) {\n    if (periodNum - 1 === s.break_after_period) {\n      const endM = m + s.break_duration;\n      const endH = h + Math.floor(endM / 60);\n      slots.push({\n        id: `break-${periodNum}`, label: 'Break / ', isBreak: true,\n        start: `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`,\n        end: `${String(endH).padStart(2,'0')}:${String(endM % 60).padStart(2,'0')}`\n      });\n      h = endH; m = endM % 60;\n    }\n    if (periodNum - 1 === s.lunch_after_period) {\n      const endM = m + s.lunch_duration;\n      const endH = h + Math.floor(endM / 60);\n      slots.push({\n        id: `lunch-${periodNum}`, label: 'Lunch / ', isBreak: true,\n        start: `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`,\n        end: `${String(endH).padStart(2,'0')}:${String(endM % 60).padStart(2,'0')}`\n      });\n      h = endH; m = endM % 60;\n    }\n\n    const dur = periodNum === 1 ? s.normal_period_duration + s.first_period_extra_mins : s.normal_period_duration;\n    const endM = m + dur;\n    const endH = h + Math.floor(endM / 60);\n    slots.push({\n      id: periodNum, label: `Period ${periodNum}`, isBreak: false,\n      start: `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`,\n      end: `${String(endH).padStart(2,'0')}:${String(endM % 60).padStart(2,'0')}`\n    });\n    h = endH; m = endM % 60;\n    periodNum++;\n  }\n  return slots;\n};\n\nexport default function TimetableManagement() {\n  const { t } = useTranslation();\n  const { schoolId, user } = useAuth();\n\n  const [classes, setClasses] = useState([]);\n  const [teachers, setTeachers] = useState([]);\n  const [subjects, setSubjects] = useState([]);\n  const [timetables, setTimetables] = useState({});\n  const [settings, setSettings] = useState(DEFAULT_SETTINGS);\n  const [substitutions, setSubstitutions] = useState([]);\n  const [subjectAllocations, setSubjectAllocations] = useState([]);\n\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [activeTab, setActiveTab] = useState('class');\n  const [selectedClass, setSelectedClass] = useState(null);\n  const [selectedTeacher, setSelectedTeacher] = useState(null);\n  const [subDate, setSubDate] = useState(new Date().toISOString().split('T')[0]);\n\n  const [showSlotDialog, setShowSlotDialog] = useState(false);\n  const [showAssignDialog, setShowAssignDialog] = useState(false);\n  const [showSubDialog, setShowSubDialog] = useState(false);\n  const [showSubjectAssignDialog, setShowSubjectAssignDialog] = useState(false);\n  const [selectedSubjectIds, setSelectedSubjectIds] = useState([]);\n  const [assignTeacherId, setAssignTeacherId] = useState('');\n  const [slotForm, setSlotForm] = useState({ day: '', period: '', subject_id: '', teacher_id: '', room: '' });\n  const [subForm, setSubForm] = useState({ class_id: '', period_id: '', original_teacher_id: '', substitute_teacher_id: '', reason: '', is_homeroom: false });\n\n  const token = localStorage.getItem('token');\n  const headers = { Authorization: `Bearer ${token}` };\n\n  const timeSlots = generateTimeSlots(settings);\n  const periods = timeSlots.filter(s => !s.isBreak);\n  const workingDays = settings.working_days || DAYS;\n\n  const fetchAllData = useCallback(async () => {\n    if (!schoolId) return;\n    setLoading(true);\n    try {\n      const [classRes, staffRes, subjectRes, ttRes, settingsRes, allocRes] = await Promise.all([\n        axios.get(`${API}/classes?school_id=${schoolId}`, { headers }).catch(() => ({ data: [] })),\n        axios.get(`${API}/staff?school_id=${schoolId}`, { headers }).catch(() => ({ data: [] })),\n        axios.get(`${API}/subjects?school_id=${schoolId}`, { headers }).catch(() => ({ data: [] })),\n        axios.get(`${API}/timetables?school_id=${schoolId}`, { headers }).catch(() => ({ data: {} })),\n        axios.get(`${API}/timetable-settings?school_id=${schoolId}`, { headers }).catch(() => ({ data: null })),\n        axios.get(`${API}/subject-allocations?school_id=${schoolId}`, { headers }).catch(() => ({ data: [] }))\n      ]);\n\n      const cls = classRes.data || [];\n      setClasses(cls);\n      setTeachers((staffRes.data || []).filter(t => t.role === 'teacher' || t.designation?.toLowerCase().includes('teacher')));\n\n      const defaultSubjects = [\n        { id: 'hindi', name: 'Hindi', name_hi: '' },\n        { id: 'english', name: 'English', name_hi: '' },\n        { id: 'math', name: 'Mathematics', name_hi: '' },\n        { id: 'science', name: 'Science', name_hi: '' },\n        { id: 'sst', name: 'Social Science', name_hi: ' ' },\n        { id: 'computer', name: 'Computer', name_hi: '' },\n        { id: 'pe', name: 'Physical Education', name_hi: ' ' },\n        { id: 'drawing', name: 'Drawing', name_hi: '' },\n        { id: 'music', name: 'Music', name_hi: '' },\n        { id: 'gk', name: 'GK', name_hi: ' ' },\n        { id: 'moral', name: 'Moral Science', name_hi: ' ' },\n        { id: 'sanskrit', name: 'Sanskrit', name_hi: '' }\n      ];\n      setSubjects(subjectRes.data?.length > 0 ? subjectRes.data : defaultSubjects);\n      setTimetables(ttRes.data || {});\n      if (settingsRes.data && Object.keys(settingsRes.data).length > 0) {\n        setSettings(prev => ({ ...prev, ...settingsRes.data }));\n      }\n      setSubjectAllocations(allocRes.data || []);\n      if (cls.length > 0 && !selectedClass) setSelectedClass(cls[0]);\n    } catch (error) {\n      console.error('Error fetching data:', error);\n      toast.error('Failed to load data');\n    } finally {\n      setLoading(false);\n    }\n  }, [schoolId]);\n\n  const fetchSubstitutions = useCallback(async () => {\n    if (!schoolId) return;\n    try {\n      const res = await axios.get(`${API}/substitutions?school_id=${schoolId}&date=${subDate}`, { headers }).catch(() => ({ data: [] }));\n      setSubstitutions(res.data || []);\n    } catch { setSubstitutions([]); }\n  }, [schoolId, subDate]);\n\n  useEffect(() => { fetchAllData(); }, [fetchAllData]);\n  useEffect(() => { fetchSubstitutions(); }, [fetchSubstitutions]);\n\n  const getClassTeacherInfo = (classObj) => {\n    if (!classObj) return null;\n    const ctId = classObj.class_teacher_id || classObj.classTeacherId;\n    if (ctId) {\n      const teacher = teachers.find(t => t.id === ctId || t._id === ctId);\n      if (teacher) {\n        const alloc = subjectAllocations.find(a =>\n          (a.teacher_id === teacher.id || a.teacher_id === teacher._id) &&\n          (a.class_id === classObj.id || a.class_id === classObj._id)\n        );\n        return { teacher, subjectName: alloc?.subject_name || teacher.subject || null, subjectId: alloc?.subject_id || null };\n      }\n    }\n    if (classObj.class_teacher) {\n      const teacher = teachers.find(t => t.name === classObj.class_teacher);\n      if (teacher) return { teacher, subjectName: teacher.subject || null, subjectId: null };\n    }\n    return null;\n  };\n\n  const isTeacherBusy = (teacherId, day, periodId) => {\n    for (const [classId, classTT] of Object.entries(timetables)) {\n      if (classTT[day]?.[periodId]?.teacher_id === teacherId && selectedClass?.id !== classId) {\n        return classes.find(c => c.id === classId)?.name || 'Another class';\n      }\n    }\n    return null;\n  };\n\n  const getTeacherSchedule = (teacherId) => {\n    const schedule = {};\n    Object.entries(timetables).forEach(([classId, classTT]) => {\n      Object.entries(classTT).forEach(([day, dayPeriods]) => {\n        Object.entries(dayPeriods).forEach(([pId, slot]) => {\n          if (slot.teacher_id === teacherId) {\n            if (!schedule[day]) schedule[day] = {};\n            schedule[day][pId] = { ...slot, class_id: classId, class_name: classes.find(c => c.id === classId)?.name };\n          }\n        });\n      });\n    });\n    return schedule;\n  };\n\n  const getClassSubjects = () => {\n    if (!selectedClass) return subjects;\n    const classSubjectIds = selectedClass.subjects;\n    if (classSubjectIds && classSubjectIds.length > 0) {\n      return subjects.filter(s => classSubjectIds.includes(s.id));\n    }\n    return subjects;\n  };\n\n  const handleOpenSubjectAssign = () => {\n    setSelectedSubjectIds(selectedClass?.subjects || []);\n    setShowSubjectAssignDialog(true);\n  };\n\n  const handleSaveClassSubjects = async () => {\n    if (!selectedClass) return;\n    setSaving(true);\n    try {\n      await axios.put(`${API}/classes/${selectedClass.id}/subjects`, { subjects: selectedSubjectIds }, { headers });\n      setClasses(prev => prev.map(c => c.id === selectedClass.id ? { ...c, subjects: selectedSubjectIds } : c));\n      setSelectedClass(prev => ({ ...prev, subjects: selectedSubjectIds }));\n      toast.success('Subjects assigned successfully! /    !');\n      setShowSubjectAssignDialog(false);\n    } catch (error) {\n      toast.error('Failed to save subjects');\n    } finally { setSaving(false); }\n  };\n\n  const toggleSubjectSelection = (subjectId) => {\n    setSelectedSubjectIds(prev =>\n      prev.includes(subjectId) ? prev.filter(id => id !== subjectId) : [...prev, subjectId]\n    );\n  };\n\n  const handleSlotClick = (day, period) => {\n    if (period.id === 1) return;\n    const slot = timetables[selectedClass?.id]?.[day]?.[period.id] || {};\n    setSlotForm({ day, period: period.id, subject_id: slot.subject_id || '', teacher_id: slot.teacher_id || '', room: slot.room || '' });\n    setShowSlotDialog(true);\n  };\n\n  const handleSaveSlot = async () => {\n    if (!slotForm.subject_id) { toast.error('Please select a subject'); return; }\n    if (slotForm.teacher_id) {\n      const busy = isTeacherBusy(slotForm.teacher_id, slotForm.day, slotForm.period);\n      if (busy) { toast.error(`Teacher already busy in ${busy}`); return; }\n    }\n    setSaving(true);\n    try {\n      const subject = subjects.find(s => s.id === slotForm.subject_id);\n      const teacher = teachers.find(t => t.id === slotForm.teacher_id);\n      await axios.post(`${API}/timetables/slot`, {\n        school_id: schoolId, class_id: selectedClass.id, day: slotForm.day,\n        period_id: slotForm.period, subject_id: slotForm.subject_id, subject_name: subject?.name,\n        teacher_id: slotForm.teacher_id, teacher_name: teacher?.name, room: slotForm.room\n      }, { headers });\n      setTimetables(prev => ({\n        ...prev,\n        [selectedClass.id]: {\n          ...prev[selectedClass.id],\n          [slotForm.day]: {\n            ...prev[selectedClass.id]?.[slotForm.day],\n            [slotForm.period]: { subject_id: slotForm.subject_id, subject_name: subject?.name, teacher_id: slotForm.teacher_id, teacher_name: teacher?.name, room: slotForm.room }\n          }\n        }\n      }));\n      toast.success('Period saved!');\n      setShowSlotDialog(false);\n    } catch (error) {\n      toast.error(error.response?.data?.detail || 'Failed to save period');\n    } finally { setSaving(false); }\n  };\n\n  const handleDeleteSlot = async () => {\n    setSaving(true);\n    try {\n      await axios.delete(`${API}/timetables/slot`, { headers, data: { school_id: schoolId, class_id: selectedClass.id, day: slotForm.day, period_id: slotForm.period } });\n      setTimetables(prev => {\n        const n = { ...prev };\n        if (n[selectedClass.id]?.[slotForm.day]) delete n[selectedClass.id][slotForm.day][slotForm.period];\n        return n;\n      });\n      toast.success('Period removed');\n      setShowSlotDialog(false);\n    } catch { toast.error('Failed to remove'); }\n    finally { setSaving(false); }\n  };\n\n  const handleAssignClassTeacher = async () => {\n    if (!assignTeacherId || !selectedClass) return;\n    setSaving(true);\n    try {\n      const res = await axios.post(`${API}/class-teacher/assign`, { school_id: schoolId, class_id: selectedClass.id, teacher_id: assignTeacherId }, { headers });\n      toast.success(res.data?.message || 'Class teacher assigned! Homeroom entries created.');\n      setShowAssignDialog(false);\n      setAssignTeacherId('');\n      fetchAllData();\n    } catch (error) {\n      toast.error(error.response?.data?.detail || 'Failed to assign class teacher');\n    } finally { setSaving(false); }\n  };\n\n  const handleGenerateTimetable = async () => {\n    if (!selectedClass) { toast.error('Select a class first'); return; }\n    setGenerating(true);\n    try {\n      try {\n        const res = await axios.post(`${API}/timetable/generate`, { school_id: schoolId, class_id: selectedClass.id || selectedClass._id }, { headers });\n        if (res.data?.timetable) {\n          setTimetables(prev => ({ ...prev, [selectedClass.id || selectedClass._id]: res.data.timetable }));\n          toast.success('Timetable generated!');\n          setGenerating(false);\n          return;\n        }\n      } catch { /* fallback to local */ }\n\n      const classId = selectedClass.id || selectedClass._id;\n      const ct = getClassTeacherInfo(selectedClass);\n      const avail = subjects.filter(s => s.id && s.name);\n      const newTT = {};\n\n      workingDays.forEach(day => {\n        newTT[day] = {};\n        const shuffled = [...avail].sort(() => Math.random() - 0.5);\n        let si = 0;\n\n        periods.forEach((period) => {\n          if (period.id === 1 && ct?.teacher) {\n            newTT[day][1] = { subject_id: 'homeroom', subject_name: 'Homeroom', teacher_id: ct.teacher.id || ct.teacher._id, teacher_name: ct.teacher.name, room: '', is_homeroom: true };\n            return;\n          }\n          const sub = shuffled[si % shuffled.length];\n          si++;\n          const teacher = teachers.find(t => {\n            return subjectAllocations.find(a => (a.teacher_id === t.id || a.teacher_id === t._id) && (a.class_id === classId) && (a.subject_name === sub?.name || a.subject_id === sub?.id));\n          }) || teachers[Math.floor(Math.random() * (teachers.length || 1))] || null;\n\n          if (sub) {\n            newTT[day][period.id] = { subject_id: sub.id, subject_name: sub.name, teacher_id: teacher?.id || '', teacher_name: teacher?.name || '', room: '' };\n          }\n        });\n      });\n\n      setTimetables(prev => ({ ...prev, [classId]: newTT }));\n      try { await axios.post(`${API}/timetables/bulk`, { school_id: schoolId, class_id: classId, timetable: newTT }, { headers }); } catch {}\n      toast.success(ct?.subjectName ? `Generated! Class teacher in Period 1 homeroom` : 'Timetable generated!');\n    } catch { toast.error('Failed to generate'); }\n    finally { setGenerating(false); }\n  };\n\n  const handleSaveSettings = async () => {\n    setSaving(true);\n    try {\n      await axios.post(`${API}/timetable-settings`, { school_id: schoolId, ...settings }, { headers });\n      toast.success('Settings saved!');\n    } catch { toast.error('Failed to save settings'); }\n    finally { setSaving(false); }\n  };\n\n  const handleAddSubstitution = async () => {\n    if (!subForm.class_id || !subForm.period_id || !subForm.substitute_teacher_id) {\n      toast.error('Please fill all required fields'); return;\n    }\n    setSaving(true);\n    try {\n      await axios.post(`${API}/substitutions`, {\n        school_id: schoolId, class_id: subForm.class_id, date: subDate,\n        period_id: parseInt(subForm.period_id), original_teacher_id: subForm.original_teacher_id,\n        substitute_teacher_id: subForm.substitute_teacher_id, reason: subForm.reason,\n        is_homeroom: subForm.period_id === '1' || subForm.period_id === 1\n      }, { headers });\n      toast.success('Substitution added!');\n      setShowSubDialog(false);\n      setSubForm({ class_id: '', period_id: '', original_teacher_id: '', substitute_teacher_id: '', reason: '', is_homeroom: false });\n      fetchSubstitutions();\n    } catch (error) {\n      toast.error(error.response?.data?.detail || 'Failed to add substitution');\n    } finally { setSaving(false); }\n  };\n\n  const handleDeleteSubstitution = async (subId) => {\n    try {\n      await axios.delete(`${API}/substitutions/${subId}`, { headers });\n      toast.success('Substitution removed');\n      fetchSubstitutions();\n    } catch { toast.error('Failed to remove'); }\n  };\n\n  const handlePrint = () => {\n    const el = document.getElementById('timetable-grid');\n    if (!el) return;\n    const w = window.open('', '_blank');\n    w.document.write(`<html><head><title>Timetable</title><style>\n      body{font-family:Arial,sans-serif;padding:20px}\n      h1{text-align:center}table{width:100%;border-collapse:collapse;margin-top:20px}\n      th,td{border:1px solid #ddd;padding:8px;text-align:center;font-size:11px}\n      th{background:#f5f5f5;font-weight:bold}.homeroom{background:#dbeafe}\n      @media print{body{-webkit-print-color-adjust:exact}}\n    </style></head><body>\n      <h1>${activeTab === 'class' ? selectedClass?.name : selectedTeacher?.name} - Timetable</h1>\n      ${el.outerHTML}\n      <script>window.onload=()=>window.print();<\\/script>\n    </body></html>`);\n    w.document.close();\n  };\n\n  if (!schoolId) return <div className=\"text-center py-20\"><p className=\"text-slate-500\">{t('select_class')}</p></div>;\n\n  const classTT = timetables[selectedClass?.id] || {};\n  const classTeacher = selectedClass ? getClassTeacherInfo(selectedClass) : null;\n\n  return (\n    <div className=\"space-y-6\" data-testid=\"timetable-management\">\n      <div className=\"flex items-center justify-between flex-wrap gap-3\">\n        <div>\n          <h1 className=\"text-3xl font-bold font-heading text-slate-900 flex items-center gap-2\">\n            <Clock className=\"w-8 h-8 text-indigo-600\" />\n            {t('timetable')}\n          </h1>\n          <p className=\"text-slate-500 mt-1\">{t('view_timetable')}</p>\n        </div>\n        <div className=\"flex gap-2\">\n          {activeTab === 'class' && (\n            <>\n              <Button onClick={handleGenerateTimetable} disabled={generating || !selectedClass} className=\"gap-2 bg-indigo-600 hover:bg-indigo-700\">\n                {generating ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Calendar className=\"w-4 h-4\" />}\n                {generating ? t('loading') : t('create_timetable')}\n              </Button>\n              <Button variant=\"outline\" onClick={handlePrint} className=\"gap-2\">\n                <Printer className=\"w-4 h-4\" /> {t('print')}\n              </Button>\n            </>\n          )}\n        </div>\n      </div>\n\n      <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-4 max-w-2xl\">\n          <TabsTrigger value=\"class\" className=\"gap-1.5\">\n            <GraduationCap className=\"w-4 h-4\" /> {t('timetable')}\n          </TabsTrigger>\n          <TabsTrigger value=\"teacher\" className=\"gap-1.5\">\n            <User className=\"w-4 h-4\" /> {t('teacher')}\n          </TabsTrigger>\n          <TabsTrigger value=\"substitutions\" className=\"gap-1.5\">\n            <RefreshCw className=\"w-4 h-4\" /> {t('substitution')}\n          </TabsTrigger>\n          <TabsTrigger value=\"settings\" className=\"gap-1.5\">\n            <Settings className=\"w-4 h-4\" /> {t('settings')}\n          </TabsTrigger>\n        </TabsList>\n\n        {/* ============ CLASS TIMETABLE TAB ============ */}\n        <TabsContent value=\"class\" className=\"mt-4\">\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between flex-wrap gap-3\">\n                <CardTitle>{t('timetable')}</CardTitle>\n                <div className=\"flex items-center gap-3 flex-wrap\">\n                  <div className=\"flex items-center gap-2\">\n                    <Label>{t('select_class')}:</Label>\n                    <select\n                      className=\"border rounded-md px-3 py-2 text-sm bg-white min-w-[160px]\"\n                      value={selectedClass?.id || ''}\n                      onChange={e => setSelectedClass(classes.find(c => c.id === e.target.value))}\n                    >\n                      {classes.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\n                    </select>\n                  </div>\n\n                  {classTeacher ? (\n                    <div className=\"flex items-center gap-2 bg-blue-50 border border-blue-200 rounded-lg px-3 py-1.5\">\n                      <UserCheck className=\"w-4 h-4 text-blue-600\" />\n                      <span className=\"text-sm font-medium text-blue-800\">{t('class_teacher')}: {classTeacher.teacher.name}</span>\n                    </div>\n                  ) : (\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => setShowAssignDialog(true)} className=\"gap-1.5 border-amber-300 text-amber-700 hover:bg-amber-50\">\n                      <AlertCircle className=\"w-4 h-4\" /> {t('class_teacher')}\n                    </Button>\n                  )}\n\n                  <Button size=\"sm\" variant=\"ghost\" onClick={() => setShowAssignDialog(true)} className=\"gap-1\">\n                    <Edit className=\"w-3.5 h-3.5\" /> {t('edit')}\n                  </Button>\n                  <Button size=\"sm\" variant=\"outline\" onClick={handleOpenSubjectAssign} className=\"gap-1.5 border-indigo-300 text-indigo-700 hover:bg-indigo-50\">\n                    <BookOpen className=\"w-3.5 h-3.5\" />\n                    {selectedClass?.subjects?.length > 0 ? `${t('subjects')} (${selectedClass.subjects.length})` : t('subjects')}\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {loading ? (\n                <div className=\"flex justify-center py-20\"><Loader2 className=\"w-8 h-8 animate-spin text-indigo-600\" /></div>\n              ) : (\n                <div className=\"overflow-x-auto\" id=\"timetable-grid\">\n                  <table className=\"w-full border-collapse min-w-[800px]\">\n                    <thead>\n                      <tr>\n                        <th className=\"border border-slate-200 bg-slate-100 p-2 text-sm font-semibold w-28\">Day / </th>\n                        {timeSlots.map(slot => (\n                          <th key={slot.id} className={`border border-slate-200 p-2 text-xs font-semibold ${slot.isBreak ? 'bg-amber-50' : slot.id === 1 ? 'bg-blue-100 border-blue-300' : 'bg-slate-100'}`}>\n                            <div>{slot.label}</div>\n                            <div className=\"text-[10px] text-slate-500 font-normal\">{slot.start} - {slot.end}</div>\n                            {slot.id === 1 && (\n                              <span className=\"inline-block mt-0.5 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-blue-200 text-blue-700\">+{settings.first_period_extra_mins} min</span>\n                            )}\n                          </th>\n                        ))}\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {workingDays.map((day, di) => (\n                        <tr key={day}>\n                          <td className=\"border border-slate-200 bg-slate-50 p-2 text-sm font-medium\">\n                            <div>{day}</div>\n                            <div className=\"text-[10px] text-slate-400\">{DAYS_HI[DAYS.indexOf(day)]}</div>\n                          </td>\n                          {timeSlots.map(slot => {\n                            if (slot.isBreak) {\n                              return (\n                                <td key={slot.id} className=\"border border-amber-200 bg-amber-50 p-2 text-center\">\n                                  <span className=\"text-xs text-amber-600 font-medium\">{slot.label}</span>\n                                </td>\n                              );\n                            }\n\n                            if (slot.id === 1) {\n                              const ctName = classTeacher?.teacher?.name || 'Not Assigned';\n                              return (\n                                <td key={slot.id} className=\"border-2 border-blue-300 bg-blue-50 p-2 cursor-not-allowed\" title=\"Reserved for Class Teacher - Attendance Period (+10 mins)\">\n                                  <div className=\"flex flex-col items-center gap-0.5\">\n                                    <span className=\"text-lg\"></span>\n                                    <span className=\"text-xs font-bold text-blue-800\">{t('homeroom')}</span>\n                                    <span className=\"text-[10px] text-blue-600\"></span>\n                                    <span className=\"text-[10px] text-blue-700 font-medium truncate max-w-[80px]\">{ctName}</span>\n                                    <span className=\"inline-block px-1 py-0.5 rounded-full text-[8px] font-bold bg-blue-200 text-blue-700\">+{settings.first_period_extra_mins} min</span>\n                                  </div>\n                                </td>\n                              );\n                            }\n\n                            const cellData = classTT[day]?.[slot.id];\n                            return (\n                              <td\n                                key={slot.id}\n                                className={`border border-slate-200 p-1.5 text-center cursor-pointer hover:bg-slate-50 transition-colors ${cellData ? getSubjectColor(cellData.subject_name) : ''}`}\n                                onClick={() => handleSlotClick(day, slot)}\n                              >\n                                {cellData ? (\n                                  <div className=\"flex flex-col items-center gap-0.5\">\n                                    <span className=\"text-xs font-semibold\">{cellData.subject_name}</span>\n                                    <span className=\"text-[10px] text-slate-500\">{cellData.teacher_name}</span>\n                                  </div>\n                                ) : (\n                                  <span className=\"text-slate-300 text-xs\">+ {t('add')}</span>\n                                )}\n                              </td>\n                            );\n                          })}\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              )}\n\n              <div className=\"mt-4 flex flex-wrap gap-2\">\n                {Object.keys(SUBJECT_COLORS).filter(k => k !== 'default').map(sub => (\n                  <span key={sub} className={`px-2 py-0.5 rounded text-[10px] font-medium border ${SUBJECT_COLORS[sub]}`}>{sub}</span>\n                ))}\n                <span className=\"px-2 py-0.5 rounded text-[10px] font-medium border bg-blue-100 border-blue-300 text-blue-800\"> {t('homeroom')}</span>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* ============ TEACHER SCHEDULE TAB ============ */}\n        <TabsContent value=\"teacher\" className=\"mt-4\">\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between flex-wrap gap-3\">\n                <CardTitle>{t('teacher')}</CardTitle>\n                <div className=\"flex items-center gap-2\">\n                  <Label>{t('teacher')}:</Label>\n                  <select\n                    className=\"border rounded-md px-3 py-2 text-sm bg-white min-w-[200px]\"\n                    value={selectedTeacher?.id || ''}\n                    onChange={e => setSelectedTeacher(teachers.find(t => t.id === e.target.value))}\n                  >\n                    <option value=\"\">-- {t('subject_teacher')} --</option>\n                    {teachers.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}\n                  </select>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {!selectedTeacher ? (\n                <div className=\"text-center py-12 text-slate-400\"><Users className=\"w-12 h-12 mx-auto mb-3 opacity-40\" /><p>{t('subject_teacher')}</p></div>\n              ) : (() => {\n                const schedule = getTeacherSchedule(selectedTeacher.id);\n                const isClassTeacherOf = classes.filter(c => {\n                  const ctId = c.class_teacher_id || c.classTeacherId;\n                  return ctId === selectedTeacher.id || ctId === selectedTeacher._id || c.class_teacher === selectedTeacher.name;\n                });\n\n                return (\n                  <div>\n                    {isClassTeacherOf.length > 0 && (\n                      <div className=\"mb-3 flex gap-2 flex-wrap\">\n                        {isClassTeacherOf.map(c => (\n                          <span key={c.id} className=\"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700 border border-blue-200\">\n                            {t('class_teacher')}: {c.name}\n                          </span>\n                        ))}\n                      </div>\n                    )}\n                    <div className=\"overflow-x-auto\">\n                      <table className=\"w-full border-collapse min-w-[800px]\">\n                        <thead>\n                          <tr>\n                            <th className=\"border border-slate-200 bg-slate-100 p-2 text-sm font-semibold w-28\">{t('date')}</th>\n                            {periods.map(p => (\n                              <th key={p.id} className={`border border-slate-200 p-2 text-xs font-semibold ${p.id === 1 ? 'bg-blue-100 border-blue-300' : 'bg-slate-100'}`}>\n                                <div>{p.label}</div>\n                                <div className=\"text-[10px] text-slate-500\">{p.start}-{p.end}</div>\n                                {p.id === 1 && <span className=\"inline-block mt-0.5 px-1 rounded-full text-[9px] font-bold bg-blue-200 text-blue-700\">+{settings.first_period_extra_mins}m</span>}\n                              </th>\n                            ))}\n                          </tr>\n                        </thead>\n                        <tbody>\n                          {workingDays.map((day, di) => (\n                            <tr key={day}>\n                              <td className=\"border border-slate-200 bg-slate-50 p-2 text-sm font-medium\">\n                                <div>{day}</div>\n                                <div className=\"text-[10px] text-slate-400\">{DAYS_HI[DAYS.indexOf(day)]}</div>\n                              </td>\n                              {periods.map(p => {\n                                const slot = schedule[day]?.[p.id];\n                                const isHomeroom = p.id === 1 && isClassTeacherOf.length > 0;\n\n                                if (isHomeroom) {\n                                  return (\n                                    <td key={p.id} className=\"border-2 border-blue-300 bg-blue-50 p-2\">\n                                      <div className=\"flex flex-col items-center gap-0.5\">\n                                        <span className=\"text-lg\"></span>\n                                        <span className=\"px-1.5 py-0.5 rounded text-[9px] font-bold bg-blue-600 text-white\">{t('homeroom')}</span>\n                                        <span className=\"text-[10px] text-blue-700\">{isClassTeacherOf.map(c => c.name).join(', ')}</span>\n                                      </div>\n                                    </td>\n                                  );\n                                }\n\n                                return (\n                                  <td key={p.id} className={`border border-slate-200 p-1.5 text-center ${slot ? getSubjectColor(slot.subject_name) : 'bg-green-50'}`}>\n                                    {slot ? (\n                                      <div className=\"flex flex-col items-center gap-0.5\">\n                                        <span className=\"text-xs font-semibold\">{slot.subject_name}</span>\n                                        <span className=\"text-[10px] text-slate-500\">{slot.class_name}</span>\n                                      </div>\n                                    ) : (\n                                      <span className=\"text-green-500 text-xs font-medium\">{t('available')}</span>\n                                    )}\n                                  </td>\n                                );\n                              })}\n                            </tr>\n                          ))}\n                        </tbody>\n                      </table>\n                    </div>\n                  </div>\n                );\n              })()}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* ============ SUBSTITUTIONS TAB ============ */}\n        <TabsContent value=\"substitutions\" className=\"mt-4\">\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between flex-wrap gap-3\">\n                <CardTitle>{t('substitution')}</CardTitle>\n                <div className=\"flex items-center gap-3\">\n                  <Input type=\"date\" value={subDate} onChange={e => setSubDate(e.target.value)} className=\"w-40\" />\n                  <Button onClick={() => { setSubForm({ class_id: '', period_id: '', original_teacher_id: '', substitute_teacher_id: '', reason: '', is_homeroom: false }); setShowSubDialog(true); }} className=\"gap-1.5 bg-indigo-600 hover:bg-indigo-700\">\n                    <Plus className=\"w-4 h-4\" /> {t('assign_substitute')}\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {substitutions.length === 0 ? (\n                <div className=\"text-center py-12 text-slate-400\">\n                  <RefreshCw className=\"w-12 h-12 mx-auto mb-3 opacity-40\" />\n                  <p>{t('no_data')}</p>\n                </div>\n              ) : (\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full border-collapse\">\n                    <thead>\n                      <tr className=\"bg-slate-50\">\n                        <th className=\"border border-slate-200 p-2 text-sm text-left\">{t('classes')}</th>\n                        <th className=\"border border-slate-200 p-2 text-sm text-left\">{t('period')}</th>\n                        <th className=\"border border-slate-200 p-2 text-sm text-left\">{t('teacher')}</th>\n                        <th className=\"border border-slate-200 p-2 text-sm text-left\">{t('substitution')}</th>\n                        <th className=\"border border-slate-200 p-2 text-sm text-left\">{t('reason')}</th>\n                        <th className=\"border border-slate-200 p-2 text-sm text-center w-20\">{t('actions')}</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {substitutions.map(sub => {\n                        const cls = classes.find(c => c.id === sub.class_id);\n                        const origT = teachers.find(t => t.id === sub.original_teacher_id);\n                        const subT = teachers.find(t => t.id === sub.substitute_teacher_id);\n                        return (\n                          <tr key={sub.id || sub._id} className=\"hover:bg-slate-50\">\n                            <td className=\"border border-slate-200 p-2 text-sm\">{cls?.name || sub.class_id}</td>\n                            <td className=\"border border-slate-200 p-2 text-sm\">\n                              {t('period')} {sub.period_id}\n                              {(sub.is_homeroom || sub.period_id === 1) && <span className=\"ml-1 px-1.5 py-0.5 rounded text-[9px] font-bold bg-blue-100 text-blue-700\">{t('homeroom')}</span>}\n                            </td>\n                            <td className=\"border border-slate-200 p-2 text-sm\">{origT?.name || sub.original_teacher_name || '-'}</td>\n                            <td className=\"border border-slate-200 p-2 text-sm font-medium text-green-700\">{subT?.name || sub.substitute_teacher_name || '-'}</td>\n                            <td className=\"border border-slate-200 p-2 text-sm text-slate-500\">{sub.reason || '-'}</td>\n                            <td className=\"border border-slate-200 p-2 text-center\">\n                              <Button size=\"sm\" variant=\"ghost\" className=\"text-red-500 hover:text-red-700 h-7 w-7 p-0\" onClick={() => handleDeleteSubstitution(sub.id || sub._id)}>\n                                <Trash2 className=\"w-3.5 h-3.5\" />\n                              </Button>\n                            </td>\n                          </tr>\n                        );\n                      })}\n                    </tbody>\n                  </table>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* ============ SETTINGS TAB ============ */}\n        <TabsContent value=\"settings\" className=\"mt-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\"><Settings className=\"w-5 h-5\" /> {t('settings')}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"space-y-4\">\n                  <div>\n                    <Label>{t('period')} ({t('time_slot')})</Label>\n                    <Input type=\"number\" min={20} max={90} value={settings.normal_period_duration} onChange={e => setSettings(s => ({ ...s, normal_period_duration: parseInt(e.target.value) || 40 }))} />\n                  </div>\n                  <div>\n                    <Label>{t('start_time')}</Label>\n                    <Input type=\"number\" min={0} max={30} value={settings.first_period_extra_mins} onChange={e => setSettings(s => ({ ...s, first_period_extra_mins: parseInt(e.target.value) || 10 }))} />\n                    <p className=\"text-xs text-slate-400 mt-1\">Period 1 = {settings.normal_period_duration + settings.first_period_extra_mins} mins (Homeroom / )</p>\n                  </div>\n                  <div>\n                    <Label>{t('start_time')}</Label>\n                    <Input type=\"time\" value={settings.school_start_time} onChange={e => setSettings(s => ({ ...s, school_start_time: e.target.value }))} />\n                  </div>\n                  <div>\n                    <Label>{t('period')}</Label>\n                    <Input type=\"number\" min={4} max={12} value={settings.periods_per_day} onChange={e => setSettings(s => ({ ...s, periods_per_day: parseInt(e.target.value) || 8 }))} />\n                  </div>\n                </div>\n\n                <div className=\"space-y-4\">\n                  <div>\n                    <Label>{t('break_time')}</Label>\n                    <Input type=\"number\" min={5} max={30} value={settings.break_duration} onChange={e => setSettings(s => ({ ...s, break_duration: parseInt(e.target.value) || 15 }))} />\n                  </div>\n                  <div>\n                    <Label>{t('lunch')}</Label>\n                    <Input type=\"number\" min={15} max={60} value={settings.lunch_duration} onChange={e => setSettings(s => ({ ...s, lunch_duration: parseInt(e.target.value) || 30 }))} />\n                  </div>\n                  <div>\n                    <Label>{t('break_time')}</Label>\n                    <Input type=\"number\" min={1} max={10} value={settings.break_after_period} onChange={e => setSettings(s => ({ ...s, break_after_period: parseInt(e.target.value) || 3 }))} />\n                  </div>\n                  <div>\n                    <Label>{t('lunch')}</Label>\n                    <Input type=\"number\" min={1} max={10} value={settings.lunch_after_period} onChange={e => setSettings(s => ({ ...s, lunch_after_period: parseInt(e.target.value) || 5 }))} />\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"mt-6\">\n                <Label className=\"mb-2 block\">{t('working_days')}</Label>\n                <div className=\"flex flex-wrap gap-3\">\n                  {DAYS.map((day, i) => (\n                    <label key={day} className=\"flex items-center gap-2 cursor-pointer\">\n                      <input\n                        type=\"checkbox\"\n                        checked={settings.working_days?.includes(day)}\n                        onChange={e => {\n                          setSettings(s => ({\n                            ...s,\n                            working_days: e.target.checked\n                              ? [...(s.working_days || []), day]\n                              : (s.working_days || []).filter(d => d !== day)\n                          }));\n                        }}\n                        className=\"rounded border-slate-300\"\n                      />\n                      <span className=\"text-sm\">{day} <span className=\"text-slate-400 text-xs\">({DAYS_HI[i]})</span></span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n\n              <div className=\"mt-6\">\n                <Button onClick={handleSaveSettings} disabled={saving} className=\"gap-2 bg-indigo-600 hover:bg-indigo-700\">\n                  {saving ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Save className=\"w-4 h-4\" />}\n                  {t('save_settings')}\n                </Button>\n              </div>\n\n              <div className=\"mt-8 border-t pt-6\">\n                <h3 className=\"text-sm font-semibold text-slate-700 mb-3\">{t('time_slot')}</h3>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\n                  {timeSlots.map(slot => (\n                    <div key={slot.id} className={`p-2 rounded-lg border text-center text-xs ${slot.isBreak ? 'bg-amber-50 border-amber-200' : slot.id === 1 ? 'bg-blue-50 border-blue-200' : 'bg-white border-slate-200'}`}>\n                      <div className=\"font-medium\">{slot.label}</div>\n                      <div className=\"text-slate-500\">{slot.start} - {slot.end}</div>\n                      {slot.id === 1 && <span className=\"text-[9px] text-blue-600 font-bold\">{t('homeroom')} +{settings.first_period_extra_mins}m</span>}\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      {/* ============ SLOT EDIT DIALOG ============ */}\n      <Dialog open={showSlotDialog} onOpenChange={setShowSlotDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>{t('period')}</DialogTitle>\n            <DialogDescription>{slotForm.day} - {t('period')} {slotForm.period}</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label>{t('subject')}</Label>\n              {(!selectedClass?.subjects || selectedClass.subjects.length === 0) && (\n                <p className=\"text-xs text-amber-600 mb-1 flex items-center gap-1\">\n                  <AlertCircle className=\"w-3 h-3\" />\n                              \"Assign Subjects\"  \n                </p>\n              )}\n              <select className=\"w-full border rounded-md px-3 py-2 text-sm bg-white\" value={slotForm.subject_id} onChange={e => setSlotForm(f => ({ ...f, subject_id: e.target.value }))}>\n                <option value=\"\">-- {t('subject')} --</option>\n                {getClassSubjects().map(s => <option key={s.id} value={s.id}>{s.name}{s.name_hi ? ` (${s.name_hi})` : ''}</option>)}\n              </select>\n            </div>\n            <div>\n              <Label>{t('teacher')}</Label>\n              <select className=\"w-full border rounded-md px-3 py-2 text-sm bg-white\" value={slotForm.teacher_id} onChange={e => setSlotForm(f => ({ ...f, teacher_id: e.target.value }))}>\n                <option value=\"\">-- {t('teacher')} --</option>\n                {teachers.map(t => {\n                  const busy = isTeacherBusy(t.id, slotForm.day, slotForm.period);\n                  return <option key={t.id} value={t.id} disabled={!!busy}>{t.name}{busy ? ` (Busy: ${busy})` : ''}</option>;\n                })}\n              </select>\n            </div>\n            <div>\n              <Label>{t('room_number')} ({t('optional')})</Label>\n              <Input value={slotForm.room} onChange={e => setSlotForm(f => ({ ...f, room: e.target.value }))} placeholder=\"Room number\" />\n            </div>\n            <div className=\"flex gap-2 pt-2\">\n              <Button variant=\"destructive\" size=\"sm\" onClick={handleDeleteSlot} disabled={saving} className=\"gap-1\">\n                <Trash2 className=\"w-3.5 h-3.5\" /> {t('delete')}\n              </Button>\n              <div className=\"flex-1\" />\n              <Button variant=\"outline\" onClick={() => setShowSlotDialog(false)}>{t('cancel')}</Button>\n              <Button onClick={handleSaveSlot} disabled={saving} className=\"bg-indigo-600 hover:bg-indigo-700 gap-1\">\n                {saving ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Save className=\"w-4 h-4\" />} {t('save')}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* ============ ASSIGN CLASS TEACHER DIALOG ============ */}\n      <Dialog open={showAssignDialog} onOpenChange={setShowAssignDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>{t('class_teacher')}</DialogTitle>\n            <DialogDescription>\n              {selectedClass?.name} - Assigning will auto-create Period 1 Homeroom entries\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label>{t('teacher')}</Label>\n              <select className=\"w-full border rounded-md px-3 py-2 text-sm bg-white\" value={assignTeacherId} onChange={e => setAssignTeacherId(e.target.value)}>\n                <option value=\"\">-- {t('teacher')} --</option>\n                {teachers.map(t => <option key={t.id} value={t.id}>{t.name}{t.subject ? ` (${t.subject})` : ''}</option>)}\n              </select>\n            </div>\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\n              <p className=\"text-xs text-blue-700\">\n                <strong>Note:</strong> Assigning a class teacher will automatically lock Period 1 as \"Homeroom / \" for all working days. This period has +{settings.first_period_extra_mins} extra minutes for attendance.\n              </p>\n            </div>\n            <div className=\"flex gap-2 justify-end\">\n              <Button variant=\"outline\" onClick={() => setShowAssignDialog(false)}>{t('cancel')}</Button>\n              <Button onClick={handleAssignClassTeacher} disabled={saving || !assignTeacherId} className=\"bg-indigo-600 hover:bg-indigo-700 gap-1\">\n                {saving ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <UserCheck className=\"w-4 h-4\" />} {t('save')}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* ============ ADD SUBSTITUTION DIALOG ============ */}\n      <Dialog open={showSubDialog} onOpenChange={setShowSubDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>{t('substitution')}</DialogTitle>\n            <DialogDescription>Date: {subDate}</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label>{t('classes')}</Label>\n              <select\n                className=\"w-full border rounded-md px-3 py-2 text-sm bg-white\"\n                value={subForm.class_id}\n                onChange={e => {\n                  const cid = e.target.value;\n                  setSubForm(f => ({ ...f, class_id: cid, period_id: '', original_teacher_id: '' }));\n                }}\n              >\n                <option value=\"\">-- {t('select_class')} --</option>\n                {classes.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\n              </select>\n            </div>\n            <div>\n              <Label>{t('period')}</Label>\n              <select\n                className=\"w-full border rounded-md px-3 py-2 text-sm bg-white\"\n                value={subForm.period_id}\n                onChange={e => {\n                  const pid = e.target.value;\n                  const slot = timetables[subForm.class_id]?.[workingDays[0]]?.[parseInt(pid)];\n                  setSubForm(f => ({ ...f, period_id: pid, original_teacher_id: slot?.teacher_id || '', is_homeroom: pid === '1' }));\n                }}\n              >\n                <option value=\"\">-- {t('period')} --</option>\n                {periods.map(p => (\n                  <option key={p.id} value={p.id}>\n                    {t('period')} {p.id}{p.id === 1 ? ` (${t('homeroom')})` : ''}\n                  </option>\n                ))}\n              </select>\n            </div>\n            <div>\n              <Label>{t('teacher')}</Label>\n              <select className=\"w-full border rounded-md px-3 py-2 text-sm bg-white\" value={subForm.original_teacher_id} onChange={e => setSubForm(f => ({ ...f, original_teacher_id: e.target.value }))}>\n                <option value=\"\">-- {t('teacher')} --</option>\n                {teachers.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}\n              </select>\n            </div>\n            <div>\n              <Label>{t('substitution')}</Label>\n              <select className=\"w-full border rounded-md px-3 py-2 text-sm bg-white\" value={subForm.substitute_teacher_id} onChange={e => setSubForm(f => ({ ...f, substitute_teacher_id: e.target.value }))}>\n                <option value=\"\">-- {t('assign_substitute')} --</option>\n                {teachers.filter(t => t.id !== subForm.original_teacher_id).map(t => {\n                  const busy = subForm.period_id ? isTeacherBusy(t.id, workingDays[0], parseInt(subForm.period_id)) : null;\n                  return <option key={t.id} value={t.id} disabled={!!busy}>{t.name}{busy ? ` (Busy: ${busy})` : ''}</option>;\n                })}\n              </select>\n            </div>\n            <div>\n              <Label>{t('reason')}</Label>\n              <Input value={subForm.reason} onChange={e => setSubForm(f => ({ ...f, reason: e.target.value }))} placeholder={t('reason')} />\n            </div>\n            <div className=\"flex gap-2 justify-end\">\n              <Button variant=\"outline\" onClick={() => setShowSubDialog(false)}>{t('cancel')}</Button>\n              <Button onClick={handleAddSubstitution} disabled={saving} className=\"bg-indigo-600 hover:bg-indigo-700 gap-1\">\n                {saving ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Check className=\"w-4 h-4\" />} {t('save')}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* ============ ASSIGN SUBJECTS TO CLASS DIALOG ============ */}\n      <Dialog open={showSubjectAssignDialog} onOpenChange={setShowSubjectAssignDialog}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>{t('subjects')} - {selectedClass?.name}</DialogTitle>\n            <DialogDescription>               </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-3 max-h-[400px] overflow-y-auto\">\n            {subjects.map(s => (\n              <label key={s.id} className={`flex items-center gap-3 p-2.5 rounded-lg border cursor-pointer transition-colors ${selectedSubjectIds.includes(s.id) ? 'bg-indigo-50 border-indigo-300' : 'bg-white border-slate-200 hover:bg-slate-50'}`}>\n                <input\n                  type=\"checkbox\"\n                  checked={selectedSubjectIds.includes(s.id)}\n                  onChange={() => toggleSubjectSelection(s.id)}\n                  className=\"w-4 h-4 text-indigo-600 rounded\"\n                />\n                <div className=\"flex-1\">\n                  <span className=\"text-sm font-medium\">{s.name}</span>\n                  {s.name_hi && <span className=\"text-xs text-slate-500 ml-2\">({s.name_hi})</span>}\n                </div>\n                {selectedSubjectIds.includes(s.id) && <Check className=\"w-4 h-4 text-indigo-600\" />}\n              </label>\n            ))}\n          </div>\n          <div className=\"flex items-center justify-between pt-3 border-t\">\n            <p className=\"text-xs text-slate-500\">{selectedSubjectIds.length}    / {selectedSubjectIds.length} subjects selected</p>\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={() => setShowSubjectAssignDialog(false)}>{t('cancel')}</Button>\n              <Button onClick={handleSaveClassSubjects} disabled={saving || selectedSubjectIds.length === 0} className=\"bg-indigo-600 hover:bg-indigo-700 gap-1\">\n                {saving ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Save className=\"w-4 h-4\" />} {t('save')}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n"],"names":["buttonVariants","cva","variants","variant","default","destructive","outline","secondary","ghost","link","size","sm","lg","icon","defaultVariants","Button","React","_ref","ref","className","asChild","props","_objectWithoutProperties","_excluded","Comp","Slot","_jsx","_objectSpread","cn","displayName","Card","CardHeader","_ref2","_excluded2","CardTitle","_ref3","_excluded3","CardDescription","_ref4","_excluded4","CardContent","_ref5","_excluded5","_ref6","_excluded6","Dialog","DialogPrimitive","DialogTrigger","DialogPortal","DialogOverlay","DialogContent","children","_jsxs","X","DialogHeader","DialogTitle","DialogDescription","Input","type","labelVariants","Label","LabelPrimitive","Tabs","TabsPrimitive","TabsList","TabsTrigger","TabsContent","_len","arguments","length","inputs","Array","_key","twMerge","clsx","API","concat","DAYS","DAYS_HI","SUBJECT_COLORS","DEFAULT_SETTINGS","normal_period_duration","first_period_extra_mins","school_start_time","break_duration","lunch_duration","break_after_period","lunch_after_period","periods_per_day","working_days","getSubjectColor","subjectName","TimetableManagement","_selectedClass$subjec","t","useTranslation","schoolId","user","useAuth","classes","setClasses","useState","teachers","setTeachers","subjects","setSubjects","timetables","setTimetables","settings","setSettings","substitutions","setSubstitutions","subjectAllocations","setSubjectAllocations","loading","setLoading","saving","setSaving","generating","setGenerating","activeTab","setActiveTab","selectedClass","setSelectedClass","selectedTeacher","setSelectedTeacher","subDate","setSubDate","Date","toISOString","split","showSlotDialog","setShowSlotDialog","showAssignDialog","setShowAssignDialog","showSubDialog","setShowSubDialog","showSubjectAssignDialog","setShowSubjectAssignDialog","selectedSubjectIds","setSelectedSubjectIds","assignTeacherId","setAssignTeacherId","slotForm","setSlotForm","day","period","subject_id","teacher_id","room","subForm","setSubForm","class_id","period_id","original_teacher_id","substitute_teacher_id","reason","is_homeroom","token","localStorage","getItem","headers","Authorization","timeSlots","s","slots","h","m","map","Number","periodNum","i","endM","endH","Math","floor","push","id","label","isBreak","start","String","padStart","end","generateTimeSlots","periods","filter","workingDays","fetchAllData","useCallback","async","_subjectRes$data","classRes","staffRes","subjectRes","ttRes","settingsRes","allocRes","Promise","all","axios","get","catch","data","cls","_t$designation","role","designation","toLowerCase","includes","defaultSubjects","name","name_hi","Object","keys","prev","error","console","toast","fetchSubstitutions","res","_unused","useEffect","getClassTeacherInfo","classObj","ctId","class_teacher_id","classTeacherId","teacher","find","_id","alloc","a","subject_name","subject","subjectId","class_teacher","isTeacherBusy","teacherId","periodId","classId","classTT","entries","_classTT$day","_classTT$day$periodId","_classes$find","c","classTeacher","Clock","_Fragment","onClick","_res$data2","post","school_id","timetable","success","_unused3","ct","avail","newTT","forEach","shuffled","sort","random","si","teacher_name","sub","_unused4","_unused5","disabled","Loader2","Calendar","handlePrint","el","document","getElementById","w","window","open","write","outerHTML","close","Printer","value","onValueChange","GraduationCap","User","RefreshCw","Settings","onChange","e","target","UserCheck","AlertCircle","Edit","handleOpenSubjectAssign","BookOpen","slot","di","indexOf","_classTT$day2","_classTeacher$teacher","ctName","title","cellData","handleSlotClick","_timetables$selectedC","_timetables$selectedC2","k","schedule","dayPeriods","pId","_classes$find2","class_name","getTeacherSchedule","isClassTeacherOf","p","_schedule$day","join","Users","Plus","origT","subT","original_teacher_name","substitute_teacher_name","delete","subId","_unused7","handleDeleteSubstitution","Trash2","min","max","parseInt","_settings$working_day","checked","d","_unused6","Save","onOpenChange","f","getClassSubjects","classSubjectIds","busy","placeholder","_n$selectedClass$id","n","_unused2","_prev$selectedClass$i","_error$response","_error$response$data","response","detail","_res$data","message","_error$response2","_error$response2$data","cid","_timetables$subForm$c","_timetables$subForm$c2","pid","date","_error$response3","_error$response3$data","Check","toggleSubjectSelection","put"],"sourceRoot":""}