/*! For license information please see 221.a3d29db3.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[221],{1111(e,s,a){a.d(s,{$:()=>u});var t=a(2555),l=a(3986),r=a(9950),n=a(2962),c=a(4364),d=a(9332),o=a(4414);const i=["className","variant","size","asChild"],m=(0,c.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-blue-500 text-white shadow-sm hover:bg-blue-600 rounded-lg",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-gray-200 bg-white shadow-sm hover:bg-gray-50 text-gray-700 rounded-lg",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),u=r.forwardRef((e,s)=>{let{className:a,variant:r,size:c,asChild:u=!1}=e,f=(0,l.A)(e,i);const h=u?n.DX:"button";return(0,o.jsx)(h,(0,t.A)({className:(0,d.cn)(m({variant:r,size:c,className:a})),ref:s},f))});u.displayName="Button"},7255(e,s,a){a.d(s,{Cf:()=>g,L3:()=>y,c7:()=>v,lG:()=>x,rr:()=>j,zM:()=>p});var t=a(2555),l=a(3986),r=a(9950),n=a(9710),c=a(6479),d=a(9332),o=a(4414);const i=["className"],m=["className","children"],u=["className"],f=["className"],h=["className"],x=n.bL,p=n.l9,b=n.ZL,N=(n.bm,r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,i);return(0,o.jsx)(n.hJ,(0,t.A)({ref:s,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a)},r))}));N.displayName=n.hJ.displayName;const g=r.forwardRef((e,s)=>{let{className:a,children:r}=e,i=(0,l.A)(e,m);return(0,o.jsxs)(b,{children:[(0,o.jsx)(N,{}),(0,o.jsxs)(n.UC,(0,t.A)((0,t.A)({ref:s,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a)},i),{},{children:[r,(0,o.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,o.jsx)(c.A,{className:"h-4 w-4"}),(0,o.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});g.displayName=n.UC.displayName;const v=e=>{let{className:s}=e,a=(0,l.A)(e,u);return(0,o.jsx)("div",(0,t.A)({className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s)},a))};v.displayName="DialogHeader";const y=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,f);return(0,o.jsx)(n.hE,(0,t.A)({ref:s,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",a)},r))});y.displayName=n.hE.displayName;const j=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,h);return(0,o.jsx)(n.VY,(0,t.A)({ref:s,className:(0,d.cn)("text-sm text-muted-foreground",a)},r))});j.displayName=n.VY.displayName},4779(e,s,a){a.d(s,{p:()=>o});var t=a(2555),l=a(3986),r=a(9950),n=a(9332),c=a(4414);const d=["className","type"],o=r.forwardRef((e,s)=>{let{className:a,type:r}=e,o=(0,l.A)(e,d);return(0,c.jsx)("input",(0,t.A)({type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s},o))});o.displayName="Input"},557(e,s,a){a.d(s,{J:()=>u});var t=a(2555),l=a(3986),r=a(9950),n=a(1611),c=a(4364),d=a(9332),o=a(4414);const i=["className"],m=(0,c.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,i);return(0,o.jsx)(n.b,(0,t.A)({ref:s,className:(0,d.cn)(m(),a)},r))});u.displayName=n.b.displayName},3787(e,s,a){a.d(s,{A0:()=>b,BF:()=>N,Hj:()=>g,XI:()=>p,nA:()=>y,nd:()=>v});var t=a(2555),l=a(3986),r=a(9950),n=a(9332),c=a(4414);const d=["className"],o=["className"],i=["className"],m=["className"],u=["className"],f=["className"],h=["className"],x=["className"],p=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,d);return(0,c.jsx)("div",{className:"relative w-full overflow-auto rounded-xl border border-gray-200 bg-white overflow-hidden",children:(0,c.jsx)("table",(0,t.A)({ref:s,className:(0,n.cn)("w-full caption-bottom text-sm",a)},r))})});p.displayName="Table";const b=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,o);return(0,c.jsx)("thead",(0,t.A)({ref:s,className:(0,n.cn)("[&_tr]:border-b bg-gray-50/80",a)},r))});b.displayName="TableHeader";const N=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,i);return(0,c.jsx)("tbody",(0,t.A)({ref:s,className:(0,n.cn)("[&_tr:last-child]:border-0",a)},r))});N.displayName="TableBody";r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,m);return(0,c.jsx)("tfoot",(0,t.A)({ref:s,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a)},r))}).displayName="TableFooter";const g=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,u);return(0,c.jsx)("tr",(0,t.A)({ref:s,className:(0,n.cn)("border-b transition-colors hover:bg-blue-50/40 data-[state=selected]:bg-muted",a)},r))});g.displayName="TableRow";const v=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,f);return(0,c.jsx)("th",(0,t.A)({ref:s,className:(0,n.cn)("h-11 px-4 text-xs uppercase tracking-wider text-left align-middle font-medium text-gray-600 [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a)},r))});v.displayName="TableHead";const y=r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,h);return(0,c.jsx)("td",(0,t.A)({ref:s,className:(0,n.cn)("px-4 py-3 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a)},r))});y.displayName="TableCell";r.forwardRef((e,s)=>{let{className:a}=e,r=(0,l.A)(e,x);return(0,c.jsx)("caption",(0,t.A)({ref:s,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",a)},r))}).displayName="TableCaption"},9332(e,s,a){a.d(s,{cn:()=>r});var t=a(2004),l=a(9800);function r(){for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,l.QP)((0,t.$)(s))}},221(e,s,a){a.r(s),a.d(s,{default:()=>g});var t=a(2555),l=a(9950),r=a(5030),n=a(5532),c=a(6910),d=a(1111),o=(a(4779),a(557)),i=a(7255),m=(a(3787),a(2989)),u=a(978),f=a(8890),h=a(2607),x=a(4814),p=a(2033),b=a(4414);const N="".concat("","/api");function g(){const{t:e}=(0,r.Bd)(),{schoolId:s}=(0,n.As)(),[a,g]=(0,l.useState)([]),[v,y]=(0,l.useState)([]),[j,w]=(0,l.useState)(!0),[A,_]=(0,l.useState)(!1),[C,k]=(0,l.useState)(null),[R,z]=(0,l.useState)(!1),[M,S]=(0,l.useState)({name:"",section:"",class_teacher_id:""});(0,l.useEffect)(()=>{s&&(T(),L())},[s]);const T=async()=>{try{const e=await c.A.get("".concat(N,"/classes?school_id=").concat(s));g(e.data)}catch(e){p.oR.error("Failed to fetch classes")}finally{w(!1)}},L=async()=>{try{const e=localStorage.getItem("token"),a=(await c.A.get("".concat(N,"/users?school_id=").concat(s),{headers:{Authorization:"Bearer ".concat(e)}})).data.filter(e=>{var s;return"teacher"===e.role||"principal"===e.role||"vice_principal"===e.role||(null===(s=e.designation)||void 0===s?void 0:s.toLowerCase().includes("teacher"))});y(a)}catch(e){console.error("Failed to fetch staff:",e);try{const e=await c.A.get("".concat(N,"/staff?school_id=").concat(s));y(e.data)}catch(a){console.error("Staff fallback failed")}}},D=()=>{k(null),S({name:"",section:"A",class_teacher_id:""})},B=e=>{S(s=>(0,t.A)((0,t.A)({},s),{},{[e.target.name]:e.target.value}))},F=e=>{const s=v.find(s=>s.id===e);return(null===s||void 0===s?void 0:s.name)||"-"};return s?(0,b.jsxs)("div",{className:"space-y-6","data-testid":"classes-page",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold font-heading text-slate-900",children:e("classes")}),(0,b.jsxs)("p",{className:"text-slate-500 mt-1",children:[e("manage")," ",e("classes")]})]}),(0,b.jsxs)(i.lG,{open:A,onOpenChange:e=>{_(e),e||D()},children:[(0,b.jsx)(i.zM,{asChild:!0,children:(0,b.jsxs)(d.$,{className:"btn-primary","data-testid":"add-class-btn",children:[(0,b.jsx)(h.A,{className:"w-5 h-5 mr-2"}),e("add_class")]})}),(0,b.jsxs)(i.Cf,{children:[(0,b.jsxs)(i.c7,{children:[(0,b.jsx)(i.L3,{children:e(C?"edit":"add_class")}),(0,b.jsx)(i.rr,{className:"sr-only",children:"Class form"})]}),(0,b.jsxs)("form",{onSubmit:async a=>{a.preventDefault(),z(!0);try{const a=(0,t.A)((0,t.A)({},M),{},{school_id:s});C?(await c.A.put("".concat(N,"/classes/").concat(C.id),a),p.oR.success(e("saved_successfully"))):(await c.A.post("".concat(N,"/classes"),a),p.oR.success(e("saved_successfully"))),_(!1),D(),T()}catch(n){var l,r;const s=null===(l=n.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.detail;p.oR.error("string"===typeof s?s:e("something_went_wrong"))}finally{z(!1)}},className:"space-y-4 mt-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(o.J,{children:[e("class_name")," *"]}),(0,b.jsxs)("select",{name:"name",value:M.name,onChange:B,required:!0,className:"w-full h-10 rounded-lg border border-slate-200 px-3","data-testid":"class-name-select",children:[(0,b.jsx)("option",{value:"",children:e("select_class")}),["Nursery","LKG","UKG","Class 1","Class 2","Class 3","Class 4","Class 5","Class 6","Class 7","Class 8","Class 9","Class 10","Class 11","Class 12"].map(e=>(0,b.jsx)("option",{value:e,children:e},e))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(o.J,{children:[e("section")," (",e("optional"),")"]}),(0,b.jsxs)("select",{name:"section",value:M.section,onChange:B,className:"w-full h-10 rounded-lg border border-slate-200 px-3","data-testid":"section-select",children:[(0,b.jsx)("option",{value:"",children:e("no_data")}),["","A","B","C","D","E"].filter(e=>""!==e).map(e=>(0,b.jsx)("option",{value:e,children:e},e))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.J,{children:e("class_teacher")}),(0,b.jsxs)("select",{name:"class_teacher_id",value:M.class_teacher_id,onChange:B,className:"w-full h-10 rounded-lg border border-slate-200 px-3","data-testid":"class-teacher-select",children:[(0,b.jsx)("option",{value:"",children:e("assign_teacher")}),v.map(e=>(0,b.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,b.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>_(!1),children:e("cancel")}),(0,b.jsxs)(d.$,{type:"submit",className:"btn-primary",disabled:R,"data-testid":"save-class-btn",children:[R?(0,b.jsx)(m.A,{className:"w-4 h-4 animate-spin mr-2"}):null,e("save")]})]})]})]})]})]}),j?(0,b.jsx)("div",{className:"flex justify-center py-20",children:(0,b.jsx)("div",{className:"spinner w-10 h-10"})}):0===a.length?(0,b.jsxs)("div",{className:"text-center py-20 bg-white rounded-xl border border-slate-200",children:[(0,b.jsx)(f.A,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-slate-500",children:e("no_data")}),(0,b.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:e("add_class")})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(s=>(0,b.jsxs)("div",{className:"stat-card flex flex-col","data-testid":"class-card-".concat(s.id),children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-indigo-50 rounded-xl flex items-center justify-center",children:(0,b.jsx)(f.A,{className:"w-6 h-6 text-indigo-600"})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>(e=>{k(e),S({name:e.name,section:e.section,class_teacher_id:e.class_teacher_id||""}),_(!0)})(s),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors","data-testid":"edit-class-".concat(s.id),children:(0,b.jsx)(u.A,{className:"w-4 h-4 text-slate-500"})}),(0,b.jsx)("button",{onClick:()=>(async s=>{if(window.confirm(e("confirm_delete")))try{await c.A.delete("".concat(N,"/classes/").concat(s)),p.oR.success(e("deleted_successfully")),T()}catch(a){p.oR.error(e("something_went_wrong"))}})(s.id),className:"p-2 hover:bg-rose-50 rounded-lg transition-colors","data-testid":"delete-class-".concat(s.id),children:(0,b.jsx)(x.A,{className:"w-4 h-4 text-rose-500"})})]})]}),(0,b.jsxs)("h3",{className:"text-xl font-bold text-slate-900",children:[s.name,s.section?" - ".concat(s.section):""]}),(0,b.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:[e("class_teacher"),": ",F(s.class_teacher_id)||(0,b.jsx)("span",{className:"text-orange-500",children:e("not_available")})]}),(0,b.jsx)("div",{className:"mt-auto pt-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-slate-500",children:e("student_count")}),(0,b.jsx)("span",{className:"font-semibold text-slate-900",children:s.student_count})]})})]},s.id))})]}):(0,b.jsx)("div",{className:"text-center py-20",children:(0,b.jsx)("p",{className:"text-slate-500",children:e("select_class")})})}},2989(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2607(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},978(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},4814(e,s,a){a.d(s,{A:()=>t});const t=(0,a(6230).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1611(e,s,a){a.d(s,{b:()=>m});var t=a(2555),l=a(9950),r=a(3986),n=(a(7119),a(2962)),c=a(4414);const d=["asChild"];var o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{const a=(0,n.TL)("Primitive.".concat(s)),o=l.forwardRef((e,l)=>{const{asChild:n}=e,o=(0,r.A)(e,d),i=n?a:s;return"undefined"!==typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,c.jsx)(i,(0,t.A)((0,t.A)({},o),{},{ref:l}))});return o.displayName="Primitive.".concat(s),(0,t.A)((0,t.A)({},e),{},{[s]:o})},{});var i=l.forwardRef((e,s)=>(0,c.jsx)(o.label,(0,t.A)((0,t.A)({},e),{},{ref:s,onMouseDown:s=>{var a;s.target.closest("button, input, select, textarea")||(null===(a=e.onMouseDown)||void 0===a||a.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}})));i.displayName="Label";var m=i}}]);